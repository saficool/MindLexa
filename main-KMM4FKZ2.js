import{$ as Ot,$a as rt,A as Cr,Aa as Ae,Ab as Pe,B as Ll,Ba as Wl,Bb as Ea,C as Cd,Ca as Ld,Cb as Oa,D as Id,Da as Ud,Db as np,E as Ed,Ea as ba,Eb as rc,F as dt,Fa as _a,Fb as nc,G as Od,Ga as Kl,Gb as ip,H as je,Ha as Vd,Hb as Pa,I as de,Ia as nr,Ib as Ta,J as Ul,Ja as Co,K as W,Ka as Bd,L as on,La as qd,Lb as op,M as Pd,Ma as ln,Mb as ic,N as ae,Na as cn,O as Vl,Oa as Ce,Ob as Sa,P as J,Pa as Io,Pb as Ra,Q as j,Qa as Gd,Qb as oc,R as _o,Ra as ir,S as Yt,Sa as Hd,T as sn,Ta as me,U as Qt,Ua as Ie,V as er,Va as Ee,W as Td,Wa as Zl,X as pi,Xa as Xl,Y as It,Ya as Eo,Z as ya,Za as Wd,_ as Et,_a as He,a as yd,aa as wo,ab as Jl,b as vd,ba as an,bb as wa,c as Dl,ca as va,cb as xa,d as Nl,da as tr,db as We,e as jl,ea as tt,eb as fn,f as Ne,fa as Bl,fb as Kd,g as ft,ga as xo,gb as Zd,h as xr,ha as Sd,hb as Xd,i as Ge,ia as ql,ib as Yl,j as H,ja as Rd,jb as or,k as bo,ka as un,kb as Jd,l as bd,la as Md,lb as Aa,m as _d,ma as Gl,mb as Ca,n as ne,na as mi,nb as Ql,o as Fl,oa as gi,ob as Ir,p as ht,pa as kd,pb as ec,q as wd,qa as Dd,qb as Yd,r as zl,ra as Nd,rb as Oo,s as xd,sa as jd,sb as Qd,t as Ar,ta as Fd,tb as ep,u as fi,ua as zd,ub as tc,v as nn,va as $d,vb as Ia,w as $l,wa as rr,wb as hn,x as hi,xa as Hl,xb as yi,y as Ad,ya as Ao,yb as tp,z as di,za as pe,zb as rp}from"./chunk-4E3JS4HT.js";import{a as ja}from"./chunk-6IAYXLU6.js";import{A as dc,B as Da,C as To,D as mn,E as pc,F as gn,G as So,H as sr,I as pp,J as mp,K as Pt,L as Ro,M as mc,N as Na,O as gc,P as gp,Q as yp,a as sc,b as ac,d as uc,e as sp,f as lc,g as ap,h as Po,i as cc,j as Ma,k as fc,l as up,m as lp,n as hc,o as cp,q as fp,r as dn,s as hp,t as K,u as vi,v as ka,w as Xe,x as dp,y as pn,z as bi}from"./chunk-GWYT2C5E.js";import{a as p,b as _,c as fe,d as B_,e as q_,f as G_,g as vo,h as I,i as G,j as he,k as gd,l as te}from"./chunk-TJICSKBO.js";var pg=B_(Tu=>{"use strict";Tu.byteLength=TC;Tu.toByteArray=RC;Tu.fromByteArray=DC;var Ht=[],gt=[],PC=typeof Uint8Array<"u"?Uint8Array:Array,Yf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(Qn=0,hg=Yf.length;Qn<hg;++Qn)Ht[Qn]=Yf[Qn],gt[Yf.charCodeAt(Qn)]=Qn;var Qn,hg;gt[45]=62;gt[95]=63;function dg(r){var e=r.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=r.indexOf("=");n===-1&&(n=e);var i=n===e?0:4-n%4;return[n,i]}function TC(r){var e=dg(r),n=e[0],i=e[1];return(n+i)*3/4-i}function SC(r,e,n){return(e+n)*3/4-n}function RC(r){var e,n=dg(r),i=n[0],o=n[1],s=new PC(SC(r,i,o)),a=0,u=o>0?i-4:i,l;for(l=0;l<u;l+=4)e=gt[r.charCodeAt(l)]<<18|gt[r.charCodeAt(l+1)]<<12|gt[r.charCodeAt(l+2)]<<6|gt[r.charCodeAt(l+3)],s[a++]=e>>16&255,s[a++]=e>>8&255,s[a++]=e&255;return o===2&&(e=gt[r.charCodeAt(l)]<<2|gt[r.charCodeAt(l+1)]>>4,s[a++]=e&255),o===1&&(e=gt[r.charCodeAt(l)]<<10|gt[r.charCodeAt(l+1)]<<4|gt[r.charCodeAt(l+2)]>>2,s[a++]=e>>8&255,s[a++]=e&255),s}function MC(r){return Ht[r>>18&63]+Ht[r>>12&63]+Ht[r>>6&63]+Ht[r&63]}function kC(r,e,n){for(var i,o=[],s=e;s<n;s+=3)i=(r[s]<<16&16711680)+(r[s+1]<<8&65280)+(r[s+2]&255),o.push(MC(i));return o.join("")}function DC(r){for(var e,n=r.length,i=n%3,o=[],s=16383,a=0,u=n-i;a<u;a+=s)o.push(kC(r,a,a+s>u?u:a+s));return i===1?(e=r[n-1],o.push(Ht[e>>2]+Ht[e<<4&63]+"==")):i===2&&(e=(r[n-2]<<8)+r[n-1],o.push(Ht[e>>10]+Ht[e>>4&63]+Ht[e<<2&63]+"=")),o.join("")}});var ko=class{},za=class{},ar=class r{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(n=>{let i=n.indexOf(":");if(i>0){let o=n.slice(0,i),s=o.toLowerCase(),a=n.slice(i+1).trim();this.maybeSetNormalizedName(o,s),this.headers.has(s)?this.headers.get(s).push(a):this.headers.set(s,[a])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((n,i)=>{this.setHeaderEntries(i,n)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([n,i])=>{this.setHeaderEntries(n,i)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let n=this.headers.get(e.toLowerCase());return n&&n.length>0?n[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,n){return this.clone({name:e,value:n,op:"a"})}set(e,n){return this.clone({name:e,value:n,op:"s"})}delete(e,n){return this.clone({name:e,value:n,op:"d"})}maybeSetNormalizedName(e,n){this.normalizedNames.has(n)||this.normalizedNames.set(n,e)}init(){this.lazyInit&&(this.lazyInit instanceof r?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(n=>{this.headers.set(n,e.headers.get(n)),this.normalizedNames.set(n,e.normalizedNames.get(n))})}clone(e){let n=new r;return n.lazyInit=this.lazyInit&&this.lazyInit instanceof r?this.lazyInit:this,n.lazyUpdate=(this.lazyUpdate||[]).concat([e]),n}applyUpdate(e){let n=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if(typeof i=="string"&&(i=[i]),i.length===0)return;this.maybeSetNormalizedName(e.name,n);let o=(e.op==="a"?this.headers.get(n):void 0)||[];o.push(...i),this.headers.set(n,o);break;case"d":let s=e.value;if(!s)this.headers.delete(n),this.normalizedNames.delete(n);else{let a=this.headers.get(n);if(!a)return;a=a.filter(u=>s.indexOf(u)===-1),a.length===0?(this.headers.delete(n),this.normalizedNames.delete(n)):this.headers.set(n,a)}break}}setHeaderEntries(e,n){let i=(Array.isArray(n)?n:[n]).map(s=>s.toString()),o=e.toLowerCase();this.headers.set(o,i),this.maybeSetNormalizedName(e,o)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(n=>e(this.normalizedNames.get(n),this.headers.get(n)))}};var vc=class{encodeKey(e){return vp(e)}encodeValue(e){return vp(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}};function K_(r,e){let n=new Map;return r.length>0&&r.replace(/^\?/,"").split("&").forEach(o=>{let s=o.indexOf("="),[a,u]=s==-1?[e.decodeKey(o),""]:[e.decodeKey(o.slice(0,s)),e.decodeValue(o.slice(s+1))],l=n.get(a)||[];l.push(u),n.set(a,l)}),n}var Z_=/%(\d[a-f0-9])/gi,X_={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function vp(r){return encodeURIComponent(r).replace(Z_,(e,n)=>X_[n]??e)}function Fa(r){return`${r}`}var Or=class r{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new vc,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=K_(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(n=>{let i=e.fromObject[n],o=Array.isArray(i)?i.map(Fa):[Fa(i)];this.map.set(n,o)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();let n=this.map.get(e);return n?n[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,n){return this.clone({param:e,value:n,op:"a"})}appendAll(e){let n=[];return Object.keys(e).forEach(i=>{let o=e[i];Array.isArray(o)?o.forEach(s=>{n.push({param:i,value:s,op:"a"})}):n.push({param:i,value:o,op:"a"})}),this.clone(n)}set(e,n){return this.clone({param:e,value:n,op:"s"})}delete(e,n){return this.clone({param:e,value:n,op:"d"})}toString(){return this.init(),this.keys().map(e=>{let n=this.encoder.encodeKey(e);return this.map.get(e).map(i=>n+"="+this.encoder.encodeValue(i)).join("&")}).filter(e=>e!=="").join("&")}clone(e){let n=new r({encoder:this.encoder});return n.cloneFrom=this.cloneFrom||this,n.updates=(this.updates||[]).concat(e),n}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":let n=(e.op==="a"?this.map.get(e.param):void 0)||[];n.push(Fa(e.value)),this.map.set(e.param,n);break;case"d":if(e.value!==void 0){let i=this.map.get(e.param)||[],o=i.indexOf(Fa(e.value));o!==-1&&i.splice(o,1),i.length>0?this.map.set(e.param,i):this.map.delete(e.param)}else{this.map.delete(e.param);break}}}),this.cloneFrom=this.updates=null)}};var bc=class{constructor(){this.map=new Map}set(e,n){return this.map.set(e,n),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}};function J_(r){switch(r){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function bp(r){return typeof ArrayBuffer<"u"&&r instanceof ArrayBuffer}function _p(r){return typeof Blob<"u"&&r instanceof Blob}function wp(r){return typeof FormData<"u"&&r instanceof FormData}function Y_(r){return typeof URLSearchParams<"u"&&r instanceof URLSearchParams}var Mo=class r{constructor(e,n,i,o){this.url=n,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase();let s;if(J_(this.method)||o?(this.body=i!==void 0?i:null,s=o):s=i,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params),this.transferCache=s.transferCache),this.headers??=new ar,this.context??=new bc,!this.params)this.params=new Or,this.urlWithParams=n;else{let a=this.params.toString();if(a.length===0)this.urlWithParams=n;else{let u=n.indexOf("?"),l=u===-1?"?":u<n.length-1?"&":"";this.urlWithParams=n+l+a}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||bp(this.body)||_p(this.body)||wp(this.body)||Y_(this.body)?this.body:this.body instanceof Or?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||wp(this.body)?null:_p(this.body)?this.body.type||null:bp(this.body)?null:typeof this.body=="string"?"text/plain":this.body instanceof Or?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?"application/json":null}clone(e={}){let n=e.method||this.method,i=e.url||this.url,o=e.responseType||this.responseType,s=e.transferCache??this.transferCache,a=e.body!==void 0?e.body:this.body,u=e.withCredentials??this.withCredentials,l=e.reportProgress??this.reportProgress,c=e.headers||this.headers,f=e.params||this.params,h=e.context??this.context;return e.setHeaders!==void 0&&(c=Object.keys(e.setHeaders).reduce((d,m)=>d.set(m,e.setHeaders[m]),c)),e.setParams&&(f=Object.keys(e.setParams).reduce((d,m)=>d.set(m,e.setParams[m]),f)),new r(n,i,a,{params:f,headers:c,context:h,reportProgress:l,responseType:o,withCredentials:u,transferCache:s})}},Pr=function(r){return r[r.Sent=0]="Sent",r[r.UploadProgress=1]="UploadProgress",r[r.ResponseHeader=2]="ResponseHeader",r[r.DownloadProgress=3]="DownloadProgress",r[r.Response=4]="Response",r[r.User=5]="User",r}(Pr||{}),Do=class{constructor(e,n=200,i="OK"){this.headers=e.headers||new ar,this.status=e.status!==void 0?e.status:n,this.statusText=e.statusText||i,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}},$a=class r extends Do{constructor(e={}){super(e),this.type=Pr.ResponseHeader}clone(e={}){return new r({headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},No=class r extends Do{constructor(e={}){super(e),this.type=Pr.Response,this.body=e.body!==void 0?e.body:null}clone(e={}){return new r({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},Er=class extends Do{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${e.url||"(unknown url)"}`:this.message=`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}},Ip=200,Q_=204;function yc(r,e){return{body:e,headers:r.headers,context:r.context,observe:r.observe,params:r.params,reportProgress:r.reportProgress,responseType:r.responseType,withCredentials:r.withCredentials,transferCache:r.transferCache}}var xc=(()=>{let e=class e{constructor(i){this.handler=i}request(i,o,s={}){let a;if(i instanceof Mo)a=i;else{let c;s.headers instanceof ar?c=s.headers:c=new ar(s.headers);let f;s.params&&(s.params instanceof Or?f=s.params:f=new Or({fromObject:s.params})),a=new Mo(i,o,s.body!==void 0?s.body:null,{headers:c,context:s.context,params:f,reportProgress:s.reportProgress,responseType:s.responseType||"json",withCredentials:s.withCredentials,transferCache:s.transferCache})}let u=H(a).pipe(nn(c=>this.handler.handle(c)));if(i instanceof Mo||s.observe==="events")return u;let l=u.pipe(Ar(c=>c instanceof No));switch(s.observe||"body"){case"body":switch(a.responseType){case"arraybuffer":return l.pipe(ne(c=>{if(c.body!==null&&!(c.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return c.body}));case"blob":return l.pipe(ne(c=>{if(c.body!==null&&!(c.body instanceof Blob))throw new Error("Response is not a Blob.");return c.body}));case"text":return l.pipe(ne(c=>{if(c.body!==null&&typeof c.body!="string")throw new Error("Response is not a string.");return c.body}));case"json":default:return l.pipe(ne(c=>c.body))}case"response":return l;default:throw new Error(`Unreachable: unhandled observe type ${s.observe}}`)}}delete(i,o={}){return this.request("DELETE",i,o)}get(i,o={}){return this.request("GET",i,o)}head(i,o={}){return this.request("HEAD",i,o)}jsonp(i,o){return this.request("JSONP",i,{params:new Or().append(o,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(i,o={}){return this.request("OPTIONS",i,o)}patch(i,o,s={}){return this.request("PATCH",i,yc(s,o))}post(i,o,s={}){return this.request("POST",i,yc(s,o))}put(i,o,s={}){return this.request("PUT",i,yc(s,o))}};e.\u0275fac=function(o){return new(o||e)(J(ko))},e.\u0275prov=W({token:e,factory:e.\u0275fac});let r=e;return r})(),ew=/^\)\]\}',?\n/,tw="X-Request-URL";function xp(r){if(r.url)return r.url;let e=tw.toLocaleLowerCase();return r.headers.get(e)}var rw=(()=>{let e=class e{constructor(){this.fetchImpl=j(_c,{optional:!0})?.fetch??fetch.bind(globalThis),this.ngZone=j(tt)}handle(i){return new Dl(o=>{let s=new AbortController;return this.doRequest(i,s.signal,o).then(wc,a=>o.error(new Er({error:a}))),()=>s.abort()})}doRequest(i,o,s){return I(this,null,function*(){let a=this.createRequestInit(i),u;try{let y=this.ngZone.runOutsideAngular(()=>this.fetchImpl(i.urlWithParams,p({signal:o},a)));nw(y),s.next({type:Pr.Sent}),u=yield y}catch(y){s.error(new Er({error:y,status:y.status??0,statusText:y.statusText,url:i.urlWithParams,headers:y.headers}));return}let l=new ar(u.headers),c=u.statusText,f=xp(u)??i.urlWithParams,h=u.status,d=null;if(i.reportProgress&&s.next(new $a({headers:l,status:h,statusText:c,url:f})),u.body){let y=u.headers.get("content-length"),b=[],v=u.body.getReader(),g=0,A,E,w=typeof Zone<"u"&&Zone.current;yield this.ngZone.runOutsideAngular(()=>I(this,null,function*(){for(;;){let{done:C,value:O}=yield v.read();if(C)break;if(b.push(O),g+=O.length,i.reportProgress){E=i.responseType==="text"?(E??"")+(A??=new TextDecoder).decode(O,{stream:!0}):void 0;let T=()=>s.next({type:Pr.DownloadProgress,total:y?+y:void 0,loaded:g,partialText:E});w?w.run(T):T()}}}));let x=this.concatChunks(b,g);try{let C=u.headers.get("Content-Type")??"";d=this.parseBody(i,x,C)}catch(C){s.error(new Er({error:C,headers:new ar(u.headers),status:u.status,statusText:u.statusText,url:xp(u)??i.urlWithParams}));return}}h===0&&(h=d?Ip:0),h>=200&&h<300?(s.next(new No({body:d,headers:l,status:h,statusText:c,url:f})),s.complete()):s.error(new Er({error:d,headers:l,status:h,statusText:c,url:f}))})}parseBody(i,o,s){switch(i.responseType){case"json":let a=new TextDecoder().decode(o).replace(ew,"");return a===""?null:JSON.parse(a);case"text":return new TextDecoder().decode(o);case"blob":return new Blob([o],{type:s});case"arraybuffer":return o.buffer}}createRequestInit(i){let o={},s=i.withCredentials?"include":void 0;if(i.headers.forEach((a,u)=>o[a]=u.join(",")),i.headers.has("Accept")||(o.Accept="application/json, text/plain, */*"),!i.headers.has("Content-Type")){let a=i.detectContentTypeHeader();a!==null&&(o["Content-Type"]=a)}return{body:i.serializeBody(),method:i.method,headers:o,credentials:s}}concatChunks(i,o){let s=new Uint8Array(o),a=0;for(let u of i)s.set(u,a),a+=u.length;return s}};e.\u0275fac=function(o){return new(o||e)},e.\u0275prov=W({token:e,factory:e.\u0275fac});let r=e;return r})(),_c=class{};function wc(){}function nw(r){r.then(wc,wc)}function iw(r,e){return e(r)}function ow(r,e,n){return(i,o)=>It(n,()=>e(i,s=>r(s,o)))}var Ep=new ae(""),sw=new ae(""),aw=new ae("",{providedIn:"root",factory:()=>!0});var Ap=(()=>{let e=class e extends ko{constructor(i,o){super(),this.backend=i,this.injector=o,this.chain=null,this.pendingTasks=j(va),this.contributeToStability=j(aw)}handle(i){if(this.chain===null){let o=Array.from(new Set([...this.injector.get(Ep),...this.injector.get(sw,[])]));this.chain=o.reduceRight((s,a)=>ow(s,a,this.injector),iw)}if(this.contributeToStability){let o=this.pendingTasks.add();return this.chain(i,s=>this.backend.handle(s)).pipe(di(()=>this.pendingTasks.remove(o)))}else return this.chain(i,o=>this.backend.handle(o))}};e.\u0275fac=function(o){return new(o||e)(J(za),J(pi))},e.\u0275prov=W({token:e,factory:e.\u0275fac});let r=e;return r})();var uw=/^\)\]\}',?\n/;function lw(r){return"responseURL"in r&&r.responseURL?r.responseURL:/^X-Request-URL:/m.test(r.getAllResponseHeaders())?r.getResponseHeader("X-Request-URL"):null}var Cp=(()=>{let e=class e{constructor(i){this.xhrFactory=i}handle(i){if(i.method==="JSONP")throw new de(-2800,!1);let o=this.xhrFactory;return(o.\u0275loadImpl?Ge(o.\u0275loadImpl()):H(null)).pipe(dt(()=>new Dl(a=>{let u=o.build();if(u.open(i.method,i.urlWithParams),i.withCredentials&&(u.withCredentials=!0),i.headers.forEach((v,g)=>u.setRequestHeader(v,g.join(","))),i.headers.has("Accept")||u.setRequestHeader("Accept","application/json, text/plain, */*"),!i.headers.has("Content-Type")){let v=i.detectContentTypeHeader();v!==null&&u.setRequestHeader("Content-Type",v)}if(i.responseType){let v=i.responseType.toLowerCase();u.responseType=v!=="json"?v:"text"}let l=i.serializeBody(),c=null,f=()=>{if(c!==null)return c;let v=u.statusText||"OK",g=new ar(u.getAllResponseHeaders()),A=lw(u)||i.url;return c=new $a({headers:g,status:u.status,statusText:v,url:A}),c},h=()=>{let{headers:v,status:g,statusText:A,url:E}=f(),w=null;g!==Q_&&(w=typeof u.response>"u"?u.responseText:u.response),g===0&&(g=w?Ip:0);let x=g>=200&&g<300;if(i.responseType==="json"&&typeof w=="string"){let C=w;w=w.replace(uw,"");try{w=w!==""?JSON.parse(w):null}catch(O){w=C,x&&(x=!1,w={error:O,text:w})}}x?(a.next(new No({body:w,headers:v,status:g,statusText:A,url:E||void 0})),a.complete()):a.error(new Er({error:w,headers:v,status:g,statusText:A,url:E||void 0}))},d=v=>{let{url:g}=f(),A=new Er({error:v,status:u.status||0,statusText:u.statusText||"Unknown Error",url:g||void 0});a.error(A)},m=!1,y=v=>{m||(a.next(f()),m=!0);let g={type:Pr.DownloadProgress,loaded:v.loaded};v.lengthComputable&&(g.total=v.total),i.responseType==="text"&&u.responseText&&(g.partialText=u.responseText),a.next(g)},b=v=>{let g={type:Pr.UploadProgress,loaded:v.loaded};v.lengthComputable&&(g.total=v.total),a.next(g)};return u.addEventListener("load",h),u.addEventListener("error",d),u.addEventListener("timeout",d),u.addEventListener("abort",d),i.reportProgress&&(u.addEventListener("progress",y),l!==null&&u.upload&&u.upload.addEventListener("progress",b)),u.send(l),a.next({type:Pr.Sent}),()=>{u.removeEventListener("error",d),u.removeEventListener("abort",d),u.removeEventListener("load",h),u.removeEventListener("timeout",d),i.reportProgress&&(u.removeEventListener("progress",y),l!==null&&u.upload&&u.upload.removeEventListener("progress",b)),u.readyState!==u.DONE&&u.abort()}})))}};e.\u0275fac=function(o){return new(o||e)(J(Ta))},e.\u0275prov=W({token:e,factory:e.\u0275fac});let r=e;return r})(),Op=new ae(""),cw="XSRF-TOKEN",fw=new ae("",{providedIn:"root",factory:()=>cw}),hw="X-XSRF-TOKEN",dw=new ae("",{providedIn:"root",factory:()=>hw}),La=class{},pw=(()=>{let e=class e{constructor(i,o,s){this.doc=i,this.platform=o,this.cookieName=s,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if(this.platform==="server")return null;let i=this.doc.cookie||"";return i!==this.lastCookieString&&(this.parseCount++,this.lastToken=Oa(i,this.cookieName),this.lastCookieString=i),this.lastToken}};e.\u0275fac=function(o){return new(o||e)(J(Pe),J(un),J(fw))},e.\u0275prov=W({token:e,factory:e.\u0275fac});let r=e;return r})();function mw(r,e){let n=r.url.toLowerCase();if(!j(Op)||r.method==="GET"||r.method==="HEAD"||n.startsWith("http://")||n.startsWith("https://"))return e(r);let i=j(La).getToken(),o=j(dw);return i!=null&&!r.headers.has(o)&&(r=r.clone({headers:r.headers.set(o,i)})),e(r)}function Pp(...r){let e=[xc,Cp,Ap,{provide:ko,useExisting:Ap},{provide:za,useFactory:()=>j(rw,{optional:!0})??j(Cp)},{provide:Ep,useValue:mw,multi:!0},{provide:Op,useValue:!0},{provide:La,useClass:pw}];for(let n of r)e.push(...n.\u0275providers);return er(e)}var Ic=class extends rp{constructor(){super(...arguments),this.supportsDOMEvents=!0}},Ec=class r extends Ic{static makeCurrent(){tp(new r)}onAndCancel(e,n,i){return e.addEventListener(n,i),()=>{e.removeEventListener(n,i)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.remove()}createElement(e,n){return n=n||this.getDefaultDocument(),n.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return n==="window"?window:n==="document"?e:n==="body"?e.body:null}getBaseHref(e){let n=bw();return n==null?null:_w(n)}resetBaseElement(){jo=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return Oa(document.cookie,e)}},jo=null;function bw(){return jo=jo||document.querySelector("base"),jo?jo.getAttribute("href"):null}function _w(r){return new URL(r,document.baseURI).pathname}var ww=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(o){return new(o||e)},e.\u0275prov=W({token:e,factory:e.\u0275fac});let r=e;return r})(),Ua=new ae(""),Mp=(()=>{let e=class e{constructor(i,o){this._zone=o,this._eventNameToPlugin=new Map,i.forEach(s=>{s.manager=this}),this._plugins=i.slice().reverse()}addEventListener(i,o,s){return this._findPluginFor(o).addEventListener(i,o,s)}getZone(){return this._zone}_findPluginFor(i){let o=this._eventNameToPlugin.get(i);if(o)return o;if(o=this._plugins.find(a=>a.supports(i)),!o)throw new de(5101,!1);return this._eventNameToPlugin.set(i,o),o}};e.\u0275fac=function(o){return new(o||e)(J(Ua),J(tt))},e.\u0275prov=W({token:e,factory:e.\u0275fac});let r=e;return r})(),Fo=class{constructor(e){this._doc=e}},Ac="ng-app-id",kp=(()=>{let e=class e{constructor(i,o,s,a={}){this.doc=i,this.appId=o,this.nonce=s,this.platformId=a,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=Pa(a),this.resetHostNodes()}addStyles(i){for(let o of i)this.changeUsageCount(o,1)===1&&this.onStyleAdded(o)}removeStyles(i){for(let o of i)this.changeUsageCount(o,-1)<=0&&this.onStyleRemoved(o)}ngOnDestroy(){let i=this.styleNodesInDOM;i&&(i.forEach(o=>o.remove()),i.clear());for(let o of this.getAllStyles())this.onStyleRemoved(o);this.resetHostNodes()}addHost(i){this.hostNodes.add(i);for(let o of this.getAllStyles())this.addStyleToHost(i,o)}removeHost(i){this.hostNodes.delete(i)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(i){for(let o of this.hostNodes)this.addStyleToHost(o,i)}onStyleRemoved(i){let o=this.styleRef;o.get(i)?.elements?.forEach(s=>s.remove()),o.delete(i)}collectServerRenderedStyles(){let i=this.doc.head?.querySelectorAll(`style[${Ac}="${this.appId}"]`);if(i?.length){let o=new Map;return i.forEach(s=>{s.textContent!=null&&o.set(s.textContent,s)}),o}return null}changeUsageCount(i,o){let s=this.styleRef;if(s.has(i)){let a=s.get(i);return a.usage+=o,a.usage}return s.set(i,{usage:o,elements:[]}),o}getStyleElement(i,o){let s=this.styleNodesInDOM,a=s?.get(o);if(a?.parentNode===i)return s.delete(o),a.removeAttribute(Ac),a;{let u=this.doc.createElement("style");return this.nonce&&u.setAttribute("nonce",this.nonce),u.textContent=o,this.platformIsServer&&u.setAttribute(Ac,this.appId),i.appendChild(u),u}}addStyleToHost(i,o){let s=this.getStyleElement(i,o),a=this.styleRef,u=a.get(o)?.elements;u?u.push(s):a.set(o,{elements:[s],usage:1})}resetHostNodes(){let i=this.hostNodes;i.clear(),i.add(this.doc.head)}};e.\u0275fac=function(o){return new(o||e)(J(Pe),J(ql),J(Gl,8),J(un))},e.\u0275prov=W({token:e,factory:e.\u0275fac});let r=e;return r})(),Cc={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},Pc=/%COMP%/g,Dp="%COMP%",xw=`_nghost-${Dp}`,Aw=`_ngcontent-${Dp}`,Cw=!0,Iw=new ae("",{providedIn:"root",factory:()=>Cw});function Ew(r){return Aw.replace(Pc,r)}function Ow(r){return xw.replace(Pc,r)}function Np(r,e){return e.map(n=>n.replace(Pc,r))}var Va=(()=>{let e=class e{constructor(i,o,s,a,u,l,c,f=null){this.eventManager=i,this.sharedStylesHost=o,this.appId=s,this.removeStylesOnCompDestroy=a,this.doc=u,this.platformId=l,this.ngZone=c,this.nonce=f,this.rendererByCompId=new Map,this.platformIsServer=Pa(l),this.defaultRenderer=new zo(i,u,c,this.platformIsServer)}createRenderer(i,o){if(!i||!o)return this.defaultRenderer;this.platformIsServer&&o.encapsulation===_o.ShadowDom&&(o=_(p({},o),{encapsulation:_o.Emulated}));let s=this.getOrCreateRenderer(i,o);return s instanceof Ba?s.applyToHost(i):s instanceof $o&&s.applyStyles(),s}getOrCreateRenderer(i,o){let s=this.rendererByCompId,a=s.get(o.id);if(!a){let u=this.doc,l=this.ngZone,c=this.eventManager,f=this.sharedStylesHost,h=this.removeStylesOnCompDestroy,d=this.platformIsServer;switch(o.encapsulation){case _o.Emulated:a=new Ba(c,f,o,this.appId,h,u,l,d);break;case _o.ShadowDom:return new Oc(c,f,i,o,u,l,this.nonce,d);default:a=new $o(c,f,o,h,u,l,d);break}s.set(o.id,a)}return a}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(o){return new(o||e)(J(Mp),J(kp),J(ql),J(Iw),J(Pe),J(un),J(tt),J(Gl))},e.\u0275prov=W({token:e,factory:e.\u0275fac});let r=e;return r})(),zo=class{constructor(e,n,i,o){this.eventManager=e,this.doc=n,this.ngZone=i,this.platformIsServer=o,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,n){return n?this.doc.createElementNS(Cc[n]||n,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,n){(Tp(e)?e.content:e).appendChild(n)}insertBefore(e,n,i){e&&(Tp(e)?e.content:e).insertBefore(n,i)}removeChild(e,n){n.remove()}selectRootElement(e,n){let i=typeof e=="string"?this.doc.querySelector(e):e;if(!i)throw new de(-5104,!1);return n||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,i,o){if(o){n=o+":"+n;let s=Cc[o];s?e.setAttributeNS(s,n,i):e.setAttribute(n,i)}else e.setAttribute(n,i)}removeAttribute(e,n,i){if(i){let o=Cc[i];o?e.removeAttributeNS(o,n):e.removeAttribute(`${i}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,i,o){o&(Ao.DashCase|Ao.Important)?e.style.setProperty(n,i,o&Ao.Important?"important":""):e.style[n]=i}removeStyle(e,n,i){i&Ao.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,i){e!=null&&(e[n]=i)}setValue(e,n){e.nodeValue=n}listen(e,n,i){if(typeof e=="string"&&(e=yi().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${n}`);return this.eventManager.addEventListener(e,n,this.decoratePreventDefault(i))}decoratePreventDefault(e){return n=>{if(n==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(n)):e(n))===!1&&n.preventDefault()}}};function Tp(r){return r.tagName==="TEMPLATE"&&r.content!==void 0}var Oc=class extends zo{constructor(e,n,i,o,s,a,u,l){super(e,s,a,l),this.sharedStylesHost=n,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let c=Np(o.id,o.styles);for(let f of c){let h=document.createElement("style");u&&h.setAttribute("nonce",u),h.textContent=f,this.shadowRoot.appendChild(h)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,i){return super.insertBefore(this.nodeOrShadowRoot(e),n,i)}removeChild(e,n){return super.removeChild(null,n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},$o=class extends zo{constructor(e,n,i,o,s,a,u,l){super(e,s,a,u),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=o,this.styles=l?Np(l,i.styles):i.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},Ba=class extends $o{constructor(e,n,i,o,s,a,u,l){let c=o+"-"+i.id;super(e,n,i,s,a,u,l,c),this.contentAttr=Ew(c),this.hostAttr=Ow(c)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,n){let i=super.createElement(e,n);return super.setAttribute(i,this.contentAttr,""),i}},Pw=(()=>{let e=class e extends Fo{constructor(i){super(i)}supports(i){return!0}addEventListener(i,o,s){return i.addEventListener(o,s,!1),()=>this.removeEventListener(i,o,s)}removeEventListener(i,o,s){return i.removeEventListener(o,s)}};e.\u0275fac=function(o){return new(o||e)(J(Pe))},e.\u0275prov=W({token:e,factory:e.\u0275fac});let r=e;return r})(),Tw=(()=>{let e=class e extends Fo{constructor(i){super(i),this.delegate=j(ep,{optional:!0})}supports(i){return this.delegate?this.delegate.supports(i):!1}addEventListener(i,o,s){return this.delegate.addEventListener(i,o,s)}removeEventListener(i,o,s){return this.delegate.removeEventListener(i,o,s)}};e.\u0275fac=function(o){return new(o||e)(J(Pe))},e.\u0275prov=W({token:e,factory:e.\u0275fac});let r=e;return r})(),Sp=["alt","control","meta","shift"],Sw={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Rw={alt:r=>r.altKey,control:r=>r.ctrlKey,meta:r=>r.metaKey,shift:r=>r.shiftKey},Mw=(()=>{let e=class e extends Fo{constructor(i){super(i)}supports(i){return e.parseEventName(i)!=null}addEventListener(i,o,s){let a=e.parseEventName(o),u=e.eventCallback(a.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>yi().onAndCancel(i,a.domEventName,u))}static parseEventName(i){let o=i.toLowerCase().split("."),s=o.shift();if(o.length===0||!(s==="keydown"||s==="keyup"))return null;let a=e._normalizeKey(o.pop()),u="",l=o.indexOf("code");if(l>-1&&(o.splice(l,1),u="code."),Sp.forEach(f=>{let h=o.indexOf(f);h>-1&&(o.splice(h,1),u+=f+".")}),u+=a,o.length!=0||a.length===0)return null;let c={};return c.domEventName=s,c.fullKey=u,c}static matchEventFullKeyCode(i,o){let s=Sw[i.key]||i.key,a="";return o.indexOf("code.")>-1&&(s=i.code,a="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),Sp.forEach(u=>{if(u!==s){let l=Rw[u];l(i)&&(a+=u+".")}}),a+=s,a===o)}static eventCallback(i,o,s){return a=>{e.matchEventFullKeyCode(a,i)&&s.runGuarded(()=>o(a))}}static _normalizeKey(i){return i==="esc"?"escape":i}};e.\u0275fac=function(o){return new(o||e)(J(Pe))},e.\u0275prov=W({token:e,factory:e.\u0275fac});let r=e;return r})();function jp(r,e){return Qd(p({rootComponent:r},kw(e)))}function kw(r){return{appProviders:[...zw,...r?.providers??[]],platformProviders:Fw}}function Dw(){Ec.makeCurrent()}function Nw(){return new Bl}function jw(){return Sd(document),document}var Fw=[{provide:un,useValue:ip},{provide:Rd,useValue:Dw,multi:!0},{provide:Pe,useFactory:jw,deps:[]}];var zw=[{provide:Td,useValue:"root"},{provide:Bl,useFactory:Nw,deps:[]},{provide:Ua,useClass:Pw,multi:!0,deps:[Pe,tt,un]},{provide:Ua,useClass:Mw,multi:!0,deps:[Pe]},{provide:Ua,useClass:Tw,multi:!0},Va,kp,Mp,{provide:ba,useExisting:Va},{provide:Ta,useClass:ww,deps:[]},[]];var Fp=(()=>{let e=class e{constructor(i){this._doc=i}getTitle(){return this._doc.title}setTitle(i){this._doc.title=i||""}};e.\u0275fac=function(o){return new(o||e)(J(Pe))},e.\u0275prov=W({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})();var Tc=(()=>{let e=class e{};e.\u0275fac=function(o){return new(o||e)},e.\u0275prov=W({token:e,factory:function(o){let s=null;return o?s=new(o||e):s=J($w),s},providedIn:"root"});let r=e;return r})(),$w=(()=>{let e=class e extends Tc{constructor(i){super(),this._doc=i}sanitize(i,o){if(o==null)return null;switch(i){case rr.NONE:return o;case rr.HTML:return gi(o,"HTML")?mi(o):$d(this._doc,String(o)).toString();case rr.STYLE:return gi(o,"Style")?mi(o):o;case rr.SCRIPT:if(gi(o,"Script"))return mi(o);throw new de(5200,!1);case rr.URL:return gi(o,"URL")?mi(o):zd(String(o));case rr.RESOURCE_URL:if(gi(o,"ResourceURL"))return mi(o);throw new de(5201,!1);default:throw new de(5202,!1)}}bypassSecurityTrustHtml(i){return kd(i)}bypassSecurityTrustStyle(i){return Dd(i)}bypassSecurityTrustScript(i){return Nd(i)}bypassSecurityTrustUrl(i){return jd(i)}bypassSecurityTrustResourceUrl(i){return Fd(i)}};e.\u0275fac=function(o){return new(o||e)(J(Pe))},e.\u0275prov=W({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})();var Y="primary",rs=Symbol("RouteTitle"),Dc=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n[0]:n}return null}getAll(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}};function Ii(r){return new Dc(r)}function Lw(r,e,n){let i=n.path.split("/");if(i.length>r.length||n.pathMatch==="full"&&(e.hasChildren()||i.length<r.length))return null;let o={};for(let s=0;s<i.length;s++){let a=i[s],u=r[s];if(a[0]===":")o[a.substring(1)]=u;else if(a!==u.path)return null}return{consumed:r.slice(0,i.length),posParams:o}}function Uw(r,e){if(r.length!==e.length)return!1;for(let n=0;n<r.length;++n)if(!Vt(r[n],e[n]))return!1;return!0}function Vt(r,e){let n=r?Nc(r):void 0,i=e?Nc(e):void 0;if(!n||!i||n.length!=i.length)return!1;let o;for(let s=0;s<n.length;s++)if(o=n[s],!Hp(r[o],e[o]))return!1;return!0}function Nc(r){return[...Object.keys(r),...Object.getOwnPropertySymbols(r)]}function Hp(r,e){if(Array.isArray(r)&&Array.isArray(e)){if(r.length!==e.length)return!1;let n=[...r].sort(),i=[...e].sort();return n.every((o,s)=>i[s]===o)}else return r===e}function Wp(r){return r.length>0?r[r.length-1]:null}function Tr(r){return bd(r)?r:Ca(r)?Ge(Promise.resolve(r)):H(r)}var Vw={exact:Zp,subset:Xp},Kp={exact:Bw,subset:qw,ignored:()=>!0};function $p(r,e,n){return Vw[n.paths](r.root,e.root,n.matrixParams)&&Kp[n.queryParams](r.queryParams,e.queryParams)&&!(n.fragment==="exact"&&r.fragment!==e.fragment)}function Bw(r,e){return Vt(r,e)}function Zp(r,e,n){if(!vn(r.segments,e.segments)||!Ha(r.segments,e.segments,n)||r.numberOfChildren!==e.numberOfChildren)return!1;for(let i in e.children)if(!r.children[i]||!Zp(r.children[i],e.children[i],n))return!1;return!0}function qw(r,e){return Object.keys(e).length<=Object.keys(r).length&&Object.keys(e).every(n=>Hp(r[n],e[n]))}function Xp(r,e,n){return Jp(r,e,e.segments,n)}function Jp(r,e,n,i){if(r.segments.length>n.length){let o=r.segments.slice(0,n.length);return!(!vn(o,n)||e.hasChildren()||!Ha(o,n,i))}else if(r.segments.length===n.length){if(!vn(r.segments,n)||!Ha(r.segments,n,i))return!1;for(let o in e.children)if(!r.children[o]||!Xp(r.children[o],e.children[o],i))return!1;return!0}else{let o=n.slice(0,r.segments.length),s=n.slice(r.segments.length);return!vn(r.segments,o)||!Ha(r.segments,o,i)||!r.children[Y]?!1:Jp(r.children[Y],e,s,i)}}function Ha(r,e,n){return e.every((i,o)=>Kp[n](r[o].parameters,i.parameters))}var lr=class{constructor(e=new oe([],{}),n={},i=null){this.root=e,this.queryParams=n,this.fragment=i}get queryParamMap(){return this._queryParamMap??=Ii(this.queryParams),this._queryParamMap}toString(){return Ww.serialize(this)}},oe=class{constructor(e,n){this.segments=e,this.children=n,this.parent=null,Object.values(n).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Wa(this)}},yn=class{constructor(e,n){this.path=e,this.parameters=n}get parameterMap(){return this._parameterMap??=Ii(this.parameters),this._parameterMap}toString(){return Qp(this)}};function Gw(r,e){return vn(r,e)&&r.every((n,i)=>Vt(n.parameters,e[i].parameters))}function vn(r,e){return r.length!==e.length?!1:r.every((n,i)=>n.path===e[i].path)}function Hw(r,e){let n=[];return Object.entries(r.children).forEach(([i,o])=>{i===Y&&(n=n.concat(e(o,i)))}),Object.entries(r.children).forEach(([i,o])=>{i!==Y&&(n=n.concat(e(o,i)))}),n}var uf=(()=>{let e=class e{};e.\u0275fac=function(o){return new(o||e)},e.\u0275prov=W({token:e,factory:()=>new Ho,providedIn:"root"});let r=e;return r})(),Ho=class{parse(e){let n=new Fc(e);return new lr(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(e){let n=`/${Lo(e.root,!0)}`,i=Xw(e.queryParams),o=typeof e.fragment=="string"?`#${Kw(e.fragment)}`:"";return`${n}${i}${o}`}},Ww=new Ho;function Wa(r){return r.segments.map(e=>Qp(e)).join("/")}function Lo(r,e){if(!r.hasChildren())return Wa(r);if(e){let n=r.children[Y]?Lo(r.children[Y],!1):"",i=[];return Object.entries(r.children).forEach(([o,s])=>{o!==Y&&i.push(`${o}:${Lo(s,!1)}`)}),i.length>0?`${n}(${i.join("//")})`:n}else{let n=Hw(r,(i,o)=>o===Y?[Lo(r.children[Y],!1)]:[`${o}:${Lo(i,!1)}`]);return Object.keys(r.children).length===1&&r.children[Y]!=null?`${Wa(r)}/${n[0]}`:`${Wa(r)}/(${n.join("//")})`}}function Yp(r){return encodeURIComponent(r).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function qa(r){return Yp(r).replace(/%3B/gi,";")}function Kw(r){return encodeURI(r)}function jc(r){return Yp(r).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Ka(r){return decodeURIComponent(r)}function Lp(r){return Ka(r.replace(/\+/g,"%20"))}function Qp(r){return`${jc(r.path)}${Zw(r.parameters)}`}function Zw(r){return Object.entries(r).map(([e,n])=>`;${jc(e)}=${jc(n)}`).join("")}function Xw(r){let e=Object.entries(r).map(([n,i])=>Array.isArray(i)?i.map(o=>`${qa(n)}=${qa(o)}`).join("&"):`${qa(n)}=${qa(i)}`).filter(n=>n);return e.length?`?${e.join("&")}`:""}var Jw=/^[^\/()?;#]+/;function Sc(r){let e=r.match(Jw);return e?e[0]:""}var Yw=/^[^\/()?;=#]+/;function Qw(r){let e=r.match(Yw);return e?e[0]:""}var ex=/^[^=?&#]+/;function tx(r){let e=r.match(ex);return e?e[0]:""}var rx=/^[^&#]+/;function nx(r){let e=r.match(rx);return e?e[0]:""}var Fc=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new oe([],{}):new oe([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(n).length>0)&&(i[Y]=new oe(e,n)),i}parseSegment(){let e=Sc(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new de(4009,!1);return this.capture(e),new yn(Ka(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let n=Qw(this.remaining);if(!n)return;this.capture(n);let i="";if(this.consumeOptional("=")){let o=Sc(this.remaining);o&&(i=o,this.capture(i))}e[Ka(n)]=Ka(i)}parseQueryParam(e){let n=tx(this.remaining);if(!n)return;this.capture(n);let i="";if(this.consumeOptional("=")){let a=nx(this.remaining);a&&(i=a,this.capture(i))}let o=Lp(n),s=Lp(i);if(e.hasOwnProperty(o)){let a=e[o];Array.isArray(a)||(a=[a],e[o]=a),a.push(s)}else e[o]=s}parseParens(e){let n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let i=Sc(this.remaining),o=this.remaining[i.length];if(o!=="/"&&o!==")"&&o!==";")throw new de(4010,!1);let s;i.indexOf(":")>-1?(s=i.slice(0,i.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=Y);let a=this.parseChildren();n[s]=Object.keys(a).length===1?a[Y]:new oe([],a),this.consumeOptional("//")}return n}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new de(4011,!1)}};function em(r){return r.segments.length>0?new oe([],{[Y]:r}):r}function tm(r){let e={};for(let[i,o]of Object.entries(r.children)){let s=tm(o);if(i===Y&&s.segments.length===0&&s.hasChildren())for(let[a,u]of Object.entries(s.children))e[a]=u;else(s.segments.length>0||s.hasChildren())&&(e[i]=s)}let n=new oe(r.segments,e);return ix(n)}function ix(r){if(r.numberOfChildren===1&&r.children[Y]){let e=r.children[Y];return new oe(r.segments.concat(e.segments),e.children)}return r}function Wo(r){return r instanceof lr}function ox(r,e,n=null,i=null){let o=rm(r);return nm(o,e,n,i)}function rm(r){let e;function n(s){let a={};for(let l of s.children){let c=n(l);a[l.outlet]=c}let u=new oe(s.url,a);return s===r&&(e=u),u}let i=n(r.root),o=em(i);return e??o}function nm(r,e,n,i){let o=r;for(;o.parent;)o=o.parent;if(e.length===0)return Rc(o,o,o,n,i);let s=sx(e);if(s.toRoot())return Rc(o,o,new oe([],{}),n,i);let a=ax(s,o,r),u=a.processChildren?Bo(a.segmentGroup,a.index,s.commands):om(a.segmentGroup,a.index,s.commands);return Rc(o,a.segmentGroup,u,n,i)}function Za(r){return typeof r=="object"&&r!=null&&!r.outlets&&!r.segmentPath}function Ko(r){return typeof r=="object"&&r!=null&&r.outlets}function Rc(r,e,n,i,o){let s={};i&&Object.entries(i).forEach(([l,c])=>{s[l]=Array.isArray(c)?c.map(f=>`${f}`):`${c}`});let a;r===e?a=n:a=im(r,e,n);let u=em(tm(a));return new lr(u,s,o)}function im(r,e,n){let i={};return Object.entries(r.children).forEach(([o,s])=>{s===e?i[o]=n:i[o]=im(s,e,n)}),new oe(r.segments,i)}var Xa=class{constructor(e,n,i){if(this.isAbsolute=e,this.numberOfDoubleDots=n,this.commands=i,e&&i.length>0&&Za(i[0]))throw new de(4003,!1);let o=i.find(Ko);if(o&&o!==Wp(i))throw new de(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function sx(r){if(typeof r[0]=="string"&&r.length===1&&r[0]==="/")return new Xa(!0,0,r);let e=0,n=!1,i=r.reduce((o,s,a)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let u={};return Object.entries(s.outlets).forEach(([l,c])=>{u[l]=typeof c=="string"?c.split("/"):c}),[...o,{outlets:u}]}if(s.segmentPath)return[...o,s.segmentPath]}return typeof s!="string"?[...o,s]:a===0?(s.split("/").forEach((u,l)=>{l==0&&u==="."||(l==0&&u===""?n=!0:u===".."?e++:u!=""&&o.push(u))}),o):[...o,s]},[]);return new Xa(n,e,i)}var xi=class{constructor(e,n,i){this.segmentGroup=e,this.processChildren=n,this.index=i}};function ax(r,e,n){if(r.isAbsolute)return new xi(e,!0,0);if(!n)return new xi(e,!1,NaN);if(n.parent===null)return new xi(n,!0,0);let i=Za(r.commands[0])?0:1,o=n.segments.length-1+i;return ux(n,o,r.numberOfDoubleDots)}function ux(r,e,n){let i=r,o=e,s=n;for(;s>o;){if(s-=o,i=i.parent,!i)throw new de(4005,!1);o=i.segments.length}return new xi(i,!1,o-s)}function lx(r){return Ko(r[0])?r[0].outlets:{[Y]:r}}function om(r,e,n){if(r??=new oe([],{}),r.segments.length===0&&r.hasChildren())return Bo(r,e,n);let i=cx(r,e,n),o=n.slice(i.commandIndex);if(i.match&&i.pathIndex<r.segments.length){let s=new oe(r.segments.slice(0,i.pathIndex),{});return s.children[Y]=new oe(r.segments.slice(i.pathIndex),r.children),Bo(s,0,o)}else return i.match&&o.length===0?new oe(r.segments,{}):i.match&&!r.hasChildren()?zc(r,e,n):i.match?Bo(r,0,o):zc(r,e,n)}function Bo(r,e,n){if(n.length===0)return new oe(r.segments,{});{let i=lx(n),o={};if(Object.keys(i).some(s=>s!==Y)&&r.children[Y]&&r.numberOfChildren===1&&r.children[Y].segments.length===0){let s=Bo(r.children[Y],e,n);return new oe(r.segments,s.children)}return Object.entries(i).forEach(([s,a])=>{typeof a=="string"&&(a=[a]),a!==null&&(o[s]=om(r.children[s],e,a))}),Object.entries(r.children).forEach(([s,a])=>{i[s]===void 0&&(o[s]=a)}),new oe(r.segments,o)}}function cx(r,e,n){let i=0,o=e,s={match:!1,pathIndex:0,commandIndex:0};for(;o<r.segments.length;){if(i>=n.length)return s;let a=r.segments[o],u=n[i];if(Ko(u))break;let l=`${u}`,c=i<n.length-1?n[i+1]:null;if(o>0&&l===void 0)break;if(l&&c&&typeof c=="object"&&c.outlets===void 0){if(!Vp(l,c,a))return s;i+=2}else{if(!Vp(l,{},a))return s;i++}o++}return{match:!0,pathIndex:o,commandIndex:i}}function zc(r,e,n){let i=r.segments.slice(0,e),o=0;for(;o<n.length;){let s=n[o];if(Ko(s)){let l=fx(s.outlets);return new oe(i,l)}if(o===0&&Za(n[0])){let l=r.segments[e];i.push(new yn(l.path,Up(n[0]))),o++;continue}let a=Ko(s)?s.outlets[Y]:`${s}`,u=o<n.length-1?n[o+1]:null;a&&u&&Za(u)?(i.push(new yn(a,Up(u))),o+=2):(i.push(new yn(a,{})),o++)}return new oe(i,{})}function fx(r){let e={};return Object.entries(r).forEach(([n,i])=>{typeof i=="string"&&(i=[i]),i!==null&&(e[n]=zc(new oe([],{}),0,i))}),e}function Up(r){let e={};return Object.entries(r).forEach(([n,i])=>e[n]=`${i}`),e}function Vp(r,e,n){return r==n.path&&Vt(e,n.parameters)}var qo="imperative",Fe=function(r){return r[r.NavigationStart=0]="NavigationStart",r[r.NavigationEnd=1]="NavigationEnd",r[r.NavigationCancel=2]="NavigationCancel",r[r.NavigationError=3]="NavigationError",r[r.RoutesRecognized=4]="RoutesRecognized",r[r.ResolveStart=5]="ResolveStart",r[r.ResolveEnd=6]="ResolveEnd",r[r.GuardsCheckStart=7]="GuardsCheckStart",r[r.GuardsCheckEnd=8]="GuardsCheckEnd",r[r.RouteConfigLoadStart=9]="RouteConfigLoadStart",r[r.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",r[r.ChildActivationStart=11]="ChildActivationStart",r[r.ChildActivationEnd=12]="ChildActivationEnd",r[r.ActivationStart=13]="ActivationStart",r[r.ActivationEnd=14]="ActivationEnd",r[r.Scroll=15]="Scroll",r[r.NavigationSkipped=16]="NavigationSkipped",r}(Fe||{}),pt=class{constructor(e,n){this.id=e,this.url=n}},Zo=class extends pt{constructor(e,n,i="imperative",o=null){super(e,n),this.type=Fe.NavigationStart,this.navigationTrigger=i,this.restoredState=o}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},bn=class extends pt{constructor(e,n,i){super(e,n),this.urlAfterRedirects=i,this.type=Fe.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},it=function(r){return r[r.Redirect=0]="Redirect",r[r.SupersededByNewNavigation=1]="SupersededByNewNavigation",r[r.NoDataFromResolver=2]="NoDataFromResolver",r[r.GuardRejected=3]="GuardRejected",r}(it||{}),$c=function(r){return r[r.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",r[r.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",r}($c||{}),ur=class extends pt{constructor(e,n,i,o){super(e,n),this.reason=i,this.code=o,this.type=Fe.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},_n=class extends pt{constructor(e,n,i,o){super(e,n),this.reason=i,this.code=o,this.type=Fe.NavigationSkipped}},Xo=class extends pt{constructor(e,n,i,o){super(e,n),this.error=i,this.target=o,this.type=Fe.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Ja=class extends pt{constructor(e,n,i,o){super(e,n),this.urlAfterRedirects=i,this.state=o,this.type=Fe.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Lc=class extends pt{constructor(e,n,i,o){super(e,n),this.urlAfterRedirects=i,this.state=o,this.type=Fe.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Uc=class extends pt{constructor(e,n,i,o,s){super(e,n),this.urlAfterRedirects=i,this.state=o,this.shouldActivate=s,this.type=Fe.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Vc=class extends pt{constructor(e,n,i,o){super(e,n),this.urlAfterRedirects=i,this.state=o,this.type=Fe.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Bc=class extends pt{constructor(e,n,i,o){super(e,n),this.urlAfterRedirects=i,this.state=o,this.type=Fe.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},qc=class{constructor(e){this.route=e,this.type=Fe.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Gc=class{constructor(e){this.route=e,this.type=Fe.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Hc=class{constructor(e){this.snapshot=e,this.type=Fe.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Wc=class{constructor(e){this.snapshot=e,this.type=Fe.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Kc=class{constructor(e){this.snapshot=e,this.type=Fe.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Zc=class{constructor(e){this.snapshot=e,this.type=Fe.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var Jo=class{},Ei=class{constructor(e,n){this.url=e,this.navigationBehaviorOptions=n}};function hx(r,e){return r.providers&&!r._injector&&(r._injector=qd(r.providers,e,`Route: ${r.path}`)),r._injector??e}function Tt(r){return r.outlet||Y}function dx(r,e){let n=r.filter(i=>Tt(i)===e);return n.push(...r.filter(i=>Tt(i)!==e)),n}function ns(r){if(!r)return null;if(r.routeConfig?._injector)return r.routeConfig._injector;for(let e=r.parent;e;e=e.parent){let n=e.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}var Xc=class{get injector(){return ns(this.route?.snapshot)??this.rootInjector}set injector(e){}constructor(e){this.rootInjector=e,this.outlet=null,this.route=null,this.children=new iu(this.rootInjector),this.attachRef=null}},iu=(()=>{let e=class e{constructor(i){this.rootInjector=i,this.contexts=new Map}onChildOutletCreated(i,o){let s=this.getOrCreateContext(i);s.outlet=o,this.contexts.set(i,s)}onChildOutletDestroyed(i){let o=this.getContext(i);o&&(o.outlet=null,o.attachRef=null)}onOutletDeactivated(){let i=this.contexts;return this.contexts=new Map,i}onOutletReAttached(i){this.contexts=i}getOrCreateContext(i){let o=this.getContext(i);return o||(o=new Xc(this.rootInjector),this.contexts.set(i,o)),o}getContext(i){return this.contexts.get(i)||null}};e.\u0275fac=function(o){return new(o||e)(J(pi))},e.\u0275prov=W({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})(),Ya=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let n=this.pathFromRoot(e);return n.length>1?n[n.length-2]:null}children(e){let n=Jc(e,this._root);return n?n.children.map(i=>i.value):[]}firstChild(e){let n=Jc(e,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(e){let n=Yc(e,this._root);return n.length<2?[]:n[n.length-2].children.map(o=>o.value).filter(o=>o!==e)}pathFromRoot(e){return Yc(e,this._root).map(n=>n.value)}};function Jc(r,e){if(r===e.value)return e;for(let n of e.children){let i=Jc(r,n);if(i)return i}return null}function Yc(r,e){if(r===e.value)return[e];for(let n of e.children){let i=Yc(r,n);if(i.length)return i.unshift(e),i}return[]}var nt=class{constructor(e,n){this.value=e,this.children=n}toString(){return`TreeNode(${this.value})`}};function wi(r){let e={};return r&&r.children.forEach(n=>e[n.value.outlet]=n),e}var Qa=class extends Ya{constructor(e,n){super(e),this.snapshot=n,lf(this,e)}toString(){return this.snapshot.toString()}};function sm(r){let e=px(r),n=new ft([new yn("",{})]),i=new ft({}),o=new ft({}),s=new ft({}),a=new ft(""),u=new Oi(n,i,s,a,o,Y,r,e.root);return u.snapshot=e.root,new Qa(new nt(u,[]),e)}function px(r){let e={},n={},i={},o="",s=new Ai([],e,i,o,n,Y,r,null,{});return new tu("",new nt(s,[]))}var Oi=class{constructor(e,n,i,o,s,a,u,l){this.urlSubject=e,this.paramsSubject=n,this.queryParamsSubject=i,this.fragmentSubject=o,this.dataSubject=s,this.outlet=a,this.component=u,this._futureSnapshot=l,this.title=this.dataSubject?.pipe(ne(c=>c[rs]))??H(void 0),this.url=e,this.params=n,this.queryParams=i,this.fragment=o,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(ne(e=>Ii(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(ne(e=>Ii(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function eu(r,e,n="emptyOnly"){let i,{routeConfig:o}=r;return e!==null&&(n==="always"||o?.path===""||!e.component&&!e.routeConfig?.loadComponent)?i={params:p(p({},e.params),r.params),data:p(p({},e.data),r.data),resolve:p(p(p(p({},r.data),e.data),o?.data),r._resolvedData)}:i={params:p({},r.params),data:p({},r.data),resolve:p(p({},r.data),r._resolvedData??{})},o&&um(o)&&(i.resolve[rs]=o.title),i}var Ai=class{get title(){return this.data?.[rs]}constructor(e,n,i,o,s,a,u,l,c){this.url=e,this.params=n,this.queryParams=i,this.fragment=o,this.data=s,this.outlet=a,this.component=u,this.routeConfig=l,this._resolve=c}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Ii(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Ii(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(i=>i.toString()).join("/"),n=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${n}')`}},tu=class extends Ya{constructor(e,n){super(n),this.url=e,lf(this,n)}toString(){return am(this._root)}};function lf(r,e){e.value._routerState=r,e.children.forEach(n=>lf(r,n))}function am(r){let e=r.children.length>0?` { ${r.children.map(am).join(", ")} } `:"";return`${r.value}${e}`}function Mc(r){if(r.snapshot){let e=r.snapshot,n=r._futureSnapshot;r.snapshot=n,Vt(e.queryParams,n.queryParams)||r.queryParamsSubject.next(n.queryParams),e.fragment!==n.fragment&&r.fragmentSubject.next(n.fragment),Vt(e.params,n.params)||r.paramsSubject.next(n.params),Uw(e.url,n.url)||r.urlSubject.next(n.url),Vt(e.data,n.data)||r.dataSubject.next(n.data)}else r.snapshot=r._futureSnapshot,r.dataSubject.next(r._futureSnapshot.data)}function Qc(r,e){let n=Vt(r.params,e.params)&&Gw(r.url,e.url),i=!r.parent!=!e.parent;return n&&!i&&(!r.parent||Qc(r.parent,e.parent))}function um(r){return typeof r.title=="string"||r.title===null}var cf=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=Y,this.activateEvents=new tr,this.deactivateEvents=new tr,this.attachEvents=new tr,this.detachEvents=new tr,this.parentContexts=j(iu),this.location=j(Vd),this.changeDetector=j(Oo),this.inputBinder=j(ff,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(i){if(i.name){let{firstChange:o,previousValue:s}=i.name;if(o)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(i){return this.parentContexts.getContext(i)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let i=this.parentContexts.getContext(this.name);i?.route&&(i.attachRef?this.attach(i.attachRef,i.route):this.activateWith(i.route,i.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new de(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new de(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new de(4012,!1);this.location.detach();let i=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(i.instance),i}attach(i,o){this.activated=i,this._activatedRoute=o,this.location.insert(i.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(i.instance)}deactivate(){if(this.activated){let i=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(i)}}activateWith(i,o){if(this.isActivated)throw new de(4013,!1);this._activatedRoute=i;let s=this.location,u=i.snapshot.component,l=this.parentContexts.getOrCreateContext(this.name).children,c=new ef(i,l,s.injector);this.activated=s.createComponent(u,{index:s.length,injector:c,environmentInjector:o}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(o){return new(o||e)},e.\u0275dir=Qt({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[ya]});let r=e;return r})(),ef=class r{__ngOutletInjector(e){return new r(this.route,this.childContexts,e)}constructor(e,n,i){this.route=e,this.childContexts=n,this.parent=i}get(e,n){return e===Oi?this.route:e===iu?this.childContexts:this.parent.get(e,n)}},ff=new ae("");function mx(r,e,n){let i=Yo(r,e._root,n?n._root:void 0);return new Qa(i,e)}function Yo(r,e,n){if(n&&r.shouldReuseRoute(e.value,n.value.snapshot)){let i=n.value;i._futureSnapshot=e.value;let o=gx(r,e,n);return new nt(i,o)}else{if(r.shouldAttach(e.value)){let s=r.retrieve(e.value);if(s!==null){let a=s.route;return a.value._futureSnapshot=e.value,a.children=e.children.map(u=>Yo(r,u)),a}}let i=yx(e.value),o=e.children.map(s=>Yo(r,s));return new nt(i,o)}}function gx(r,e,n){return e.children.map(i=>{for(let o of n.children)if(r.shouldReuseRoute(i.value,o.value.snapshot))return Yo(r,i,o);return Yo(r,i)})}function yx(r){return new Oi(new ft(r.url),new ft(r.params),new ft(r.queryParams),new ft(r.fragment),new ft(r.data),r.outlet,r.component,r)}var Qo=class{constructor(e,n){this.redirectTo=e,this.navigationBehaviorOptions=n}},lm="ngNavigationCancelingError";function ru(r,e){let{redirectTo:n,navigationBehaviorOptions:i}=Wo(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,o=cm(!1,it.Redirect);return o.url=n,o.navigationBehaviorOptions=i,o}function cm(r,e){let n=new Error(`NavigationCancelingError: ${r||""}`);return n[lm]=!0,n.cancellationCode=e,n}function vx(r){return fm(r)&&Wo(r.url)}function fm(r){return!!r&&r[lm]}var bx=(r,e,n,i)=>ne(o=>(new tf(e,o.targetRouterState,o.currentRouterState,n,i).activate(r),o)),tf=class{constructor(e,n,i,o,s){this.routeReuseStrategy=e,this.futureState=n,this.currState=i,this.forwardEvent=o,this.inputBindingEnabled=s}activate(e){let n=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,i,e),Mc(this.futureState.root),this.activateChildRoutes(n,i,e)}deactivateChildRoutes(e,n,i){let o=wi(n);e.children.forEach(s=>{let a=s.value.outlet;this.deactivateRoutes(s,o[a],i),delete o[a]}),Object.values(o).forEach(s=>{this.deactivateRouteAndItsChildren(s,i)})}deactivateRoutes(e,n,i){let o=e.value,s=n?n.value:null;if(o===s)if(o.component){let a=i.getContext(o.outlet);a&&this.deactivateChildRoutes(e,n,a.children)}else this.deactivateChildRoutes(e,n,i);else s&&this.deactivateRouteAndItsChildren(n,i)}deactivateRouteAndItsChildren(e,n){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,n):this.deactivateRouteAndOutlet(e,n)}detachAndStoreRouteSubtree(e,n){let i=n.getContext(e.value.outlet),o=i&&e.value.component?i.children:n,s=wi(e);for(let a of Object.values(s))this.deactivateRouteAndItsChildren(a,o);if(i&&i.outlet){let a=i.outlet.detach(),u=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:a,route:e,contexts:u})}}deactivateRouteAndOutlet(e,n){let i=n.getContext(e.value.outlet),o=i&&e.value.component?i.children:n,s=wi(e);for(let a of Object.values(s))this.deactivateRouteAndItsChildren(a,o);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(e,n,i){let o=wi(n);e.children.forEach(s=>{this.activateRoutes(s,o[s.value.outlet],i),this.forwardEvent(new Zc(s.value.snapshot))}),e.children.length&&this.forwardEvent(new Wc(e.value.snapshot))}activateRoutes(e,n,i){let o=e.value,s=n?n.value:null;if(Mc(o),o===s)if(o.component){let a=i.getOrCreateContext(o.outlet);this.activateChildRoutes(e,n,a.children)}else this.activateChildRoutes(e,n,i);else if(o.component){let a=i.getOrCreateContext(o.outlet);if(this.routeReuseStrategy.shouldAttach(o.snapshot)){let u=this.routeReuseStrategy.retrieve(o.snapshot);this.routeReuseStrategy.store(o.snapshot,null),a.children.onOutletReAttached(u.contexts),a.attachRef=u.componentRef,a.route=u.route.value,a.outlet&&a.outlet.attach(u.componentRef,u.route.value),Mc(u.route.value),this.activateChildRoutes(e,null,a.children)}else a.attachRef=null,a.route=o,a.outlet&&a.outlet.activateWith(o,a.injector),this.activateChildRoutes(e,null,a.children)}else this.activateChildRoutes(e,null,i)}},nu=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Ci=class{constructor(e,n){this.component=e,this.route=n}};function _x(r,e,n){let i=r._root,o=e?e._root:null;return Uo(i,o,n,[i.value])}function wx(r){let e=r.routeConfig?r.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:r,guards:e}}function Ti(r,e){let n=Symbol(),i=e.get(r,n);return i===n?typeof r=="function"&&!Pd(r)?r:e.get(r):i}function Uo(r,e,n,i,o={canDeactivateChecks:[],canActivateChecks:[]}){let s=wi(e);return r.children.forEach(a=>{xx(a,s[a.value.outlet],n,i.concat([a.value]),o),delete s[a.value.outlet]}),Object.entries(s).forEach(([a,u])=>Go(u,n.getContext(a),o)),o}function xx(r,e,n,i,o={canDeactivateChecks:[],canActivateChecks:[]}){let s=r.value,a=e?e.value:null,u=n?n.getContext(r.value.outlet):null;if(a&&s.routeConfig===a.routeConfig){let l=Ax(a,s,s.routeConfig.runGuardsAndResolvers);l?o.canActivateChecks.push(new nu(i)):(s.data=a.data,s._resolvedData=a._resolvedData),s.component?Uo(r,e,u?u.children:null,i,o):Uo(r,e,n,i,o),l&&u&&u.outlet&&u.outlet.isActivated&&o.canDeactivateChecks.push(new Ci(u.outlet.component,a))}else a&&Go(e,u,o),o.canActivateChecks.push(new nu(i)),s.component?Uo(r,null,u?u.children:null,i,o):Uo(r,null,n,i,o);return o}function Ax(r,e,n){if(typeof n=="function")return n(r,e);switch(n){case"pathParamsChange":return!vn(r.url,e.url);case"pathParamsOrQueryParamsChange":return!vn(r.url,e.url)||!Vt(r.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Qc(r,e)||!Vt(r.queryParams,e.queryParams);case"paramsChange":default:return!Qc(r,e)}}function Go(r,e,n){let i=wi(r),o=r.value;Object.entries(i).forEach(([s,a])=>{o.component?e?Go(a,e.children.getContext(s),n):Go(a,null,n):Go(a,e,n)}),o.component?e&&e.outlet&&e.outlet.isActivated?n.canDeactivateChecks.push(new Ci(e.outlet.component,o)):n.canDeactivateChecks.push(new Ci(null,o)):n.canDeactivateChecks.push(new Ci(null,o))}function is(r){return typeof r=="function"}function Cx(r){return typeof r=="boolean"}function Ix(r){return r&&is(r.canLoad)}function Ex(r){return r&&is(r.canActivate)}function Ox(r){return r&&is(r.canActivateChild)}function Px(r){return r&&is(r.canDeactivate)}function Tx(r){return r&&is(r.canMatch)}function hm(r){return r instanceof _d||r?.name==="EmptyError"}var Ga=Symbol("INITIAL_VALUE");function Pi(){return dt(r=>Fl(r.map(e=>e.pipe(hi(1),Ed(Ga)))).pipe(ne(e=>{for(let n of e)if(n!==!0){if(n===Ga)return Ga;if(n===!1||Sx(n))return n}return!0}),Ar(e=>e!==Ga),hi(1)))}function Sx(r){return Wo(r)||r instanceof Qo}function Rx(r,e){return ht(n=>{let{targetSnapshot:i,currentSnapshot:o,guards:{canActivateChecks:s,canDeactivateChecks:a}}=n;return a.length===0&&s.length===0?H(_(p({},n),{guardsResult:!0})):Mx(a,i,o,r).pipe(ht(u=>u&&Cx(u)?kx(i,s,r,e):H(u)),ne(u=>_(p({},n),{guardsResult:u})))})}function Mx(r,e,n,i){return Ge(r).pipe(ht(o=>zx(o.component,o.route,n,e,i)),Cr(o=>o!==!0,!0))}function kx(r,e,n,i){return Ge(e).pipe(nn(o=>wd(Nx(o.route.parent,i),Dx(o.route,i),Fx(r,o.path,n),jx(r,o.route,n))),Cr(o=>o!==!0,!0))}function Dx(r,e){return r!==null&&e&&e(new Kc(r)),H(!0)}function Nx(r,e){return r!==null&&e&&e(new Hc(r)),H(!0)}function jx(r,e,n){let i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||i.length===0)return H(!0);let o=i.map(s=>zl(()=>{let a=ns(e)??n,u=Ti(s,a),l=Ex(u)?u.canActivate(e,r):It(a,()=>u(e,r));return Tr(l).pipe(Cr())}));return H(o).pipe(Pi())}function Fx(r,e,n){let i=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(a=>wx(a)).filter(a=>a!==null).map(a=>zl(()=>{let u=a.guards.map(l=>{let c=ns(a.node)??n,f=Ti(l,c),h=Ox(f)?f.canActivateChild(i,r):It(c,()=>f(i,r));return Tr(h).pipe(Cr())});return H(u).pipe(Pi())}));return H(s).pipe(Pi())}function zx(r,e,n,i,o){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return H(!0);let a=s.map(u=>{let l=ns(e)??o,c=Ti(u,l),f=Px(c)?c.canDeactivate(r,e,n,i):It(l,()=>c(r,e,n,i));return Tr(f).pipe(Cr())});return H(a).pipe(Pi())}function $x(r,e,n,i){let o=e.canLoad;if(o===void 0||o.length===0)return H(!0);let s=o.map(a=>{let u=Ti(a,r),l=Ix(u)?u.canLoad(e,n):It(r,()=>u(e,n));return Tr(l)});return H(s).pipe(Pi(),dm(i))}function dm(r){return vd(je(e=>{if(typeof e!="boolean")throw ru(r,e)}),ne(e=>e===!0))}function Lx(r,e,n,i){let o=e.canMatch;if(!o||o.length===0)return H(!0);let s=o.map(a=>{let u=Ti(a,r),l=Tx(u)?u.canMatch(e,n):It(r,()=>u(e,n));return Tr(l)});return H(s).pipe(Pi(),dm(i))}var es=class{constructor(e){this.segmentGroup=e||null}},ts=class extends Error{constructor(e){super(),this.urlTree=e}};function _i(r){return bo(new es(r))}function Ux(r){return bo(new de(4e3,!1))}function Vx(r){return bo(cm(!1,it.GuardRejected))}var rf=class{constructor(e,n){this.urlSerializer=e,this.urlTree=n}lineralizeSegments(e,n){let i=[],o=n.root;for(;;){if(i=i.concat(o.segments),o.numberOfChildren===0)return H(i);if(o.numberOfChildren>1||!o.children[Y])return Ux(`${e.redirectTo}`);o=o.children[Y]}}applyRedirectCommands(e,n,i,o,s){if(typeof n!="string"){let u=n,{queryParams:l,fragment:c,routeConfig:f,url:h,outlet:d,params:m,data:y,title:b}=o,v=It(s,()=>u({params:m,data:y,queryParams:l,fragment:c,routeConfig:f,url:h,outlet:d,title:b}));if(v instanceof lr)throw new ts(v);n=v}let a=this.applyRedirectCreateUrlTree(n,this.urlSerializer.parse(n),e,i);if(n[0]==="/")throw new ts(a);return a}applyRedirectCreateUrlTree(e,n,i,o){let s=this.createSegmentGroup(e,n.root,i,o);return new lr(s,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(e,n){let i={};return Object.entries(e).forEach(([o,s])=>{if(typeof s=="string"&&s[0]===":"){let u=s.substring(1);i[o]=n[u]}else i[o]=s}),i}createSegmentGroup(e,n,i,o){let s=this.createSegments(e,n.segments,i,o),a={};return Object.entries(n.children).forEach(([u,l])=>{a[u]=this.createSegmentGroup(e,l,i,o)}),new oe(s,a)}createSegments(e,n,i,o){return n.map(s=>s.path[0]===":"?this.findPosParam(e,s,o):this.findOrReturn(s,i))}findPosParam(e,n,i){let o=i[n.path.substring(1)];if(!o)throw new de(4001,!1);return o}findOrReturn(e,n){let i=0;for(let o of n){if(o.path===e.path)return n.splice(i),o;i++}return e}},nf={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Bx(r,e,n,i,o){let s=hf(r,e,n);return s.matched?(i=hx(e,i),Lx(i,e,n,o).pipe(ne(a=>a===!0?s:p({},nf)))):H(s)}function hf(r,e,n){if(e.path==="**")return qx(n);if(e.path==="")return e.pathMatch==="full"&&(r.hasChildren()||n.length>0)?p({},nf):{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};let o=(e.matcher||Lw)(n,r,e);if(!o)return p({},nf);let s={};Object.entries(o.posParams??{}).forEach(([u,l])=>{s[u]=l.path});let a=o.consumed.length>0?p(p({},s),o.consumed[o.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:o.consumed,remainingSegments:n.slice(o.consumed.length),parameters:a,positionalParamSegments:o.posParams??{}}}function qx(r){return{matched:!0,parameters:r.length>0?Wp(r).parameters:{},consumedSegments:r,remainingSegments:[],positionalParamSegments:{}}}function Bp(r,e,n,i){return n.length>0&&Wx(r,n,i)?{segmentGroup:new oe(e,Hx(i,new oe(n,r.children))),slicedSegments:[]}:n.length===0&&Kx(r,n,i)?{segmentGroup:new oe(r.segments,Gx(r,n,i,r.children)),slicedSegments:n}:{segmentGroup:new oe(r.segments,r.children),slicedSegments:n}}function Gx(r,e,n,i){let o={};for(let s of n)if(ou(r,e,s)&&!i[Tt(s)]){let a=new oe([],{});o[Tt(s)]=a}return p(p({},i),o)}function Hx(r,e){let n={};n[Y]=e;for(let i of r)if(i.path===""&&Tt(i)!==Y){let o=new oe([],{});n[Tt(i)]=o}return n}function Wx(r,e,n){return n.some(i=>ou(r,e,i)&&Tt(i)!==Y)}function Kx(r,e,n){return n.some(i=>ou(r,e,i))}function ou(r,e,n){return(r.hasChildren()||e.length>0)&&n.pathMatch==="full"?!1:n.path===""}function Zx(r,e,n,i){return Tt(r)!==i&&(i===Y||!ou(e,n,r))?!1:hf(e,r,n).matched}function Xx(r,e,n){return e.length===0&&!r.children[n]}var of=class{};function Jx(r,e,n,i,o,s,a="emptyOnly"){return new sf(r,e,n,i,o,a,s).recognize()}var Yx=31,sf=class{constructor(e,n,i,o,s,a,u){this.injector=e,this.configLoader=n,this.rootComponentType=i,this.config=o,this.urlTree=s,this.paramsInheritanceStrategy=a,this.urlSerializer=u,this.applyRedirects=new rf(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new de(4002,`'${e.segmentGroup}'`)}recognize(){let e=Bp(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(ne(({children:n,rootSnapshot:i})=>{let o=new nt(i,n),s=new tu("",o),a=ox(i,[],this.urlTree.queryParams,this.urlTree.fragment);return a.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(a),{state:s,tree:a}}))}match(e){let n=new Ai([],Object.freeze({}),Object.freeze(p({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),Y,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,Y,n).pipe(ne(i=>({children:i,rootSnapshot:n})),fi(i=>{if(i instanceof ts)return this.urlTree=i.urlTree,this.match(i.urlTree.root);throw i instanceof es?this.noMatchError(i):i}))}processSegmentGroup(e,n,i,o,s){return i.segments.length===0&&i.hasChildren()?this.processChildren(e,n,i,s):this.processSegment(e,n,i,i.segments,o,!0,s).pipe(ne(a=>a instanceof nt?[a]:[]))}processChildren(e,n,i,o){let s=[];for(let a of Object.keys(i.children))a==="primary"?s.unshift(a):s.push(a);return Ge(s).pipe(nn(a=>{let u=i.children[a],l=dx(n,a);return this.processSegmentGroup(e,l,u,a,o)}),Id((a,u)=>(a.push(...u),a)),$l(null),Cd(),ht(a=>{if(a===null)return _i(i);let u=pm(a);return Qx(u),H(u)}))}processSegment(e,n,i,o,s,a,u){return Ge(n).pipe(nn(l=>this.processSegmentAgainstRoute(l._injector??e,n,l,i,o,s,a,u).pipe(fi(c=>{if(c instanceof es)return H(null);throw c}))),Cr(l=>!!l),fi(l=>{if(hm(l))return Xx(i,o,s)?H(new of):_i(i);throw l}))}processSegmentAgainstRoute(e,n,i,o,s,a,u,l){return Zx(i,o,s,a)?i.redirectTo===void 0?this.matchSegmentAgainstRoute(e,o,i,s,a,l):this.allowRedirects&&u?this.expandSegmentAgainstRouteUsingRedirect(e,o,n,i,s,a,l):_i(o):_i(o)}expandSegmentAgainstRouteUsingRedirect(e,n,i,o,s,a,u){let{matched:l,parameters:c,consumedSegments:f,positionalParamSegments:h,remainingSegments:d}=hf(n,o,s);if(!l)return _i(n);typeof o.redirectTo=="string"&&o.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>Yx&&(this.allowRedirects=!1));let m=new Ai(s,c,Object.freeze(p({},this.urlTree.queryParams)),this.urlTree.fragment,qp(o),Tt(o),o.component??o._loadedComponent??null,o,Gp(o)),y=eu(m,u,this.paramsInheritanceStrategy);m.params=Object.freeze(y.params),m.data=Object.freeze(y.data);let b=this.applyRedirects.applyRedirectCommands(f,o.redirectTo,h,m,e);return this.applyRedirects.lineralizeSegments(o,b).pipe(ht(v=>this.processSegment(e,i,n,v.concat(d),a,!1,u)))}matchSegmentAgainstRoute(e,n,i,o,s,a){let u=Bx(n,i,o,e,this.urlSerializer);return i.path==="**"&&(n.children={}),u.pipe(dt(l=>l.matched?(e=i._injector??e,this.getChildConfig(e,i,o).pipe(dt(({routes:c})=>{let f=i._loadedInjector??e,{parameters:h,consumedSegments:d,remainingSegments:m}=l,y=new Ai(d,h,Object.freeze(p({},this.urlTree.queryParams)),this.urlTree.fragment,qp(i),Tt(i),i.component??i._loadedComponent??null,i,Gp(i)),b=eu(y,a,this.paramsInheritanceStrategy);y.params=Object.freeze(b.params),y.data=Object.freeze(b.data);let{segmentGroup:v,slicedSegments:g}=Bp(n,d,m,c);if(g.length===0&&v.hasChildren())return this.processChildren(f,c,v,y).pipe(ne(E=>new nt(y,E)));if(c.length===0&&g.length===0)return H(new nt(y,[]));let A=Tt(i)===s;return this.processSegment(f,c,v,g,A?Y:s,!0,y).pipe(ne(E=>new nt(y,E instanceof nt?[E]:[])))}))):_i(n)))}getChildConfig(e,n,i){return n.children?H({routes:n.children,injector:e}):n.loadChildren?n._loadedRoutes!==void 0?H({routes:n._loadedRoutes,injector:n._loadedInjector}):$x(e,n,i,this.urlSerializer).pipe(ht(o=>o?this.configLoader.loadChildren(e,n).pipe(je(s=>{n._loadedRoutes=s.routes,n._loadedInjector=s.injector})):Vx(n))):H({routes:[],injector:e})}};function Qx(r){r.sort((e,n)=>e.value.outlet===Y?-1:n.value.outlet===Y?1:e.value.outlet.localeCompare(n.value.outlet))}function eA(r){let e=r.value.routeConfig;return e&&e.path===""}function pm(r){let e=[],n=new Set;for(let i of r){if(!eA(i)){e.push(i);continue}let o=e.find(s=>i.value.routeConfig===s.value.routeConfig);o!==void 0?(o.children.push(...i.children),n.add(o)):e.push(i)}for(let i of n){let o=pm(i.children);e.push(new nt(i.value,o))}return e.filter(i=>!n.has(i))}function qp(r){return r.data||{}}function Gp(r){return r.resolve||{}}function tA(r,e,n,i,o,s){return ht(a=>Jx(r,e,n,i,a.extractedUrl,o,s).pipe(ne(({state:u,tree:l})=>_(p({},a),{targetSnapshot:u,urlAfterRedirects:l}))))}function rA(r,e){return ht(n=>{let{targetSnapshot:i,guards:{canActivateChecks:o}}=n;if(!o.length)return H(n);let s=new Set(o.map(l=>l.route)),a=new Set;for(let l of s)if(!a.has(l))for(let c of mm(l))a.add(c);let u=0;return Ge(a).pipe(nn(l=>s.has(l)?nA(l,i,r,e):(l.data=eu(l,l.parent,r).resolve,H(void 0))),je(()=>u++),Ll(1),ht(l=>u===a.size?H(n):xr))})}function mm(r){let e=r.children.map(n=>mm(n)).flat();return[r,...e]}function nA(r,e,n,i){let o=r.routeConfig,s=r._resolve;return o?.title!==void 0&&!um(o)&&(s[rs]=o.title),iA(s,r,e,i).pipe(ne(a=>(r._resolvedData=a,r.data=eu(r,r.parent,n).resolve,null)))}function iA(r,e,n,i){let o=Nc(r);if(o.length===0)return H({});let s={};return Ge(o).pipe(ht(a=>oA(r[a],e,n,i).pipe(Cr(),je(u=>{if(u instanceof Qo)throw ru(new Ho,u);s[a]=u}))),Ll(1),Ad(s),fi(a=>hm(a)?xr:bo(a)))}function oA(r,e,n,i){let o=ns(e)??i,s=Ti(r,o),a=s.resolve?s.resolve(e,n):It(o,()=>s(e,n));return Tr(a)}function kc(r){return dt(e=>{let n=r(e);return n?Ge(n).pipe(ne(()=>e)):H(e)})}var gm=(()=>{let e=class e{buildTitle(i){let o,s=i.root;for(;s!==void 0;)o=this.getResolvedTitleForRoute(s)??o,s=s.children.find(a=>a.outlet===Y);return o}getResolvedTitleForRoute(i){return i.data[rs]}};e.\u0275fac=function(o){return new(o||e)},e.\u0275prov=W({token:e,factory:()=>j(sA),providedIn:"root"});let r=e;return r})(),sA=(()=>{let e=class e extends gm{constructor(i){super(),this.title=i}updateTitle(i){let o=this.buildTitle(i);o!==void 0&&this.title.setTitle(o)}};e.\u0275fac=function(o){return new(o||e)(J(Fp))},e.\u0275prov=W({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})(),df=new ae("",{providedIn:"root",factory:()=>({})}),aA=(()=>{let e=class e{};e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=Yt({type:e,selectors:[["ng-component"]],standalone:!0,features:[or],decls:1,vars:0,template:function(o,s){o&1&&Ee(0,"router-outlet")},dependencies:[cf],encapsulation:2});let r=e;return r})();function pf(r){let e=r.children&&r.children.map(pf),n=e?_(p({},r),{children:e}):p({},r);return!n.component&&!n.loadComponent&&(e||n.loadChildren)&&n.outlet&&n.outlet!==Y&&(n.component=aA),n}var mf=new ae(""),uA=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=j(ec)}loadComponent(i){if(this.componentLoaders.get(i))return this.componentLoaders.get(i);if(i._loadedComponent)return H(i._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(i);let o=Tr(i.loadComponent()).pipe(ne(ym),je(a=>{this.onLoadEndListener&&this.onLoadEndListener(i),i._loadedComponent=a}),di(()=>{this.componentLoaders.delete(i)})),s=new jl(o,()=>new Ne).pipe(Nl());return this.componentLoaders.set(i,s),s}loadChildren(i,o){if(this.childrenLoaders.get(o))return this.childrenLoaders.get(o);if(o._loadedRoutes)return H({routes:o._loadedRoutes,injector:o._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(o);let a=lA(o,this.compiler,i,this.onLoadEndListener).pipe(di(()=>{this.childrenLoaders.delete(o)})),u=new jl(a,()=>new Ne).pipe(Nl());return this.childrenLoaders.set(o,u),u}};e.\u0275fac=function(o){return new(o||e)},e.\u0275prov=W({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})();function lA(r,e,n,i){return Tr(r.loadChildren()).pipe(ne(ym),ht(o=>o instanceof Bd||Array.isArray(o)?H(o):Ge(e.compileModuleAsync(o))),ne(o=>{i&&i(r);let s,a,u=!1;return Array.isArray(o)?(a=o,u=!0):(s=o.create(n).injector,a=s.get(mf,[],{optional:!0,self:!0}).flat()),{routes:a.map(pf),injector:s}}))}function cA(r){return r&&typeof r=="object"&&"default"in r}function ym(r){return cA(r)?r.default:r}var gf=(()=>{let e=class e{};e.\u0275fac=function(o){return new(o||e)},e.\u0275prov=W({token:e,factory:()=>j(fA),providedIn:"root"});let r=e;return r})(),fA=(()=>{let e=class e{shouldProcessUrl(i){return!0}extract(i){return i}merge(i,o){return i}};e.\u0275fac=function(o){return new(o||e)},e.\u0275prov=W({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})(),hA=new ae("");var dA=new ae(""),pA=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Ne,this.transitionAbortSubject=new Ne,this.configLoader=j(uA),this.environmentInjector=j(pi),this.urlSerializer=j(uf),this.rootContexts=j(iu),this.location=j(Ea),this.inputBindingEnabled=j(ff,{optional:!0})!==null,this.titleStrategy=j(gm),this.options=j(df,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=j(gf),this.createViewTransition=j(hA,{optional:!0}),this.navigationErrorHandler=j(dA,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>H(void 0),this.rootComponentType=null;let i=s=>this.events.next(new qc(s)),o=s=>this.events.next(new Gc(s));this.configLoader.onLoadEndListener=o,this.configLoader.onLoadStartListener=i}complete(){this.transitions?.complete()}handleNavigationRequest(i){let o=++this.navigationId;this.transitions?.next(_(p(p({},this.transitions.value),i),{id:o}))}setupNavigations(i,o,s){return this.transitions=new ft({id:0,currentUrlTree:o,currentRawUrl:o,extractedUrl:this.urlHandlingStrategy.extract(o),urlAfterRedirects:this.urlHandlingStrategy.extract(o),rawUrl:o,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:qo,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Ar(a=>a.id!==0),ne(a=>_(p({},a),{extractedUrl:this.urlHandlingStrategy.extract(a.rawUrl)})),dt(a=>{let u=!1,l=!1;return H(a).pipe(dt(c=>{if(this.navigationId>a.id)return this.cancelNavigationTransition(a,"",it.SupersededByNewNavigation),xr;this.currentTransition=a,this.currentNavigation={id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,targetBrowserUrl:typeof c.extras.browserUrl=="string"?this.urlSerializer.parse(c.extras.browserUrl):c.extras.browserUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?_(p({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let f=!i.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),h=c.extras.onSameUrlNavigation??i.onSameUrlNavigation;if(!f&&h!=="reload"){let d="";return this.events.next(new _n(c.id,this.urlSerializer.serialize(c.rawUrl),d,$c.IgnoredSameUrlNavigation)),c.resolve(!1),xr}if(this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return H(c).pipe(dt(d=>{let m=this.transitions?.getValue();return this.events.next(new Zo(d.id,this.urlSerializer.serialize(d.extractedUrl),d.source,d.restoredState)),m!==this.transitions?.getValue()?xr:Promise.resolve(d)}),tA(this.environmentInjector,this.configLoader,this.rootComponentType,i.config,this.urlSerializer,this.paramsInheritanceStrategy),je(d=>{a.targetSnapshot=d.targetSnapshot,a.urlAfterRedirects=d.urlAfterRedirects,this.currentNavigation=_(p({},this.currentNavigation),{finalUrl:d.urlAfterRedirects});let m=new Ja(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(m)}));if(f&&this.urlHandlingStrategy.shouldProcessUrl(c.currentRawUrl)){let{id:d,extractedUrl:m,source:y,restoredState:b,extras:v}=c,g=new Zo(d,this.urlSerializer.serialize(m),y,b);this.events.next(g);let A=sm(this.rootComponentType).snapshot;return this.currentTransition=a=_(p({},c),{targetSnapshot:A,urlAfterRedirects:m,extras:_(p({},v),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=m,H(a)}else{let d="";return this.events.next(new _n(c.id,this.urlSerializer.serialize(c.extractedUrl),d,$c.IgnoredByUrlHandlingStrategy)),c.resolve(!1),xr}}),je(c=>{let f=new Lc(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(f)}),ne(c=>(this.currentTransition=a=_(p({},c),{guards:_x(c.targetSnapshot,c.currentSnapshot,this.rootContexts)}),a)),Rx(this.environmentInjector,c=>this.events.next(c)),je(c=>{if(a.guardsResult=c.guardsResult,c.guardsResult&&typeof c.guardsResult!="boolean")throw ru(this.urlSerializer,c.guardsResult);let f=new Uc(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.events.next(f)}),Ar(c=>c.guardsResult?!0:(this.cancelNavigationTransition(c,"",it.GuardRejected),!1)),kc(c=>{if(c.guards.canActivateChecks.length)return H(c).pipe(je(f=>{let h=new Vc(f.id,this.urlSerializer.serialize(f.extractedUrl),this.urlSerializer.serialize(f.urlAfterRedirects),f.targetSnapshot);this.events.next(h)}),dt(f=>{let h=!1;return H(f).pipe(rA(this.paramsInheritanceStrategy,this.environmentInjector),je({next:()=>h=!0,complete:()=>{h||this.cancelNavigationTransition(f,"",it.NoDataFromResolver)}}))}),je(f=>{let h=new Bc(f.id,this.urlSerializer.serialize(f.extractedUrl),this.urlSerializer.serialize(f.urlAfterRedirects),f.targetSnapshot);this.events.next(h)}))}),kc(c=>{let f=h=>{let d=[];h.routeConfig?.loadComponent&&!h.routeConfig._loadedComponent&&d.push(this.configLoader.loadComponent(h.routeConfig).pipe(je(m=>{h.component=m}),ne(()=>{})));for(let m of h.children)d.push(...f(m));return d};return Fl(f(c.targetSnapshot.root)).pipe($l(null),hi(1))}),kc(()=>this.afterPreactivation()),dt(()=>{let{currentSnapshot:c,targetSnapshot:f}=a,h=this.createViewTransition?.(this.environmentInjector,c.root,f.root);return h?Ge(h).pipe(ne(()=>a)):H(a)}),ne(c=>{let f=mx(i.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return this.currentTransition=a=_(p({},c),{targetRouterState:f}),this.currentNavigation.targetRouterState=f,a}),je(()=>{this.events.next(new Jo)}),bx(this.rootContexts,i.routeReuseStrategy,c=>this.events.next(c),this.inputBindingEnabled),hi(1),je({next:c=>{u=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new bn(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects))),this.titleStrategy?.updateTitle(c.targetRouterState.snapshot),c.resolve(!0)},complete:()=>{u=!0}}),Od(this.transitionAbortSubject.pipe(je(c=>{throw c}))),di(()=>{!u&&!l&&this.cancelNavigationTransition(a,"",it.SupersededByNewNavigation),this.currentTransition?.id===a.id&&(this.currentNavigation=null,this.currentTransition=null)}),fi(c=>{if(l=!0,fm(c))this.events.next(new ur(a.id,this.urlSerializer.serialize(a.extractedUrl),c.message,c.cancellationCode)),vx(c)?this.events.next(new Ei(c.url,c.navigationBehaviorOptions)):a.resolve(!1);else{let f=new Xo(a.id,this.urlSerializer.serialize(a.extractedUrl),c,a.targetSnapshot??void 0);try{let h=It(this.environmentInjector,()=>this.navigationErrorHandler?.(f));if(h instanceof Qo){let{message:d,cancellationCode:m}=ru(this.urlSerializer,h);this.events.next(new ur(a.id,this.urlSerializer.serialize(a.extractedUrl),d,m)),this.events.next(new Ei(h.redirectTo,h.navigationBehaviorOptions))}else{this.events.next(f);let d=i.errorHandler(c);a.resolve(!!d)}}catch(h){this.options.resolveNavigationPromiseOnError?a.resolve(!1):a.reject(h)}}return xr}))}))}cancelNavigationTransition(i,o,s){let a=new ur(i.id,this.urlSerializer.serialize(i.extractedUrl),o,s);this.events.next(a),i.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let i=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),o=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return i.toString()!==o?.toString()&&!this.currentNavigation?.extras.skipLocationChange}};e.\u0275fac=function(o){return new(o||e)},e.\u0275prov=W({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})();function mA(r){return r!==qo}var gA=(()=>{let e=class e{};e.\u0275fac=function(o){return new(o||e)},e.\u0275prov=W({token:e,factory:()=>j(yA),providedIn:"root"});let r=e;return r})(),af=class{shouldDetach(e){return!1}store(e,n){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,n){return e.routeConfig===n.routeConfig}},yA=(()=>{let e=class e extends af{};e.\u0275fac=(()=>{let i;return function(s){return(i||(i=wo(e)))(s||e)}})(),e.\u0275prov=W({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})(),vm=(()=>{let e=class e{};e.\u0275fac=function(o){return new(o||e)},e.\u0275prov=W({token:e,factory:()=>j(vA),providedIn:"root"});let r=e;return r})(),vA=(()=>{let e=class e extends vm{constructor(){super(...arguments),this.location=j(Ea),this.urlSerializer=j(uf),this.options=j(df,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=j(gf),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new lr,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=sm(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(i){return this.location.subscribe(o=>{o.type==="popstate"&&i(o.url,o.state)})}handleRouterEvent(i,o){if(i instanceof Zo)this.stateMemento=this.createStateMemento();else if(i instanceof _n)this.rawUrlTree=o.initialUrl;else if(i instanceof Ja){if(this.urlUpdateStrategy==="eager"&&!o.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(o.finalUrl,o.initialUrl);this.setBrowserUrl(o.targetBrowserUrl??s,o)}}else i instanceof Jo?(this.currentUrlTree=o.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(o.finalUrl,o.initialUrl),this.routerState=o.targetRouterState,this.urlUpdateStrategy==="deferred"&&!o.extras.skipLocationChange&&this.setBrowserUrl(o.targetBrowserUrl??this.rawUrlTree,o)):i instanceof ur&&(i.code===it.GuardRejected||i.code===it.NoDataFromResolver)?this.restoreHistory(o):i instanceof Xo?this.restoreHistory(o,!0):i instanceof bn&&(this.lastSuccessfulId=i.id,this.currentPageId=this.browserPageId)}setBrowserUrl(i,o){let s=i instanceof lr?this.urlSerializer.serialize(i):i;if(this.location.isCurrentPathEqualTo(s)||o.extras.replaceUrl){let a=this.browserPageId,u=p(p({},o.extras.state),this.generateNgRouterState(o.id,a));this.location.replaceState(s,"",u)}else{let a=p(p({},o.extras.state),this.generateNgRouterState(o.id,this.browserPageId+1));this.location.go(s,"",a)}}restoreHistory(i,o=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,a=this.currentPageId-s;a!==0?this.location.historyGo(a):this.currentUrlTree===i.finalUrl&&a===0&&(this.resetState(i),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(o&&this.resetState(i),this.resetUrlToCurrentUrlTree())}resetState(i){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,i.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(i,o){return this.canceledNavigationResolution==="computed"?{navigationId:i,\u0275routerPageId:o}:{navigationId:i}}};e.\u0275fac=(()=>{let i;return function(s){return(i||(i=wo(e)))(s||e)}})(),e.\u0275prov=W({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})(),Vo=function(r){return r[r.COMPLETE=0]="COMPLETE",r[r.FAILED=1]="FAILED",r[r.REDIRECTING=2]="REDIRECTING",r}(Vo||{});function bA(r,e){r.events.pipe(Ar(n=>n instanceof bn||n instanceof ur||n instanceof Xo||n instanceof _n),ne(n=>n instanceof bn||n instanceof _n?Vo.COMPLETE:(n instanceof ur?n.code===it.Redirect||n.code===it.SupersededByNewNavigation:!1)?Vo.REDIRECTING:Vo.FAILED),Ar(n=>n!==Vo.REDIRECTING),hi(1)).subscribe(()=>{e()})}function _A(r){throw r}var wA={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},xA={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},bm=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.console=j(Aa),this.stateManager=j(vm),this.options=j(df,{optional:!0})||{},this.pendingTasks=j(va),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=j(pA),this.urlSerializer=j(uf),this.location=j(Ea),this.urlHandlingStrategy=j(gf),this._events=new Ne,this.errorHandler=this.options.errorHandler||_A,this.navigated=!1,this.routeReuseStrategy=j(gA),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=j(mf,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!j(ff,{optional:!0}),this.eventsSubscription=new yd,this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:i=>{this.console.warn(i)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let i=this.navigationTransitions.events.subscribe(o=>{try{let s=this.navigationTransitions.currentTransition,a=this.navigationTransitions.currentNavigation;if(s!==null&&a!==null){if(this.stateManager.handleRouterEvent(o,a),o instanceof ur&&o.code!==it.Redirect&&o.code!==it.SupersededByNewNavigation)this.navigated=!0;else if(o instanceof bn)this.navigated=!0;else if(o instanceof Ei){let u=o.navigationBehaviorOptions,l=this.urlHandlingStrategy.merge(o.url,s.currentRawUrl),c=p({browserUrl:s.extras.browserUrl,info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:s.extras.replaceUrl||this.urlUpdateStrategy==="eager"||mA(s.source)},u);this.scheduleNavigation(l,qo,null,c,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}CA(o)&&this._events.next(o)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(i)}resetRootComponentType(i){this.routerState.root.component=i,this.navigationTransitions.rootComponentType=i}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),qo,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((i,o)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(i,"popstate",o)},0)})}navigateToSyncWithBrowser(i,o,s){let a={replaceUrl:!0},u=s?.navigationId?s:null;if(s){let c=p({},s);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(a.state=c)}let l=this.parseUrl(i);this.scheduleNavigation(l,o,u,a)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(i){this.config=i.map(pf),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(i,o={}){let{relativeTo:s,queryParams:a,fragment:u,queryParamsHandling:l,preserveFragment:c}=o,f=c?this.currentUrlTree.fragment:u,h=null;switch(l??this.options.defaultQueryParamsHandling){case"merge":h=p(p({},this.currentUrlTree.queryParams),a);break;case"preserve":h=this.currentUrlTree.queryParams;break;default:h=a||null}h!==null&&(h=this.removeEmptyProps(h));let d;try{let m=s?s.snapshot:this.routerState.snapshot.root;d=rm(m)}catch{(typeof i[0]!="string"||i[0][0]!=="/")&&(i=[]),d=this.currentUrlTree.root}return nm(d,i,h,f??null)}navigateByUrl(i,o={skipLocationChange:!1}){let s=Wo(i)?i:this.parseUrl(i),a=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(a,qo,null,o)}navigate(i,o={skipLocationChange:!1}){return AA(i),this.navigateByUrl(this.createUrlTree(i,o),o)}serializeUrl(i){return this.urlSerializer.serialize(i)}parseUrl(i){try{return this.urlSerializer.parse(i)}catch{return this.urlSerializer.parse("/")}}isActive(i,o){let s;if(o===!0?s=p({},wA):o===!1?s=p({},xA):s=o,Wo(i))return $p(this.currentUrlTree,i,s);let a=this.parseUrl(i);return $p(this.currentUrlTree,a,s)}removeEmptyProps(i){return Object.entries(i).reduce((o,[s,a])=>(a!=null&&(o[s]=a),o),{})}scheduleNavigation(i,o,s,a,u){if(this.disposed)return Promise.resolve(!1);let l,c,f;u?(l=u.resolve,c=u.reject,f=u.promise):f=new Promise((d,m)=>{l=d,c=m});let h=this.pendingTasks.add();return bA(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(h))}),this.navigationTransitions.handleNavigationRequest({source:o,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:i,extras:a,resolve:l,reject:c,promise:f,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),f.catch(d=>Promise.reject(d))}};e.\u0275fac=function(o){return new(o||e)},e.\u0275prov=W({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})();function AA(r){for(let e=0;e<r.length;e++)if(r[e]==null)throw new de(4008,!1)}function CA(r){return!(r instanceof Jo)&&!(r instanceof Ei)}var IA=new ae("");function _m(r,...e){return er([{provide:mf,multi:!0,useValue:r},[],{provide:Oi,useFactory:EA,deps:[bm]},{provide:Ql,multi:!0,useFactory:OA},e.map(n=>n.\u0275providers)])}function EA(r){return r.routerState.root}function OA(){let r=j(an);return e=>{let n=r.get(Ir);if(e!==n.components[0])return;let i=r.get(bm),o=r.get(PA);r.get(TA)===1&&i.initialNavigation(),r.get(SA,null,Vl.Optional)?.setUpPreloading(),r.get(IA,null,Vl.Optional)?.init(),i.resetRootComponentType(n.componentTypes[0]),o.closed||(o.next(),o.complete(),o.unsubscribe())}}var PA=new ae("",{factory:()=>new Ne}),TA=new ae("",{providedIn:"root",factory:()=>1});var SA=new ae("");var RA="@",MA=(()=>{let e=class e{constructor(i,o,s,a,u){this.doc=i,this.delegate=o,this.zone=s,this.animationType=a,this.moduleImpl=u,this._rendererFactoryPromise=null,this.scheduler=j(Ld,{optional:!0})}ngOnDestroy(){this._engine?.flush()}loadImpl(){return(this.moduleImpl??import("./chunk-3NF45G4Y.js").then(o=>o)).catch(o=>{throw new de(5300,!1)}).then(({\u0275createEngine:o,\u0275AnimationRendererFactory:s})=>{this._engine=o(this.animationType,this.doc);let a=new s(this.delegate,this._engine,this.zone);return this.delegate=a,a})}createRenderer(i,o){let s=this.delegate.createRenderer(i,o);if(s.\u0275type===0)return s;typeof s.throwOnSyntheticProps=="boolean"&&(s.throwOnSyntheticProps=!1);let a=new yf(s);return o?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(u=>{let l=u.createRenderer(i,o);a.use(l),this.scheduler?.notify(9)}).catch(u=>{a.use(s)}),a}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}};e.\u0275fac=function(o){Wl()},e.\u0275prov=W({token:e,factory:e.\u0275fac});let r=e;return r})(),yf=class{constructor(e){this.delegate=e,this.replay=[],this.\u0275type=1}use(e){if(this.delegate=e,this.replay!==null){for(let n of this.replay)n(e);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(e,n){return this.delegate.createElement(e,n)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}get destroyNode(){return this.delegate.destroyNode}appendChild(e,n){this.delegate.appendChild(e,n)}insertBefore(e,n,i,o){this.delegate.insertBefore(e,n,i,o)}removeChild(e,n,i){this.delegate.removeChild(e,n,i)}selectRootElement(e,n){return this.delegate.selectRootElement(e,n)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,n,i,o){this.delegate.setAttribute(e,n,i,o)}removeAttribute(e,n,i){this.delegate.removeAttribute(e,n,i)}addClass(e,n){this.delegate.addClass(e,n)}removeClass(e,n){this.delegate.removeClass(e,n)}setStyle(e,n,i,o){this.delegate.setStyle(e,n,i,o)}removeStyle(e,n,i){this.delegate.removeStyle(e,n,i)}setProperty(e,n,i){this.shouldReplay(n)&&this.replay.push(o=>o.setProperty(e,n,i)),this.delegate.setProperty(e,n,i)}setValue(e,n){this.delegate.setValue(e,n)}listen(e,n,i){return this.shouldReplay(n)&&this.replay.push(o=>o.listen(e,n,i)),this.delegate.listen(e,n,i)}shouldReplay(e){return this.replay!==null&&e.startsWith(RA)}};function wm(r="animations"){return Kl("NgAsyncAnimations"),er([{provide:ba,useFactory:(e,n,i)=>new MA(e,n,i,r),deps:[Pe,Va,tt]},{provide:Md,useValue:r==="noop"?"NoopAnimations":"BrowserAnimations"}])}var Rf={};q_(Rf,{APIConnectionError:()=>fr,APIConnectionTimeoutError:()=>hr,APIError:()=>Oe,APIUserAbortError:()=>Te,AuthenticationError:()=>ki,BadRequestError:()=>Mi,ConflictError:()=>ji,ContentFilterFinishReasonError:()=>In,InternalServerError:()=>$i,LengthFinishReasonError:()=>Cn,NotFoundError:()=>Ni,OpenAIError:()=>q,PermissionDeniedError:()=>Di,RateLimitError:()=>zi,UnprocessableEntityError:()=>Fi});var wn="4.56.0";var xm=!1,xn,vf,kA,DA,NA,bf,jA,su,_f,wf,xf,au,Af;function Am(r,e={auto:!1}){if(xm)throw new Error(`you must \`import 'openai/shims/${r.kind}'\` before importing anything else from openai`);if(xn)throw new Error(`can't \`import 'openai/shims/${r.kind}'\` after \`import 'openai/shims/${xn}'\``);xm=e.auto,xn=r.kind,vf=r.fetch,kA=r.Request,DA=r.Response,NA=r.Headers,bf=r.FormData,jA=r.Blob,su=r.File,_f=r.ReadableStream,wf=r.getMultipartRequestOptions,xf=r.getDefaultAgent,au=r.fileFromPath,Af=r.isFsReadStream}var uu=class{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}};function Cm({manuallyImported:r}={}){let e=r?"You may need to use polyfills":"Add one of these imports before your first `import \u2026 from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n",n,i,o,s;try{n=fetch,i=Request,o=Response,s=Headers}catch(a){throw new Error(`this environment is missing the following Web Fetch API type: ${a.message}. ${e}`)}return{kind:"web",fetch:n,Request:i,Response:o,Headers:s,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:(a,u)=>I(this,null,function*(){return _(p({},u),{body:new uu(a)})}),getDefaultAgent:a=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:a=>!1}}xn||Am(Cm(),{auto:!0});var Bt=class r{constructor(e,n){this.iterator=e,this.controller=n}static fromSSEResponse(e,n){let i=!1;function o(){return he(this,null,function*(){if(i)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let s=!1;try{try{for(var a=te(zA(e,n)),u,l,c;u=!(l=yield new G(a.next())).done;u=!1){let f=l.value;if(!s){if(f.data.startsWith("[DONE]")){s=!0;continue}if(f.event===null){let h;try{h=JSON.parse(f.data)}catch(d){throw console.error("Could not parse message into JSON:",f.data),console.error("From chunk:",f.raw),d}if(h&&h.error)throw new Oe(void 0,h.error,void 0,void 0);yield h}else{let h;try{h=JSON.parse(f.data)}catch(d){throw console.error("Could not parse message into JSON:",f.data),console.error("From chunk:",f.raw),d}if(f.event=="error")throw new Oe(void 0,h.error,h.message,void 0);yield{event:f.event,data:h}}}}}catch{c=[l]}finally{try{u&&(l=a.return)&&(yield new G(l.call(a)))}finally{if(c)throw c[0]}}s=!0}catch(f){if(f instanceof Error&&f.name==="AbortError")return;throw f}finally{s||n.abort()}})}return new r(o,n)}static fromReadableStream(e,n){let i=!1;function o(){return he(this,null,function*(){let a=new Si,u=Im(e);try{for(var l=te(u),c,f,h;c=!(f=yield new G(l.next())).done;c=!1){let d=f.value;for(let m of a.decode(d))yield m}}catch{h=[f]}finally{try{c&&(f=l.return)&&(yield new G(f.call(l)))}finally{if(h)throw h[0]}}for(let d of a.flush())yield d})}function s(){return he(this,null,function*(){if(i)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let a=!1;try{try{for(var u=te(o()),l,c,f;l=!(c=yield new G(u.next())).done;l=!1){let h=c.value;a||h&&(yield JSON.parse(h))}}catch{f=[c]}finally{try{l&&(c=u.return)&&(yield new G(c.call(u)))}finally{if(f)throw f[0]}}a=!0}catch(h){if(h instanceof Error&&h.name==="AbortError")return;throw h}finally{a||n.abort()}})}return new r(s,n)}[Symbol.asyncIterator](){return this.iterator()}tee(){let e=[],n=[],i=this.iterator(),o=s=>({next:()=>{if(s.length===0){let a=i.next();e.push(a),n.push(a)}return s.shift()}});return[new r(()=>o(e),this.controller),new r(()=>o(n),this.controller)]}toReadableStream(){let e=this,n,i=new TextEncoder;return new _f({start(){return I(this,null,function*(){n=e[Symbol.asyncIterator]()})},pull(s){return I(this,null,function*(){try{let{value:a,done:u}=yield n.next();if(u)return s.close();let l=i.encode(JSON.stringify(a)+`
`);s.enqueue(l)}catch(a){s.error(a)}})},cancel(){return I(this,null,function*(){yield n.return?.()})}})}};function zA(r,e){return he(this,null,function*(){if(!r.body)throw e.abort(),new q("Attempted to iterate over a response with no body");let n=new Cf,i=new Si,o=Im(r.body);try{for(var s=te($A(o)),a,u,l;a=!(u=yield new G(s.next())).done;a=!1){let c=u.value;for(let f of i.decode(c)){let h=n.decode(f);h&&(yield h)}}}catch{l=[u]}finally{try{a&&(u=s.return)&&(yield new G(u.call(s)))}finally{if(l)throw l[0]}}for(let c of i.flush()){let f=n.decode(c);f&&(yield f)}})}function $A(r){return he(this,null,function*(){let e=new Uint8Array;try{for(var n=te(r),i,o,s;i=!(o=yield new G(n.next())).done;i=!1){let a=o.value;if(a==null)continue;let u=a instanceof ArrayBuffer?new Uint8Array(a):typeof a=="string"?new TextEncoder().encode(a):a,l=new Uint8Array(e.length+u.length);l.set(e),l.set(u,e.length),e=l;let c;for(;(c=LA(e))!==-1;)yield e.slice(0,c),e=e.slice(c)}}catch{s=[o]}finally{try{i&&(o=n.return)&&(yield new G(o.call(n)))}finally{if(s)throw s[0]}}e.length>0&&(yield e)})}function LA(r){for(let i=0;i<r.length-2;i++){if(r[i]===10&&r[i+1]===10||r[i]===13&&r[i+1]===13)return i+2;if(r[i]===13&&r[i+1]===10&&i+3<r.length&&r[i+2]===13&&r[i+3]===10)return i+4}return-1}var Cf=class{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;let s={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],s}if(this.chunks.push(e),e.startsWith(":"))return null;let[n,i,o]=UA(e,":");return o.startsWith(" ")&&(o=o.substring(1)),n==="event"?this.event=o:n==="data"&&this.data.push(o),null}},Si=class r{constructor(){this.buffer=[],this.trailingCR=!1}decode(e){let n=this.decodeText(e);if(this.trailingCR&&(n="\r"+n,this.trailingCR=!1),n.endsWith("\r")&&(this.trailingCR=!0,n=n.slice(0,-1)),!n)return[];let i=r.NEWLINE_CHARS.has(n[n.length-1]||""),o=n.split(r.NEWLINE_REGEXP);return i&&o.pop(),o.length===1&&!i?(this.buffer.push(o[0]),[]):(this.buffer.length>0&&(o=[this.buffer.join("")+o[0],...o.slice(1)],this.buffer=[]),i||(this.buffer=[o.pop()||""]),o)}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new q(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new q(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new q("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];let e=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,e}};Si.NEWLINE_CHARS=new Set([`
`,"\r"]);Si.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function UA(r,e){let n=r.indexOf(e);return n!==-1?[r.substring(0,n),e,r.substring(n+e.length)]:[r,"",""]}function Im(r){if(r[Symbol.asyncIterator])return r;let e=r.getReader();return{next(){return I(this,null,function*(){try{let i=yield e.read();return i?.done&&e.releaseLock(),i}catch(i){throw e.releaseLock(),i}})},return(){return I(this,null,function*(){let i=e.cancel();return e.releaseLock(),yield i,{done:!0,value:void 0}})},[Symbol.asyncIterator](){return this}}}var Em=r=>r!=null&&typeof r=="object"&&typeof r.url=="string"&&typeof r.blob=="function",Om=r=>r!=null&&typeof r=="object"&&typeof r.name=="string"&&typeof r.lastModified=="number"&&lu(r),lu=r=>r!=null&&typeof r=="object"&&typeof r.size=="number"&&typeof r.type=="string"&&typeof r.text=="function"&&typeof r.slice=="function"&&typeof r.arrayBuffer=="function",VA=r=>Om(r)||Em(r)||Af(r);function Of(r,e,n){return I(this,null,function*(){if(r=yield r,n??(n=Om(r)?{lastModified:r.lastModified,type:r.type}:{}),Em(r)){let o=yield r.blob();return e||(e=new URL(r.url).pathname.split(/[\\/]/).pop()??"unknown_file"),new su([o],e,n)}let i=yield BA(r);if(e||(e=GA(r)??"unknown_file"),!n.type){let o=i[0]?.type;typeof o=="string"&&(n=_(p({},n),{type:o}))}return new su(i,e,n)})}function BA(r){return I(this,null,function*(){let e=[];if(typeof r=="string"||ArrayBuffer.isView(r)||r instanceof ArrayBuffer)e.push(r);else if(lu(r))e.push(yield r.arrayBuffer());else if(HA(r))try{for(var n=te(r),i,o,s;i=!(o=yield n.next()).done;i=!1){let a=o.value;e.push(a)}}catch{s=[o]}finally{try{i&&(o=n.return)&&(yield o.call(n))}finally{if(s)throw s[0]}}else throw new Error(`Unexpected data type: ${typeof r}; constructor: ${r?.constructor?.name}; props: ${qA(r)}`);return e})}function qA(r){return`[${Object.getOwnPropertyNames(r).map(n=>`"${n}"`).join(", ")}]`}function GA(r){return If(r.name)||If(r.filename)||If(r.path)?.split(/[\\/]/).pop()}var If=r=>{if(typeof r=="string")return r;if(typeof Buffer<"u"&&r instanceof Buffer)return String(r)},HA=r=>r!=null&&typeof r=="object"&&typeof r[Symbol.asyncIterator]=="function",Pf=r=>r&&typeof r=="object"&&r.body&&r[Symbol.toStringTag]==="MultipartBody";var mt=r=>I(void 0,null,function*(){let e=yield Pm(r.body);return wf(e,r)}),Pm=r=>I(void 0,null,function*(){let e=new bf;return yield Promise.all(Object.entries(r||{}).map(([n,i])=>Ef(e,n,i))),e});var Ef=(r,e,n)=>I(void 0,null,function*(){if(n!==void 0){if(n==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")r.append(e,String(n));else if(VA(n)){let i=yield Of(n);r.append(e,i)}else if(Array.isArray(n))yield Promise.all(n.map(i=>Ef(r,e+"[]",i)));else if(typeof n=="object")yield Promise.all(Object.entries(n).map(([i,o])=>Ef(r,`${e}[${i}]`,o)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}});var KA=function(r,e,n,i,o){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!o)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!o:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?o.call(r,n):o?o.value=n:e.set(r,n),n},ZA=function(r,e,n,i){if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?i:n==="a"?i.call(r):i?i.value:e.get(r)},cu;function km(r){return I(this,null,function*(){let{response:e}=r;if(r.options.stream)return Ri("response",e.status,e.url,e.headers,e.body),r.options.__streamClass?r.options.__streamClass.fromSSEResponse(e,r.controller):Bt.fromSSEResponse(e,r.controller);if(e.status===204)return null;if(r.options.__binaryResponse)return e;let n=e.headers.get("content-type");if(n?.includes("application/json")||n?.includes("application/vnd.api+json")){let s=yield e.json();return Ri("response",e.status,e.url,e.headers,s),s}let o=yield e.text();return Ri("response",e.status,e.url,e.headers,o),o})}var fu=class r extends Promise{constructor(e,n=km){super(i=>{i(null)}),this.responsePromise=e,this.parseResponse=n}_thenUnwrap(e){return new r(this.responsePromise,n=>I(this,null,function*(){return e(yield this.parseResponse(n))}))}asResponse(){return this.responsePromise.then(e=>e.response)}withResponse(){return I(this,null,function*(){let[e,n]=yield Promise.all([this.parse(),this.asResponse()]);return{data:e,response:n}})}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,n){return this.parse().then(e,n)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}},hu=class{constructor({baseURL:e,maxRetries:n=2,timeout:i=6e5,httpAgent:o,fetch:s}){this.baseURL=e,this.maxRetries=Tf("maxRetries",n),this.timeout=Tf("timeout",i),this.httpAgent=o,this.fetch=s??vf}authHeaders(e){return{}}defaultHeaders(e){return p(p({Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent()},eC()),this.authHeaders(e))}validateHeaders(e,n){}defaultIdempotencyKey(){return`stainless-node-retry-${iC()}`}get(e,n){return this.methodRequest("get",e,n)}post(e,n){return this.methodRequest("post",e,n)}patch(e,n){return this.methodRequest("patch",e,n)}put(e,n){return this.methodRequest("put",e,n)}delete(e,n){return this.methodRequest("delete",e,n)}methodRequest(e,n,i){return this.request(Promise.resolve(i).then(o=>I(this,null,function*(){let s=o&&lu(o?.body)?new DataView(yield o.body.arrayBuffer()):o?.body instanceof DataView?o.body:o?.body instanceof ArrayBuffer?new DataView(o.body):o&&ArrayBuffer.isView(o?.body)?new DataView(o.body.buffer):o?.body;return _(p({method:e,path:n},o),{body:s})})))}getAPIList(e,n,i){return this.requestAPIList(n,p({method:"get",path:e},i))}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e){let{method:n,path:i,query:o,headers:s={}}=e,a=ArrayBuffer.isView(e.body)||e.__binaryRequest&&typeof e.body=="string"?e.body:Pf(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,u=this.calculateContentLength(a),l=this.buildURL(i,o);"timeout"in e&&Tf("timeout",e.timeout);let c=e.timeout??this.timeout,f=e.httpAgent??this.httpAgent??xf(l),h=c+1e3;typeof f?.options?.timeout=="number"&&h>(f.options.timeout??0)&&(f.options.timeout=h),this.idempotencyHeader&&n!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),s[this.idempotencyHeader]=e.idempotencyKey);let d=this.buildHeaders({options:e,headers:s,contentLength:u});return{req:_(p(_(p({method:n},a&&{body:a}),{headers:d}),f&&{agent:f}),{signal:e.signal??null}),url:l,timeout:c}}buildHeaders({options:e,headers:n,contentLength:i}){let o={};i&&(o["content-length"]=i);let s=this.defaultHeaders(e);return Mm(o,s),Mm(o,n),Pf(e.body)&&xn!=="node"&&delete o["content-type"],this.validateHeaders(o,n),o}prepareOptions(e){return I(this,null,function*(){})}prepareRequest(o,s){return I(this,arguments,function*(e,{url:n,options:i}){})}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(n=>[...n])):p({},e):{}}makeStatusError(e,n,i,o){return Oe.generate(e,n,i,o)}request(e,n=null){return new fu(this.makeRequest(e,n))}makeRequest(e,n){return I(this,null,function*(){let i=yield e;n==null&&(n=i.maxRetries??this.maxRetries),yield this.prepareOptions(i);let{req:o,url:s,timeout:a}=this.buildRequest(i);if(yield this.prepareRequest(o,{url:s,options:i}),Ri("request",s,i,o.headers),i.signal?.aborted)throw new Te;let u=new AbortController,l=yield this.fetchWithTimeout(s,o,a,u).catch(du);if(l instanceof Error){if(i.signal?.aborted)throw new Te;if(n)return this.retryRequest(i,n);throw l.name==="AbortError"?new hr:new fr({cause:l})}let c=XA(l.headers);if(!l.ok){if(n&&this.shouldRetry(l)){let b=`retrying, ${n} attempts remaining`;return Ri(`response (error; ${b})`,l.status,s,c),this.retryRequest(i,n,c)}let f=yield l.text().catch(b=>du(b).message),h=tC(f),d=h?void 0:f;throw Ri(`response (error; ${n?"(error; no more retries left)":"(error; not retryable)"})`,l.status,s,c,d),this.makeStatusError(l.status,h,d,c)}return{response:l,options:i,controller:u}})}requestAPIList(e,n){let i=this.makeRequest(n,null);return new Sf(this,i,e)}buildURL(e,n){let i=nC(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),o=this.defaultQuery();return Dm(o)||(n=p(p({},o),n)),typeof n=="object"&&n&&!Array.isArray(n)&&(i.search=this.stringifyQuery(n)),i.toString()}stringifyQuery(e){return Object.entries(e).filter(([n,i])=>typeof i<"u").map(([n,i])=>{if(typeof i=="string"||typeof i=="number"||typeof i=="boolean")return`${encodeURIComponent(n)}=${encodeURIComponent(i)}`;if(i===null)return`${encodeURIComponent(n)}=`;throw new q(`Cannot stringify type ${typeof i}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}fetchWithTimeout(e,n,i,o){return I(this,null,function*(){let l=n||{},{signal:s}=l,a=fe(l,["signal"]);s&&s.addEventListener("abort",()=>o.abort());let u=setTimeout(()=>o.abort(),i);return this.getRequestClient().fetch.call(void 0,e,p({signal:o.signal},a)).finally(()=>{clearTimeout(u)})})}getRequestClient(){return{fetch:this.fetch}}shouldRetry(e){let n=e.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}retryRequest(e,n,i){return I(this,null,function*(){let o,s=i?.["retry-after-ms"];if(s){let u=parseFloat(s);Number.isNaN(u)||(o=u)}let a=i?.["retry-after"];if(a&&!o){let u=parseFloat(a);Number.isNaN(u)?o=Date.parse(a)-Date.now():o=u*1e3}if(!(o&&0<=o&&o<60*1e3)){let u=e.maxRetries??this.maxRetries;o=this.calculateDefaultRetryTimeoutMillis(n,u)}return yield cr(o),this.makeRequest(e,n-1)})}calculateDefaultRetryTimeoutMillis(e,n){let s=n-e,a=Math.min(.5*Math.pow(2,s),8),u=1-Math.random()*.25;return a*u*1e3}getUserAgent(){return`${this.constructor.name}/JS ${wn}`}},os=class{constructor(e,n,i,o){cu.set(this,void 0),KA(this,cu,e,"f"),this.options=o,this.response=n,this.body=i}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}getNextPage(){return I(this,null,function*(){let e=this.nextPageInfo();if(!e)throw new q("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");let n=p({},this.options);if("params"in e&&typeof n.query=="object")n.query=p(p({},n.query),e.params);else if("url"in e){let i=[...Object.entries(n.query||{}),...e.url.searchParams.entries()];for(let[o,s]of i)e.url.searchParams.set(o,s);n.query=void 0,n.path=e.url.toString()}return yield ZA(this,cu,"f").requestAPIList(this.constructor,n)})}iterPages(){return he(this,null,function*(){let e=this;for(yield e;e.hasNextPage();)e=yield new G(e.getNextPage()),yield e})}[(cu=new WeakMap,Symbol.asyncIterator)](){return he(this,null,function*(){try{for(var e=te(this.iterPages()),n,i,o;n=!(i=yield new G(e.next())).done;n=!1){let s=i.value;for(let a of s.getPaginatedItems())yield a}}catch{o=[i]}finally{try{n&&(i=e.return)&&(yield new G(i.call(e)))}finally{if(o)throw o[0]}}})}},Sf=class extends fu{constructor(e,n,i){super(n,o=>I(this,null,function*(){return new i(e,o.response,yield km(o),o.options)}))}[Symbol.asyncIterator](){return he(this,null,function*(){let e=yield new G(this);try{for(var n=te(e),i,o,s;i=!(o=yield new G(n.next())).done;i=!1){let a=o.value;yield a}}catch{s=[o]}finally{try{i&&(o=n.return)&&(yield new G(o.call(n)))}finally{if(s)throw s[0]}}})}},XA=r=>new Proxy(Object.fromEntries(r.entries()),{get(e,n){let i=n.toString();return e[i.toLowerCase()]||e[i]}}),JA={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},ye=r=>typeof r=="object"&&r!==null&&!Dm(r)&&Object.keys(r).every(e=>Nm(JA,e)),YA=()=>{if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":wn,"X-Stainless-OS":Sm(Deno.build.os),"X-Stainless-Arch":Tm(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:Deno.version?.deno??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":wn,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":wn,"X-Stainless-OS":Sm(process.platform),"X-Stainless-Arch":Tm(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};let r=QA();return r?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":wn,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${r.browser}`,"X-Stainless-Runtime-Version":r.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":wn,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function QA(){if(typeof navigator>"u"||!navigator)return null;let r=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(let{key:e,pattern:n}of r){let i=n.exec(navigator.userAgent);if(i){let o=i[1]||0,s=i[2]||0,a=i[3]||0;return{browser:e,version:`${o}.${s}.${a}`}}}return null}var Tm=r=>r==="x32"?"x32":r==="x86_64"||r==="x64"?"x64":r==="arm"?"arm":r==="aarch64"||r==="arm64"?"arm64":r?`other:${r}`:"unknown",Sm=r=>(r=r.toLowerCase(),r.includes("ios")?"iOS":r==="android"?"Android":r==="darwin"?"MacOS":r==="win32"?"Windows":r==="freebsd"?"FreeBSD":r==="openbsd"?"OpenBSD":r==="linux"?"Linux":r?`Other:${r}`:"Unknown"),Rm,eC=()=>Rm??(Rm=YA()),tC=r=>{try{return JSON.parse(r)}catch{return}},rC=new RegExp("^(?:[a-z]+:)?//","i"),nC=r=>rC.test(r),cr=r=>new Promise(e=>setTimeout(e,r)),Tf=(r,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new q(`${r} must be an integer`);if(e<0)throw new q(`${r} must be a positive integer`);return e},du=r=>r instanceof Error?r:new Error(r);var ss=r=>{if(typeof process<"u")return process.env?.[r]?.trim()??void 0;if(typeof Deno<"u")return Deno.env?.get?.(r)?.trim()};function Dm(r){if(!r)return!0;for(let e in r)return!1;return!0}function Nm(r,e){return Object.prototype.hasOwnProperty.call(r,e)}function Mm(r,e){for(let n in e){if(!Nm(e,n))continue;let i=n.toLowerCase();if(!i)continue;let o=e[n];o===null?delete r[i]:o!==void 0&&(r[i]=o)}}function Ri(r,...e){typeof process<"u"&&process?.env?.DEBUG==="true"&&console.log(`OpenAI:DEBUG:${r}`,...e)}var iC=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,r=>{let e=Math.random()*16|0;return(r==="x"?e:e&3|8).toString(16)}),jm=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";function pu(r){return r!=null&&typeof r=="object"&&!Array.isArray(r)}var q=class extends Error{},Oe=class r extends q{constructor(e,n,i,o){super(`${r.makeMessage(e,n,i)}`),this.status=e,this.headers=o,this.request_id=o?.["x-request-id"];let s=n;this.error=s,this.code=s?.code,this.param=s?.param,this.type=s?.type}static makeMessage(e,n,i){let o=n?.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):i;return e&&o?`${e} ${o}`:e?`${e} status code (no body)`:o||"(no status code or body)"}static generate(e,n,i,o){if(!e)return new fr({cause:du(n)});let s=n?.error;return e===400?new Mi(e,s,i,o):e===401?new ki(e,s,i,o):e===403?new Di(e,s,i,o):e===404?new Ni(e,s,i,o):e===409?new ji(e,s,i,o):e===422?new Fi(e,s,i,o):e===429?new zi(e,s,i,o):e>=500?new $i(e,s,i,o):new r(e,s,i,o)}},Te=class extends Oe{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0),this.status=void 0}},fr=class extends Oe{constructor({message:e,cause:n}){super(void 0,void 0,e||"Connection error.",void 0),this.status=void 0,n&&(this.cause=n)}},hr=class extends fr{constructor({message:e}={}){super({message:e??"Request timed out."})}},Mi=class extends Oe{constructor(){super(...arguments),this.status=400}},ki=class extends Oe{constructor(){super(...arguments),this.status=401}},Di=class extends Oe{constructor(){super(...arguments),this.status=403}},Ni=class extends Oe{constructor(){super(...arguments),this.status=404}},ji=class extends Oe{constructor(){super(...arguments),this.status=409}},Fi=class extends Oe{constructor(){super(...arguments),this.status=422}},zi=class extends Oe{constructor(){super(...arguments),this.status=429}},$i=class extends Oe{},Cn=class extends q{constructor(){super("Could not parse response content as the length limit was reached")}},In=class extends q{constructor(){super("Could not parse response content as the request was rejected by the content filter")}};var Sr=class extends os{constructor(e,n,i,o){super(e,n,i,o),this.data=i.data||[],this.object=i.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}},be=class extends os{constructor(e,n,i,o){super(e,n,i,o),this.data=i.data||[]}getPaginatedItems(){return this.data??[]}nextPageParams(){let e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;let n=Object.fromEntries(e.url.searchParams);return Object.keys(n).length?n:null}nextPageInfo(){let e=this.getPaginatedItems();if(!e.length)return null;let n=e[e.length-1]?.id;return n?{params:{after:n}}:null}};var F=class{constructor(e){this._client=e}};var En=class extends F{create(e,n){return this._client.post("/chat/completions",_(p({body:e},n),{stream:e.stream??!1}))}};En||(En={});var Rr=class extends F{constructor(){super(...arguments),this.completions=new En(this._client)}};(function(r){r.Completions=En})(Rr||(Rr={}));var On=class extends F{create(e,n){return this._client.post("/audio/speech",_(p({body:e},n),{__binaryResponse:!0}))}};On||(On={});var Pn=class extends F{create(e,n){return this._client.post("/audio/transcriptions",mt(p({body:e},n)))}};Pn||(Pn={});var Tn=class extends F{create(e,n){return this._client.post("/audio/translations",mt(p({body:e},n)))}};Tn||(Tn={});var Mr=class extends F{constructor(){super(...arguments),this.transcriptions=new Pn(this._client),this.translations=new Tn(this._client),this.speech=new On(this._client)}};(function(r){r.Transcriptions=Pn,r.Translations=Tn,r.Speech=On})(Mr||(Mr={}));var kr=class extends F{create(e,n){return this._client.post("/batches",p({body:e},n))}retrieve(e,n){return this._client.get(`/batches/${e}`,n)}list(e={},n){return ye(e)?this.list({},e):this._client.getAPIList("/batches",Dr,p({query:e},n))}cancel(e,n){return this._client.post(`/batches/${e}/cancel`,n)}},Dr=class extends be{};(function(r){r.BatchesPage=Dr})(kr||(kr={}));var Sn=class extends F{create(e,n){return this._client.post("/assistants",_(p({body:e},n),{headers:p({"OpenAI-Beta":"assistants=v2"},n?.headers)}))}retrieve(e,n){return this._client.get(`/assistants/${e}`,_(p({},n),{headers:p({"OpenAI-Beta":"assistants=v2"},n?.headers)}))}update(e,n,i){return this._client.post(`/assistants/${e}`,_(p({body:n},i),{headers:p({"OpenAI-Beta":"assistants=v2"},i?.headers)}))}list(e={},n){return ye(e)?this.list({},e):this._client.getAPIList("/assistants",Rn,_(p({query:e},n),{headers:p({"OpenAI-Beta":"assistants=v2"},n?.headers)}))}del(e,n){return this._client.delete(`/assistants/${e}`,_(p({},n),{headers:p({"OpenAI-Beta":"assistants=v2"},n?.headers)}))}},Rn=class extends be{};(function(r){r.AssistantsPage=Rn})(Sn||(Sn={}));function Mf(r){return typeof r.parse=="function"}var Nr=r=>r?.role==="assistant",kf=r=>r?.role==="function",Df=r=>r?.role==="tool";var St=function(r,e,n,i,o){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!o)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!o:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?o.call(r,n):o?o.value=n:e.set(r,n),n},_e=function(r,e,n,i){if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?i:n==="a"?i.call(r):i?i.value:e.get(r)},Nf,mu,gu,as,us,yu,ls,dr,cs,vu,bu,Li,zm,Ui=class{constructor(){Nf.add(this),this.controller=new AbortController,mu.set(this,void 0),gu.set(this,()=>{}),as.set(this,()=>{}),us.set(this,void 0),yu.set(this,()=>{}),ls.set(this,()=>{}),dr.set(this,{}),cs.set(this,!1),vu.set(this,!1),bu.set(this,!1),Li.set(this,!1),St(this,mu,new Promise((e,n)=>{St(this,gu,e,"f"),St(this,as,n,"f")}),"f"),St(this,us,new Promise((e,n)=>{St(this,yu,e,"f"),St(this,ls,n,"f")}),"f"),_e(this,mu,"f").catch(()=>{}),_e(this,us,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},_e(this,Nf,"m",zm).bind(this))},0)}_connected(){this.ended||(_e(this,gu,"f").call(this),this._emit("connect"))}get ended(){return _e(this,cs,"f")}get errored(){return _e(this,vu,"f")}get aborted(){return _e(this,bu,"f")}abort(){this.controller.abort()}on(e,n){return(_e(this,dr,"f")[e]||(_e(this,dr,"f")[e]=[])).push({listener:n}),this}off(e,n){let i=_e(this,dr,"f")[e];if(!i)return this;let o=i.findIndex(s=>s.listener===n);return o>=0&&i.splice(o,1),this}once(e,n){return(_e(this,dr,"f")[e]||(_e(this,dr,"f")[e]=[])).push({listener:n,once:!0}),this}emitted(e){return new Promise((n,i)=>{St(this,Li,!0,"f"),e!=="error"&&this.once("error",i),this.once(e,n)})}done(){return I(this,null,function*(){St(this,Li,!0,"f"),yield _e(this,us,"f")})}_emit(e,...n){if(_e(this,cs,"f"))return;e==="end"&&(St(this,cs,!0,"f"),_e(this,yu,"f").call(this));let i=_e(this,dr,"f")[e];if(i&&(_e(this,dr,"f")[e]=i.filter(o=>!o.once),i.forEach(({listener:o})=>o(...n))),e==="abort"){let o=n[0];!_e(this,Li,"f")&&!i?.length&&Promise.reject(o),_e(this,as,"f").call(this,o),_e(this,ls,"f").call(this,o),this._emit("end");return}if(e==="error"){let o=n[0];!_e(this,Li,"f")&&!i?.length&&Promise.reject(o),_e(this,as,"f").call(this,o),_e(this,ls,"f").call(this,o),this._emit("end")}}_emitFinal(){}};mu=new WeakMap,gu=new WeakMap,as=new WeakMap,us=new WeakMap,yu=new WeakMap,ls=new WeakMap,dr=new WeakMap,cs=new WeakMap,vu=new WeakMap,bu=new WeakMap,Li=new WeakMap,Nf=new WeakSet,zm=function(e){if(St(this,vu,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new Te),e instanceof Te)return St(this,bu,!0,"f"),this._emit("abort",e);if(e instanceof q)return this._emit("error",e);if(e instanceof Error){let n=new q(e.message);return n.cause=e,this._emit("error",n)}return this._emit("error",new q(String(e)))};function $m(r,e){let n=p({},r);return Object.defineProperties(n,{$brand:{value:"auto-parseable-response-format",enumerable:!1},$parseRaw:{value:e,enumerable:!1}}),n}function jf(r){return r?.$brand==="auto-parseable-response-format"}function Lm(r,{parser:e,callback:n}){let i=p({},r);return Object.defineProperties(i,{$brand:{value:"auto-parseable-tool",enumerable:!1},$parseRaw:{value:e,enumerable:!1},$callback:{value:n,enumerable:!1}}),i}function Mn(r){return r?.$brand==="auto-parseable-tool"}function Um(r,e){return!e||!Ff(e)?_(p({},r),{choices:r.choices.map(n=>_(p({},n),{message:_(p({},n.message),{parsed:null,tool_calls:n.message.tool_calls??[]})}))}):fs(r,e)}function fs(r,e){let n=r.choices.map(i=>{if(i.finish_reason==="length")throw new Cn;if(i.finish_reason==="content_filter")throw new In;return _(p({},i),{message:_(p({},i.message),{tool_calls:i.message.tool_calls?.map(o=>hC(e,o))??[],parsed:i.message.content&&!i.message.refusal?fC(e,i.message.content):null})})});return _(p({},r),{choices:n})}function fC(r,e){return r.response_format?.type!=="json_schema"?null:r.response_format?.type==="json_schema"?"$parseRaw"in r.response_format?r.response_format.$parseRaw(e):JSON.parse(e):null}function hC(r,e){let n=r.tools?.find(i=>i.function?.name===e.function.name);return _(p({},e),{function:_(p({},e.function),{parsed_arguments:Mn(n)?n.$parseRaw(e.function.arguments):n?.function.strict?JSON.parse(e.function.arguments):null})})}function Vm(r,e){if(!r)return!1;let n=r.tools?.find(i=>i.function?.name===e.function.name);return Mn(n)||n?.function.strict||!1}function Ff(r){return jf(r.response_format)?!0:r.tools?.some(e=>Mn(e)||e.type==="function"&&e.function.strict===!0)??!1}function Bm(r){for(let e of r??[]){if(e.type!=="function")throw new q(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new q(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var Je=function(r,e,n,i){if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?i:n==="a"?i.call(r):i?i.value:e.get(r)},Le,zf,_u,$f,Lf,Uf,Gm,Vf,qm=10,Vi=class extends Ui{constructor(){super(...arguments),Le.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){this._chatCompletions.push(e),this._emit("chatCompletion",e);let n=e.choices[0]?.message;return n&&this._addMessage(n),e}_addMessage(e,n=!0){if("content"in e||(e.content=null),this.messages.push(e),n){if(this._emit("message",e),(kf(e)||Df(e))&&e.content)this._emit("functionCallResult",e.content);else if(Nr(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(Nr(e)&&e.tool_calls)for(let i of e.tool_calls)i.type==="function"&&this._emit("functionCall",i.function)}}finalChatCompletion(){return I(this,null,function*(){yield this.done();let e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new q("stream ended without producing a ChatCompletion");return e})}finalContent(){return I(this,null,function*(){return yield this.done(),Je(this,Le,"m",zf).call(this)})}finalMessage(){return I(this,null,function*(){return yield this.done(),Je(this,Le,"m",_u).call(this)})}finalFunctionCall(){return I(this,null,function*(){return yield this.done(),Je(this,Le,"m",$f).call(this)})}finalFunctionCallResult(){return I(this,null,function*(){return yield this.done(),Je(this,Le,"m",Lf).call(this)})}totalUsage(){return I(this,null,function*(){return yield this.done(),Je(this,Le,"m",Uf).call(this)})}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){let e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);let n=Je(this,Le,"m",_u).call(this);n&&this._emit("finalMessage",n);let i=Je(this,Le,"m",zf).call(this);i&&this._emit("finalContent",i);let o=Je(this,Le,"m",$f).call(this);o&&this._emit("finalFunctionCall",o);let s=Je(this,Le,"m",Lf).call(this);s!=null&&this._emit("finalFunctionCallResult",s),this._chatCompletions.some(a=>a.usage)&&this._emit("totalUsage",Je(this,Le,"m",Uf).call(this))}_createChatCompletion(e,n,i){return I(this,null,function*(){let o=i?.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort())),Je(this,Le,"m",Gm).call(this,n);let s=yield e.chat.completions.create(_(p({},n),{stream:!1}),_(p({},i),{signal:this.controller.signal}));return this._connected(),this._addChatCompletion(fs(s,n))})}_runChatCompletion(e,n,i){return I(this,null,function*(){for(let o of n.messages)this._addMessage(o,!1);return yield this._createChatCompletion(e,n,i)})}_runFunctions(e,n,i){return I(this,null,function*(){let o="function",d=n,{function_call:s="auto",stream:a}=d,u=fe(d,["function_call","stream"]),l=typeof s!="string"&&s?.name,{maxChatCompletions:c=qm}=i||{},f={};for(let m of n.functions)f[m.name||m.function.name]=m;let h=n.functions.map(m=>({name:m.name||m.function.name,parameters:m.parameters,description:m.description}));for(let m of n.messages)this._addMessage(m,!1);for(let m=0;m<c;++m){let b=(yield this._createChatCompletion(e,_(p({},u),{function_call:s,functions:h,messages:[...this.messages]}),i)).choices[0]?.message;if(!b)throw new q("missing message in ChatCompletion response");if(!b.function_call)return;let{name:v,arguments:g}=b.function_call,A=f[v];if(A){if(l&&l!==v){let C=`Invalid function_call: ${JSON.stringify(v)}. ${JSON.stringify(l)} requested. Please try again`;this._addMessage({role:o,name:v,content:C});continue}}else{let C=`Invalid function_call: ${JSON.stringify(v)}. Available options are: ${h.map(O=>JSON.stringify(O.name)).join(", ")}. Please try again`;this._addMessage({role:o,name:v,content:C});continue}let E;try{E=Mf(A)?yield A.parse(g):g}catch(C){this._addMessage({role:o,name:v,content:C instanceof Error?C.message:String(C)});continue}let w=yield A.function(E,this),x=Je(this,Le,"m",Vf).call(this,w);if(this._addMessage({role:o,name:v,content:x}),l)return}})}_runTools(e,n,i){return I(this,null,function*(){let o="tool",m=n,{tool_choice:s="auto",stream:a}=m,u=fe(m,["tool_choice","stream"]),l=typeof s!="string"&&s?.function?.name,{maxChatCompletions:c=qm}=i||{},f=n.tools.map(y=>{if(Mn(y)){if(!y.$callback)throw new q("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:y.$callback,name:y.function.name,description:y.function.description||"",parameters:y.function.parameters,parse:y.$parseRaw,strict:!0}}}return y}),h={};for(let y of f)y.type==="function"&&(h[y.function.name||y.function.function.name]=y.function);let d="tools"in n?f.map(y=>y.type==="function"?{type:"function",function:{name:y.function.name||y.function.function.name,parameters:y.function.parameters,description:y.function.description,strict:y.function.strict}}:y):void 0;for(let y of n.messages)this._addMessage(y,!1);for(let y=0;y<c;++y){let v=(yield this._createChatCompletion(e,_(p({},u),{tool_choice:s,tools:d,messages:[...this.messages]}),i)).choices[0]?.message;if(!v)throw new q("missing message in ChatCompletion response");if(!v.tool_calls?.length)return;for(let g of v.tool_calls){if(g.type!=="function")continue;let A=g.id,{name:E,arguments:w}=g.function,x=h[E];if(x){if(l&&l!==E){let M=`Invalid tool_call: ${JSON.stringify(E)}. ${JSON.stringify(l)} requested. Please try again`;this._addMessage({role:o,tool_call_id:A,content:M});continue}}else{let M=`Invalid tool_call: ${JSON.stringify(E)}. Available options are: ${Object.keys(h).map(D=>JSON.stringify(D)).join(", ")}. Please try again`;this._addMessage({role:o,tool_call_id:A,content:M});continue}let C;try{C=Mf(x)?yield x.parse(w):w}catch(M){let D=M instanceof Error?M.message:String(M);this._addMessage({role:o,tool_call_id:A,content:D});continue}let O=yield x.function(C,this),T=Je(this,Le,"m",Vf).call(this,O);if(this._addMessage({role:o,tool_call_id:A,content:T}),l)return}}})}};Le=new WeakSet,zf=function(){return Je(this,Le,"m",_u).call(this).content??null},_u=function(){let e=this.messages.length;for(;e-- >0;){let i=this.messages[e];if(Nr(i)){let n=i,{function_call:o}=n,s=fe(n,["function_call"]),a=_(p({},s),{content:i.content??null,refusal:i.refusal??null});return o&&(a.function_call=o),a}}throw new q("stream ended without producing a ChatCompletionMessage with role=assistant")},$f=function(){for(let e=this.messages.length-1;e>=0;e--){let n=this.messages[e];if(Nr(n)&&n?.function_call)return n.function_call;if(Nr(n)&&n?.tool_calls?.length)return n.tool_calls.at(-1)?.function}},Lf=function(){for(let e=this.messages.length-1;e>=0;e--){let n=this.messages[e];if(kf(n)&&n.content!=null||Df(n)&&n.content!=null&&typeof n.content=="string"&&this.messages.some(i=>i.role==="assistant"&&i.tool_calls?.some(o=>o.type==="function"&&o.id===n.tool_call_id)))return n.content}},Uf=function(){let e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(let{usage:n}of this._chatCompletions)n&&(e.completion_tokens+=n.completion_tokens,e.prompt_tokens+=n.prompt_tokens,e.total_tokens+=n.total_tokens);return e},Gm=function(e){if(e.n!=null&&e.n>1)throw new q("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},Vf=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};var hs=class r extends Vi{static runFunctions(e,n,i){let o=new r,s=_(p({},i),{headers:_(p({},i?.headers),{"X-Stainless-Helper-Method":"runFunctions"})});return o._run(()=>o._runFunctions(e,n,s)),o}static runTools(e,n,i){let o=new r,s=_(p({},i),{headers:_(p({},i?.headers),{"X-Stainless-Helper-Method":"runTools"})});return o._run(()=>o._runTools(e,n,s)),o}_addMessage(e){super._addMessage(e),Nr(e)&&e.content&&this._emit("content",e.content)}};var dC=r=>{let e=0,n=[];for(;e<r.length;){let i=r[e];if(i==="\\"){e++;continue}if(i==="{"){n.push({type:"brace",value:"{"}),e++;continue}if(i==="}"){n.push({type:"brace",value:"}"}),e++;continue}if(i==="["){n.push({type:"paren",value:"["}),e++;continue}if(i==="]"){n.push({type:"paren",value:"]"}),e++;continue}if(i===":"){n.push({type:"separator",value:":"}),e++;continue}if(i===","){n.push({type:"delimiter",value:","}),e++;continue}if(i==='"'){let u="",l=!1;for(i=r[++e];i!=='"';){if(e===r.length){l=!0;break}if(i==="\\"){if(e++,e===r.length){l=!0;break}u+=i+r[e],i=r[++e]}else u+=i,i=r[++e]}i=r[++e],l||n.push({type:"string",value:u});continue}if(i&&/\s/.test(i)){e++;continue}let s=/[0-9]/;if(i&&s.test(i)||i==="-"||i==="."){let u="";for(i==="-"&&(u+=i,i=r[++e]);i&&s.test(i)||i===".";)u+=i,i=r[++e];n.push({type:"number",value:u});continue}let a=/[a-z]/i;if(i&&a.test(i)){let u="";for(;i&&a.test(i)&&e!==r.length;)u+=i,i=r[++e];if(u=="true"||u=="false"||u==="null")n.push({type:"name",value:u});else{e++;continue}continue}e++}return n},Bi=r=>{if(r.length===0)return r;let e=r[r.length-1];switch(e.type){case"separator":return r=r.slice(0,r.length-1),Bi(r);break;case"number":let n=e.value[e.value.length-1];if(n==="."||n==="-")return r=r.slice(0,r.length-1),Bi(r);case"string":let i=r[r.length-2];if(i?.type==="delimiter")return r=r.slice(0,r.length-1),Bi(r);if(i?.type==="brace"&&i.value==="{")return r=r.slice(0,r.length-1),Bi(r);break;case"delimiter":return r=r.slice(0,r.length-1),Bi(r);break}return r},pC=r=>{let e=[];return r.map(n=>{n.type==="brace"&&(n.value==="{"?e.push("}"):e.splice(e.lastIndexOf("}"),1)),n.type==="paren"&&(n.value==="["?e.push("]"):e.splice(e.lastIndexOf("]"),1))}),e.length>0&&e.reverse().map(n=>{n==="}"?r.push({type:"brace",value:"}"}):n==="]"&&r.push({type:"paren",value:"]"})}),r},mC=r=>{let e="";return r.map(n=>{switch(n.type){case"string":e+='"'+n.value+'"';break;default:e+=n.value;break}}),e},Bf=r=>JSON.parse(mC(pC(Bi(dC(r)))));var qi=function(r,e,n,i,o){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!o)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!o:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?o.call(r,n):o?o.value=n:e.set(r,n),n},ue=function(r,e,n,i){if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?i:n==="a"?i.call(r):i?i.value:e.get(r)},Se,pr,Gi,jr,qf,wu,Gf,Hf,Wf,xu,Kf,Hm,Hi=class r extends Vi{constructor(e){super(),Se.add(this),pr.set(this,void 0),Gi.set(this,void 0),jr.set(this,void 0),qi(this,pr,e,"f"),qi(this,Gi,[],"f")}get currentChatCompletionSnapshot(){return ue(this,jr,"f")}static fromReadableStream(e){let n=new r(null);return n._run(()=>n._fromReadableStream(e)),n}static createChatCompletion(e,n,i){let o=new r(n);return o._run(()=>o._runChatCompletion(e,_(p({},n),{stream:!0}),_(p({},i),{headers:_(p({},i?.headers),{"X-Stainless-Helper-Method":"stream"})}))),o}_createChatCompletion(e,n,i){return I(this,null,function*(){vo(r.prototype,this,"_createChatCompletion");let o=i?.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort())),ue(this,Se,"m",qf).call(this);let s=yield e.chat.completions.create(_(p({},n),{stream:!0}),_(p({},i),{signal:this.controller.signal}));this._connected();try{for(var a=te(s),u,l,c;u=!(l=yield a.next()).done;u=!1){let f=l.value;ue(this,Se,"m",Gf).call(this,f)}}catch{c=[l]}finally{try{u&&(l=a.return)&&(yield l.call(a))}finally{if(c)throw c[0]}}if(s.controller.signal?.aborted)throw new Te;return this._addChatCompletion(ue(this,Se,"m",xu).call(this))})}_fromReadableStream(e,n){return I(this,null,function*(){let i=n?.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort())),ue(this,Se,"m",qf).call(this),this._connected();let o=Bt.fromReadableStream(e,this.controller),s;try{for(var a=te(o),u,l,c;u=!(l=yield a.next()).done;u=!1){let f=l.value;s&&s!==f.id&&this._addChatCompletion(ue(this,Se,"m",xu).call(this)),ue(this,Se,"m",Gf).call(this,f),s=f.id}}catch{c=[l]}finally{try{u&&(l=a.return)&&(yield l.call(a))}finally{if(c)throw c[0]}}if(o.controller.signal?.aborted)throw new Te;return this._addChatCompletion(ue(this,Se,"m",xu).call(this))})}[(pr=new WeakMap,Gi=new WeakMap,jr=new WeakMap,Se=new WeakSet,qf=function(){this.ended||qi(this,jr,void 0,"f")},wu=function(n){let i=ue(this,Gi,"f")[n.index];return i||(i={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},ue(this,Gi,"f")[n.index]=i,i)},Gf=function(n){if(this.ended)return;let i=ue(this,Se,"m",Hm).call(this,n);this._emit("chunk",n,i);for(let o of n.choices){let s=i.choices[o.index];o.delta.content!=null&&s.message?.role==="assistant"&&s.message?.content&&(this._emit("content",o.delta.content,s.message.content),this._emit("content.delta",{delta:o.delta.content,snapshot:s.message.content,parsed:s.message.parsed})),o.delta.refusal!=null&&s.message?.role==="assistant"&&s.message?.refusal&&this._emit("refusal.delta",{delta:o.delta.refusal,snapshot:s.message.refusal}),o.logprobs?.content!=null&&s.message?.role==="assistant"&&this._emit("logprobs.content.delta",{content:o.logprobs?.content,snapshot:s.logprobs?.content??[]}),o.logprobs?.refusal!=null&&s.message?.role==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:o.logprobs?.refusal,snapshot:s.logprobs?.refusal??[]});let a=ue(this,Se,"m",wu).call(this,s);s.finish_reason&&(ue(this,Se,"m",Wf).call(this,s),a.current_tool_call_index!=null&&ue(this,Se,"m",Hf).call(this,s,a.current_tool_call_index));for(let u of o.delta.tool_calls??[])a.current_tool_call_index!==u.index&&(ue(this,Se,"m",Wf).call(this,s),a.current_tool_call_index!=null&&ue(this,Se,"m",Hf).call(this,s,a.current_tool_call_index)),a.current_tool_call_index=u.index;for(let u of o.delta.tool_calls??[]){let l=s.message.tool_calls?.[u.index];l?.type&&(l?.type==="function"?this._emit("tool_calls.function.arguments.delta",{name:l.function?.name,index:u.index,arguments:l.function.arguments,parsed_arguments:l.function.parsed_arguments,arguments_delta:u.function?.arguments??""}):(l?.type,void 0))}}},Hf=function(n,i){if(ue(this,Se,"m",wu).call(this,n).done_tool_calls.has(i))return;let s=n.message.tool_calls?.[i];if(!s)throw new Error("no tool call snapshot");if(!s.type)throw new Error("tool call snapshot missing `type`");if(s.type==="function"){let a=ue(this,pr,"f")?.tools?.find(u=>u.type==="function"&&u.function.name===s.function.name);this._emit("tool_calls.function.arguments.done",{name:s.function.name,index:i,arguments:s.function.arguments,parsed_arguments:Mn(a)?a.$parseRaw(s.function.arguments):a?.function.strict?JSON.parse(s.function.arguments):null})}else s.type},Wf=function(n){let i=ue(this,Se,"m",wu).call(this,n);if(n.message.content&&!i.content_done){i.content_done=!0;let o=ue(this,Se,"m",Kf).call(this);this._emit("content.done",{content:n.message.content,parsed:o?o.$parseRaw(n.message.content):null})}n.message.refusal&&!i.refusal_done&&(i.refusal_done=!0,this._emit("refusal.done",{refusal:n.message.refusal})),n.logprobs?.content&&!i.logprobs_content_done&&(i.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:n.logprobs.content})),n.logprobs?.refusal&&!i.logprobs_refusal_done&&(i.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:n.logprobs.refusal}))},xu=function(){if(this.ended)throw new q("stream has ended, this shouldn't happen");let n=ue(this,jr,"f");if(!n)throw new q("request ended without sending any chunks");return qi(this,jr,void 0,"f"),qi(this,Gi,[],"f"),gC(n,ue(this,pr,"f"))},Kf=function(){let n=ue(this,pr,"f")?.response_format;return jf(n)?n:null},Hm=function(n){var i,o,s,a;let u=ue(this,jr,"f"),f=n,{choices:l}=f,c=fe(f,["choices"]);u?Object.assign(u,c):u=qi(this,jr,_(p({},c),{choices:[]}),"f");for(let b of n.choices){let v=b,{delta:g,finish_reason:A,index:E,logprobs:w=null}=v,x=fe(v,["delta","finish_reason","index","logprobs"]);let C=u.choices[E];if(C||(C=u.choices[E]=p({finish_reason:A,index:E,message:{},logprobs:w},x)),w)if(!C.logprobs)C.logprobs=Object.assign({},w);else{let h=w,{content:Q,refusal:P}=h,k=fe(h,["content","refusal"]);Object.assign(C.logprobs,k),Q&&((i=C.logprobs).content??(i.content=[]),C.logprobs.content.push(...Q)),P&&((o=C.logprobs).refusal??(o.refusal=[]),C.logprobs.refusal.push(...P))}if(A&&(C.finish_reason=A,ue(this,pr,"f")&&Ff(ue(this,pr,"f")))){if(A==="length")throw new Cn;if(A==="content_filter")throw new In}if(Object.assign(C,x),!g)continue;let d=g,{content:O,refusal:T,function_call:M,role:D,tool_calls:z}=d,L=fe(d,["content","refusal","function_call","role","tool_calls"]);if(Object.assign(C.message,L),T&&(C.message.refusal=(C.message.refusal||"")+T),D&&(C.message.role=D),M&&(C.message.function_call?(M.name&&(C.message.function_call.name=M.name),M.arguments&&((s=C.message.function_call).arguments??(s.arguments=""),C.message.function_call.arguments+=M.arguments)):C.message.function_call=M),O&&(C.message.content=(C.message.content||"")+O,!C.message.refusal&&ue(this,Se,"m",Kf).call(this)&&(C.message.parsed=Bf(C.message.content))),z){C.message.tool_calls||(C.message.tool_calls=[]);for(let m of z){let y=m,{index:Q,id:P,type:k,function:S}=y,N=fe(y,["index","id","type","function"]);let U=(a=C.message.tool_calls)[Q]??(a[Q]={});Object.assign(U,N),P&&(U.id=P),k&&(U.type=k),S&&(U.function??(U.function={name:S.name??"",arguments:""})),S?.name&&(U.function.name=S.name),S?.arguments&&(U.function.arguments+=S.arguments,Vm(ue(this,pr,"f"),U)&&(U.function.parsed_arguments=Bf(U.function.arguments)))}}}return u},Symbol.asyncIterator)](){let e=[],n=[],i=!1;return this.on("chunk",o=>{let s=n.shift();s?s.resolve(o):e.push(o)}),this.on("end",()=>{i=!0;for(let o of n)o.resolve(void 0);n.length=0}),this.on("abort",o=>{i=!0;for(let s of n)s.reject(o);n.length=0}),this.on("error",o=>{i=!0;for(let s of n)s.reject(o);n.length=0}),{next:()=>I(this,null,function*(){return e.length?{value:e.shift(),done:!1}:i?{value:void 0,done:!0}:new Promise((s,a)=>n.push({resolve:s,reject:a})).then(s=>s?{value:s,done:!1}:{value:void 0,done:!0})}),return:()=>I(this,null,function*(){return this.abort(),{value:void 0,done:!0}})}}toReadableStream(){return new Bt(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}};function gC(r,e){let c=r,{id:n,choices:i,created:o,model:s,system_fingerprint:a}=c,u=fe(c,["id","choices","created","model","system_fingerprint"]),l=p(_(p({},u),{id:n,choices:i.map(b=>{var v=b,{message:f,finish_reason:h,index:d,logprobs:m}=v,y=fe(v,["message","finish_reason","index","logprobs"]);if(!h)throw new q(`missing finish_reason for choice ${d}`);let C=f,{content:g=null,function_call:A,tool_calls:E}=C,w=fe(C,["content","function_call","tool_calls"]),x=f.role;if(!x)throw new q(`missing role for choice ${d}`);if(A){let{arguments:O,name:T}=A;if(O==null)throw new q(`missing function_call.arguments for choice ${d}`);if(!T)throw new q(`missing function_call.name for choice ${d}`);return _(p({},y),{message:{content:g,function_call:{arguments:O,name:T},role:x,refusal:f.refusal??null},finish_reason:h,index:d,logprobs:m})}return E?_(p({},y),{index:d,finish_reason:h,logprobs:m,message:_(p({},w),{role:x,content:g,refusal:f.refusal??null,tool_calls:E.map((O,T)=>{let S=O,{function:M,type:D,id:z}=S,L=fe(S,["function","type","id"]),N=M||{},{arguments:Q,name:P}=N,k=fe(N,["arguments","name"]);if(z==null)throw new q(`missing choices[${d}].tool_calls[${T}].id
${Au(r)}`);if(D==null)throw new q(`missing choices[${d}].tool_calls[${T}].type
${Au(r)}`);if(P==null)throw new q(`missing choices[${d}].tool_calls[${T}].function.name
${Au(r)}`);if(Q==null)throw new q(`missing choices[${d}].tool_calls[${T}].function.arguments
${Au(r)}`);return _(p({},L),{id:z,type:D,function:_(p({},k),{name:P,arguments:Q})})})})}):_(p({},y),{message:_(p({},w),{content:g,role:x,refusal:f.refusal??null}),finish_reason:h,index:d,logprobs:m})}),created:o,model:s,object:"chat.completion"}),a?{system_fingerprint:a}:{});return Um(l,e)}function Au(r){return JSON.stringify(r)}var ds=class r extends Hi{static fromReadableStream(e){let n=new r(null);return n._run(()=>n._fromReadableStream(e)),n}static runFunctions(e,n,i){let o=new r(null),s=_(p({},i),{headers:_(p({},i?.headers),{"X-Stainless-Helper-Method":"runFunctions"})});return o._run(()=>o._runFunctions(e,n,s)),o}static runTools(e,n,i){let o=new r(n),s=_(p({},i),{headers:_(p({},i?.headers),{"X-Stainless-Helper-Method":"runTools"})});return o._run(()=>o._runTools(e,n,s)),o}};var ps=class extends F{parse(e,n){return I(this,null,function*(){Bm(e.tools);let i=yield this._client.chat.completions.create(e,_(p({},n),{headers:_(p({},n?.headers),{"X-Stainless-Helper-Method":"beta.chat.completions.parse"})}));return fs(i,e)})}runFunctions(e,n){return e.stream?ds.runFunctions(this._client,e,n):hs.runFunctions(this._client,e,n)}runTools(e,n){return e.stream?ds.runTools(this._client,e,n):hs.runTools(this._client,e,n)}stream(e,n){return Hi.createChatCompletion(this._client,e,n)}};var kn=class extends F{constructor(){super(...arguments),this.completions=new ps(this._client)}};(function(r){r.Completions=ps})(kn||(kn={}));var V=function(r,e,n,i){if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?i:n==="a"?i.call(r):i?i.value:e.get(r)},ot=function(r,e,n,i,o){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!o)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!o:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?o.call(r,n):o?o.value=n:e.set(r,n),n},ze,Zf,qt,Cu,Rt,Nn,Wi,Dn,Ou,st,Iu,Eu,ys,ms,gs,Wm,Km,Zm,Xm,Jm,Ym,Qm,Gt=class r extends Ui{constructor(){super(...arguments),ze.add(this),Zf.set(this,[]),qt.set(this,{}),Cu.set(this,{}),Rt.set(this,void 0),Nn.set(this,void 0),Wi.set(this,void 0),Dn.set(this,void 0),Ou.set(this,void 0),st.set(this,void 0),Iu.set(this,void 0),Eu.set(this,void 0),ys.set(this,void 0)}[(Zf=new WeakMap,qt=new WeakMap,Cu=new WeakMap,Rt=new WeakMap,Nn=new WeakMap,Wi=new WeakMap,Dn=new WeakMap,Ou=new WeakMap,st=new WeakMap,Iu=new WeakMap,Eu=new WeakMap,ys=new WeakMap,ze=new WeakSet,Symbol.asyncIterator)](){let e=[],n=[],i=!1;return this.on("event",o=>{let s=n.shift();s?s.resolve(o):e.push(o)}),this.on("end",()=>{i=!0;for(let o of n)o.resolve(void 0);n.length=0}),this.on("abort",o=>{i=!0;for(let s of n)s.reject(o);n.length=0}),this.on("error",o=>{i=!0;for(let s of n)s.reject(o);n.length=0}),{next:()=>I(this,null,function*(){return e.length?{value:e.shift(),done:!1}:i?{value:void 0,done:!0}:new Promise((s,a)=>n.push({resolve:s,reject:a})).then(s=>s?{value:s,done:!1}:{value:void 0,done:!0})}),return:()=>I(this,null,function*(){return this.abort(),{value:void 0,done:!0}})}}static fromReadableStream(e){let n=new r;return n._run(()=>n._fromReadableStream(e)),n}_fromReadableStream(e,n){return I(this,null,function*(){let i=n?.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort())),this._connected();let o=Bt.fromReadableStream(e,this.controller);try{for(var s=te(o),a,u,l;a=!(u=yield s.next()).done;a=!1){let c=u.value;V(this,ze,"m",ms).call(this,c)}}catch{l=[u]}finally{try{a&&(u=s.return)&&(yield u.call(s))}finally{if(l)throw l[0]}}if(o.controller.signal?.aborted)throw new Te;return this._addRun(V(this,ze,"m",gs).call(this))})}toReadableStream(){return new Bt(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,n,i,o,s){let a=new r;return a._run(()=>a._runToolAssistantStream(e,n,i,o,_(p({},s),{headers:_(p({},s?.headers),{"X-Stainless-Helper-Method":"stream"})}))),a}_createToolAssistantStream(e,n,i,o,s){return I(this,null,function*(){let a=s?.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));let u=_(p({},o),{stream:!0}),l=yield e.submitToolOutputs(n,i,u,_(p({},s),{signal:this.controller.signal}));this._connected();try{for(var c=te(l),f,h,d;f=!(h=yield c.next()).done;f=!1){let m=h.value;V(this,ze,"m",ms).call(this,m)}}catch{d=[h]}finally{try{f&&(h=c.return)&&(yield h.call(c))}finally{if(d)throw d[0]}}if(l.controller.signal?.aborted)throw new Te;return this._addRun(V(this,ze,"m",gs).call(this))})}static createThreadAssistantStream(e,n,i){let o=new r;return o._run(()=>o._threadAssistantStream(e,n,_(p({},i),{headers:_(p({},i?.headers),{"X-Stainless-Helper-Method":"stream"})}))),o}static createAssistantStream(e,n,i,o){let s=new r;return s._run(()=>s._runAssistantStream(e,n,i,_(p({},o),{headers:_(p({},o?.headers),{"X-Stainless-Helper-Method":"stream"})}))),s}currentEvent(){return V(this,Iu,"f")}currentRun(){return V(this,Eu,"f")}currentMessageSnapshot(){return V(this,Rt,"f")}currentRunStepSnapshot(){return V(this,ys,"f")}finalRunSteps(){return I(this,null,function*(){return yield this.done(),Object.values(V(this,qt,"f"))})}finalMessages(){return I(this,null,function*(){return yield this.done(),Object.values(V(this,Cu,"f"))})}finalRun(){return I(this,null,function*(){if(yield this.done(),!V(this,Nn,"f"))throw Error("Final run was not received.");return V(this,Nn,"f")})}_createThreadAssistantStream(e,n,i){return I(this,null,function*(){let o=i?.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort()));let s=_(p({},n),{stream:!0}),a=yield e.createAndRun(s,_(p({},i),{signal:this.controller.signal}));this._connected();try{for(var u=te(a),l,c,f;l=!(c=yield u.next()).done;l=!1){let h=c.value;V(this,ze,"m",ms).call(this,h)}}catch{f=[c]}finally{try{l&&(c=u.return)&&(yield c.call(u))}finally{if(f)throw f[0]}}if(a.controller.signal?.aborted)throw new Te;return this._addRun(V(this,ze,"m",gs).call(this))})}_createAssistantStream(e,n,i,o){return I(this,null,function*(){let s=o?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));let a=_(p({},i),{stream:!0}),u=yield e.create(n,a,_(p({},o),{signal:this.controller.signal}));this._connected();try{for(var l=te(u),c,f,h;c=!(f=yield l.next()).done;c=!1){let d=f.value;V(this,ze,"m",ms).call(this,d)}}catch{h=[f]}finally{try{c&&(f=l.return)&&(yield f.call(l))}finally{if(h)throw h[0]}}if(u.controller.signal?.aborted)throw new Te;return this._addRun(V(this,ze,"m",gs).call(this))})}static accumulateDelta(e,n){for(let[i,o]of Object.entries(n)){if(!e.hasOwnProperty(i)){e[i]=o;continue}let s=e[i];if(s==null){e[i]=o;continue}if(i==="index"||i==="type"){e[i]=o;continue}if(typeof s=="string"&&typeof o=="string")s+=o;else if(typeof s=="number"&&typeof o=="number")s+=o;else if(pu(s)&&pu(o))s=this.accumulateDelta(s,o);else if(Array.isArray(s)&&Array.isArray(o)){if(s.every(a=>typeof a=="string"||typeof a=="number")){s.push(...o);continue}}else throw Error(`Unhandled record type: ${i}, deltaValue: ${o}, accValue: ${s}`);e[i]=s}return e}_addRun(e){return e}_threadAssistantStream(e,n,i){return I(this,null,function*(){return yield this._createThreadAssistantStream(n,e,i)})}_runAssistantStream(e,n,i,o){return I(this,null,function*(){return yield this._createAssistantStream(n,e,i,o)})}_runToolAssistantStream(e,n,i,o,s){return I(this,null,function*(){return yield this._createToolAssistantStream(i,e,n,o,s)})}};ms=function(e){if(!this.ended)switch(ot(this,Iu,e,"f"),V(this,ze,"m",Zm).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":V(this,ze,"m",Qm).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":V(this,ze,"m",Km).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":V(this,ze,"m",Wm).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},gs=function(){if(this.ended)throw new q("stream has ended, this shouldn't happen");if(!V(this,Nn,"f"))throw Error("Final run has not been received");return V(this,Nn,"f")},Wm=function(e){let[n,i]=V(this,ze,"m",Jm).call(this,e,V(this,Rt,"f"));ot(this,Rt,n,"f"),V(this,Cu,"f")[n.id]=n;for(let o of i){let s=n.content[o.index];s?.type=="text"&&this._emit("textCreated",s.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,n),e.data.delta.content)for(let o of e.data.delta.content){if(o.type=="text"&&o.text){let s=o.text,a=n.content[o.index];if(a&&a.type=="text")this._emit("textDelta",s,a.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(o.index!=V(this,Wi,"f")){if(V(this,Dn,"f"))switch(V(this,Dn,"f").type){case"text":this._emit("textDone",V(this,Dn,"f").text,V(this,Rt,"f"));break;case"image_file":this._emit("imageFileDone",V(this,Dn,"f").image_file,V(this,Rt,"f"));break}ot(this,Wi,o.index,"f")}ot(this,Dn,n.content[o.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(V(this,Wi,"f")!==void 0){let o=e.data.content[V(this,Wi,"f")];if(o)switch(o.type){case"image_file":this._emit("imageFileDone",o.image_file,V(this,Rt,"f"));break;case"text":this._emit("textDone",o.text,V(this,Rt,"f"));break}}V(this,Rt,"f")&&this._emit("messageDone",e.data),ot(this,Rt,void 0,"f")}},Km=function(e){let n=V(this,ze,"m",Xm).call(this,e);switch(ot(this,ys,n,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":let i=e.data.delta;if(i.step_details&&i.step_details.type=="tool_calls"&&i.step_details.tool_calls&&n.step_details.type=="tool_calls")for(let s of i.step_details.tool_calls)s.index==V(this,Ou,"f")?this._emit("toolCallDelta",s,n.step_details.tool_calls[s.index]):(V(this,st,"f")&&this._emit("toolCallDone",V(this,st,"f")),ot(this,Ou,s.index,"f"),ot(this,st,n.step_details.tool_calls[s.index],"f"),V(this,st,"f")&&this._emit("toolCallCreated",V(this,st,"f")));this._emit("runStepDelta",e.data.delta,n);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":ot(this,ys,void 0,"f"),e.data.step_details.type=="tool_calls"&&V(this,st,"f")&&(this._emit("toolCallDone",V(this,st,"f")),ot(this,st,void 0,"f")),this._emit("runStepDone",e.data,n);break;case"thread.run.step.in_progress":break}},Zm=function(e){V(this,Zf,"f").push(e),this._emit("event",e)},Xm=function(e){switch(e.event){case"thread.run.step.created":return V(this,qt,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let n=V(this,qt,"f")[e.data.id];if(!n)throw Error("Received a RunStepDelta before creation of a snapshot");let i=e.data;if(i.delta){let o=Gt.accumulateDelta(n,i.delta);V(this,qt,"f")[e.data.id]=o}return V(this,qt,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":V(this,qt,"f")[e.data.id]=e.data;break}if(V(this,qt,"f")[e.data.id])return V(this,qt,"f")[e.data.id];throw new Error("No snapshot available")},Jm=function(e,n){let i=[];switch(e.event){case"thread.message.created":return[e.data,i];case"thread.message.delta":if(!n)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let o=e.data;if(o.delta.content)for(let s of o.delta.content)if(s.index in n.content){let a=n.content[s.index];n.content[s.index]=V(this,ze,"m",Ym).call(this,s,a)}else n.content[s.index]=s,i.push(s);return[n,i];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(n)return[n,i];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},Ym=function(e,n){return Gt.accumulateDelta(n,e)},Qm=function(e){switch(ot(this,Eu,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":ot(this,Nn,e.data,"f"),V(this,st,"f")&&(this._emit("toolCallDone",V(this,st,"f")),ot(this,st,void 0,"f"));break;case"thread.run.cancelling":break}};var jn=class extends F{create(e,n,i){return this._client.post(`/threads/${e}/messages`,_(p({body:n},i),{headers:p({"OpenAI-Beta":"assistants=v2"},i?.headers)}))}retrieve(e,n,i){return this._client.get(`/threads/${e}/messages/${n}`,_(p({},i),{headers:p({"OpenAI-Beta":"assistants=v2"},i?.headers)}))}update(e,n,i,o){return this._client.post(`/threads/${e}/messages/${n}`,_(p({body:i},o),{headers:p({"OpenAI-Beta":"assistants=v2"},o?.headers)}))}list(e,n={},i){return ye(n)?this.list(e,{},n):this._client.getAPIList(`/threads/${e}/messages`,Fn,_(p({query:n},i),{headers:p({"OpenAI-Beta":"assistants=v2"},i?.headers)}))}del(e,n,i){return this._client.delete(`/threads/${e}/messages/${n}`,_(p({},i),{headers:p({"OpenAI-Beta":"assistants=v2"},i?.headers)}))}},Fn=class extends be{};(function(r){r.MessagesPage=Fn})(jn||(jn={}));var zn=class extends F{retrieve(e,n,i,o){return this._client.get(`/threads/${e}/runs/${n}/steps/${i}`,_(p({},o),{headers:p({"OpenAI-Beta":"assistants=v2"},o?.headers)}))}list(e,n,i={},o){return ye(i)?this.list(e,n,{},i):this._client.getAPIList(`/threads/${e}/runs/${n}/steps`,$n,_(p({query:i},o),{headers:p({"OpenAI-Beta":"assistants=v2"},o?.headers)}))}},$n=class extends be{};(function(r){r.RunStepsPage=$n})(zn||(zn={}));var Ln=class extends F{constructor(){super(...arguments),this.steps=new zn(this._client)}create(e,n,i){return this._client.post(`/threads/${e}/runs`,_(p({body:n},i),{headers:p({"OpenAI-Beta":"assistants=v2"},i?.headers),stream:n.stream??!1}))}retrieve(e,n,i){return this._client.get(`/threads/${e}/runs/${n}`,_(p({},i),{headers:p({"OpenAI-Beta":"assistants=v2"},i?.headers)}))}update(e,n,i,o){return this._client.post(`/threads/${e}/runs/${n}`,_(p({body:i},o),{headers:p({"OpenAI-Beta":"assistants=v2"},o?.headers)}))}list(e,n={},i){return ye(n)?this.list(e,{},n):this._client.getAPIList(`/threads/${e}/runs`,Un,_(p({query:n},i),{headers:p({"OpenAI-Beta":"assistants=v2"},i?.headers)}))}cancel(e,n,i){return this._client.post(`/threads/${e}/runs/${n}/cancel`,_(p({},i),{headers:p({"OpenAI-Beta":"assistants=v2"},i?.headers)}))}createAndPoll(e,n,i){return I(this,null,function*(){let o=yield this.create(e,n,i);return yield this.poll(e,o.id,i)})}createAndStream(e,n,i){return Gt.createAssistantStream(e,this._client.beta.threads.runs,n,i)}poll(e,n,i){return I(this,null,function*(){let o=_(p({},i?.headers),{"X-Stainless-Poll-Helper":"true"});for(i?.pollIntervalMs&&(o["X-Stainless-Custom-Poll-Interval"]=i.pollIntervalMs.toString());;){let{data:s,response:a}=yield this.retrieve(e,n,_(p({},i),{headers:p(p({},i?.headers),o)})).withResponse();switch(s.status){case"queued":case"in_progress":case"cancelling":let u=5e3;if(i?.pollIntervalMs)u=i.pollIntervalMs;else{let l=a.headers.get("openai-poll-after-ms");if(l){let c=parseInt(l);isNaN(c)||(u=c)}}yield cr(u);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return s}}})}stream(e,n,i){return Gt.createAssistantStream(e,this._client.beta.threads.runs,n,i)}submitToolOutputs(e,n,i,o){return this._client.post(`/threads/${e}/runs/${n}/submit_tool_outputs`,_(p({body:i},o),{headers:p({"OpenAI-Beta":"assistants=v2"},o?.headers),stream:i.stream??!1}))}submitToolOutputsAndPoll(e,n,i,o){return I(this,null,function*(){let s=yield this.submitToolOutputs(e,n,i,o);return yield this.poll(e,s.id,o)})}submitToolOutputsStream(e,n,i,o){return Gt.createToolAssistantStream(e,n,this._client.beta.threads.runs,i,o)}},Un=class extends be{};(function(r){r.RunsPage=Un,r.Steps=zn,r.RunStepsPage=$n})(Ln||(Ln={}));var Vn=class extends F{constructor(){super(...arguments),this.runs=new Ln(this._client),this.messages=new jn(this._client)}create(e={},n){return ye(e)?this.create({},e):this._client.post("/threads",_(p({body:e},n),{headers:p({"OpenAI-Beta":"assistants=v2"},n?.headers)}))}retrieve(e,n){return this._client.get(`/threads/${e}`,_(p({},n),{headers:p({"OpenAI-Beta":"assistants=v2"},n?.headers)}))}update(e,n,i){return this._client.post(`/threads/${e}`,_(p({body:n},i),{headers:p({"OpenAI-Beta":"assistants=v2"},i?.headers)}))}del(e,n){return this._client.delete(`/threads/${e}`,_(p({},n),{headers:p({"OpenAI-Beta":"assistants=v2"},n?.headers)}))}createAndRun(e,n){return this._client.post("/threads/runs",_(p({body:e},n),{headers:p({"OpenAI-Beta":"assistants=v2"},n?.headers),stream:e.stream??!1}))}createAndRunPoll(e,n){return I(this,null,function*(){let i=yield this.createAndRun(e,n);return yield this.runs.poll(i.thread_id,i.id,n)})}createAndRunStream(e,n){return Gt.createThreadAssistantStream(e,this._client.beta.threads,n)}};(function(r){r.Runs=Ln,r.RunsPage=Un,r.Messages=jn,r.MessagesPage=Fn})(Vn||(Vn={}));var ng=r=>I(void 0,null,function*(){let e=yield Promise.allSettled(r),n=e.filter(o=>o.status==="rejected");if(n.length){for(let o of n)console.error(o.reason);throw new Error(`${n.length} promise(s) failed - see the above errors`)}let i=[];for(let o of e)o.status==="fulfilled"&&i.push(o.value);return i});var Bn=class extends F{create(e,n,i){return this._client.post(`/vector_stores/${e}/files`,_(p({body:n},i),{headers:p({"OpenAI-Beta":"assistants=v2"},i?.headers)}))}retrieve(e,n,i){return this._client.get(`/vector_stores/${e}/files/${n}`,_(p({},i),{headers:p({"OpenAI-Beta":"assistants=v2"},i?.headers)}))}list(e,n={},i){return ye(n)?this.list(e,{},n):this._client.getAPIList(`/vector_stores/${e}/files`,mr,_(p({query:n},i),{headers:p({"OpenAI-Beta":"assistants=v2"},i?.headers)}))}del(e,n,i){return this._client.delete(`/vector_stores/${e}/files/${n}`,_(p({},i),{headers:p({"OpenAI-Beta":"assistants=v2"},i?.headers)}))}createAndPoll(e,n,i){return I(this,null,function*(){let o=yield this.create(e,n,i);return yield this.poll(e,o.id,i)})}poll(e,n,i){return I(this,null,function*(){let o=_(p({},i?.headers),{"X-Stainless-Poll-Helper":"true"});for(i?.pollIntervalMs&&(o["X-Stainless-Custom-Poll-Interval"]=i.pollIntervalMs.toString());;){let s=yield this.retrieve(e,n,_(p({},i),{headers:o})).withResponse(),a=s.data;switch(a.status){case"in_progress":let u=5e3;if(i?.pollIntervalMs)u=i.pollIntervalMs;else{let l=s.response.headers.get("openai-poll-after-ms");if(l){let c=parseInt(l);isNaN(c)||(u=c)}}yield cr(u);break;case"failed":case"completed":return a}}})}upload(e,n,i){return I(this,null,function*(){let o=yield this._client.files.create({file:n,purpose:"assistants"},i);return this.create(e,{file_id:o.id},i)})}uploadAndPoll(e,n,i){return I(this,null,function*(){let o=yield this.upload(e,n,i);return yield this.poll(e,o.id,i)})}},mr=class extends be{};(function(r){r.VectorStoreFilesPage=mr})(Bn||(Bn={}));var qn=class extends F{create(e,n,i){return this._client.post(`/vector_stores/${e}/file_batches`,_(p({body:n},i),{headers:p({"OpenAI-Beta":"assistants=v2"},i?.headers)}))}retrieve(e,n,i){return this._client.get(`/vector_stores/${e}/file_batches/${n}`,_(p({},i),{headers:p({"OpenAI-Beta":"assistants=v2"},i?.headers)}))}cancel(e,n,i){return this._client.post(`/vector_stores/${e}/file_batches/${n}/cancel`,_(p({},i),{headers:p({"OpenAI-Beta":"assistants=v2"},i?.headers)}))}createAndPoll(e,n,i){return I(this,null,function*(){let o=yield this.create(e,n);return yield this.poll(e,o.id,i)})}listFiles(e,n,i={},o){return ye(i)?this.listFiles(e,n,{},i):this._client.getAPIList(`/vector_stores/${e}/file_batches/${n}/files`,mr,_(p({query:i},o),{headers:p({"OpenAI-Beta":"assistants=v2"},o?.headers)}))}poll(e,n,i){return I(this,null,function*(){let o=_(p({},i?.headers),{"X-Stainless-Poll-Helper":"true"});for(i?.pollIntervalMs&&(o["X-Stainless-Custom-Poll-Interval"]=i.pollIntervalMs.toString());;){let{data:s,response:a}=yield this.retrieve(e,n,_(p({},i),{headers:o})).withResponse();switch(s.status){case"in_progress":let u=5e3;if(i?.pollIntervalMs)u=i.pollIntervalMs;else{let l=a.headers.get("openai-poll-after-ms");if(l){let c=parseInt(l);isNaN(c)||(u=c)}}yield cr(u);break;case"failed":case"cancelled":case"completed":return s}}})}uploadAndPoll(s,a,u){return I(this,arguments,function*(e,{files:n,fileIds:i=[]},o){if(n==null||n.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");let l=o?.maxConcurrency??5,c=Math.min(l,n.length),f=this._client,h=n.values(),d=[...i];function m(b){return I(this,null,function*(){for(let v of b){let g=yield f.files.create({file:v,purpose:"assistants"},o);d.push(g.id)}})}let y=Array(c).fill(h).map(m);return yield ng(y),yield this.createAndPoll(e,{file_ids:d})})}};qn||(qn={});var Gn=class extends F{constructor(){super(...arguments),this.files=new Bn(this._client),this.fileBatches=new qn(this._client)}create(e,n){return this._client.post("/vector_stores",_(p({body:e},n),{headers:p({"OpenAI-Beta":"assistants=v2"},n?.headers)}))}retrieve(e,n){return this._client.get(`/vector_stores/${e}`,_(p({},n),{headers:p({"OpenAI-Beta":"assistants=v2"},n?.headers)}))}update(e,n,i){return this._client.post(`/vector_stores/${e}`,_(p({body:n},i),{headers:p({"OpenAI-Beta":"assistants=v2"},i?.headers)}))}list(e={},n){return ye(e)?this.list({},e):this._client.getAPIList("/vector_stores",Hn,_(p({query:e},n),{headers:p({"OpenAI-Beta":"assistants=v2"},n?.headers)}))}del(e,n){return this._client.delete(`/vector_stores/${e}`,_(p({},n),{headers:p({"OpenAI-Beta":"assistants=v2"},n?.headers)}))}},Hn=class extends be{};(function(r){r.VectorStoresPage=Hn,r.Files=Bn,r.VectorStoreFilesPage=mr,r.FileBatches=qn})(Gn||(Gn={}));var Fr=class extends F{constructor(){super(...arguments),this.vectorStores=new Gn(this._client),this.chat=new kn(this._client),this.assistants=new Sn(this._client),this.threads=new Vn(this._client)}};(function(r){r.VectorStores=Gn,r.VectorStoresPage=Hn,r.Chat=kn,r.Assistants=Sn,r.AssistantsPage=Rn,r.Threads=Vn})(Fr||(Fr={}));var zr=class extends F{create(e,n){return this._client.post("/completions",_(p({body:e},n),{stream:e.stream??!1}))}};zr||(zr={});var $r=class extends F{create(e,n){return this._client.post("/embeddings",p({body:e},n))}};$r||($r={});var Lr=class extends F{create(e,n){return this._client.post("/files",mt(p({body:e},n)))}retrieve(e,n){return this._client.get(`/files/${e}`,n)}list(e={},n){return ye(e)?this.list({},e):this._client.getAPIList("/files",Ur,p({query:e},n))}del(e,n){return this._client.delete(`/files/${e}`,n)}content(e,n){return this._client.get(`/files/${e}/content`,_(p({},n),{__binaryResponse:!0}))}retrieveContent(e,n){return this._client.get(`/files/${e}/content`,_(p({},n),{headers:p({Accept:"application/json"},n?.headers)}))}waitForProcessing(o){return I(this,arguments,function*(e,{pollInterval:n=5e3,maxWait:i=30*60*1e3}={}){let s=new Set(["processed","error","deleted"]),a=Date.now(),u=yield this.retrieve(e);for(;!u.status||!s.has(u.status);)if(yield cr(n),u=yield this.retrieve(e),Date.now()-a>i)throw new hr({message:`Giving up on waiting for file ${e} to finish processing after ${i} milliseconds.`});return u})}},Ur=class extends Sr{};(function(r){r.FileObjectsPage=Ur})(Lr||(Lr={}));var Wn=class extends F{list(e,n={},i){return ye(n)?this.list(e,{},n):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,Kn,p({query:n},i))}},Kn=class extends be{};(function(r){r.FineTuningJobCheckpointsPage=Kn})(Wn||(Wn={}));var Zn=class extends F{constructor(){super(...arguments),this.checkpoints=new Wn(this._client)}create(e,n){return this._client.post("/fine_tuning/jobs",p({body:e},n))}retrieve(e,n){return this._client.get(`/fine_tuning/jobs/${e}`,n)}list(e={},n){return ye(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",Xn,p({query:e},n))}cancel(e,n){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,n)}listEvents(e,n={},i){return ye(n)?this.listEvents(e,{},n):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,Jn,p({query:n},i))}},Xn=class extends be{},Jn=class extends be{};(function(r){r.FineTuningJobsPage=Xn,r.FineTuningJobEventsPage=Jn,r.Checkpoints=Wn,r.FineTuningJobCheckpointsPage=Kn})(Zn||(Zn={}));var Vr=class extends F{constructor(){super(...arguments),this.jobs=new Zn(this._client)}};(function(r){r.Jobs=Zn,r.FineTuningJobsPage=Xn,r.FineTuningJobEventsPage=Jn})(Vr||(Vr={}));var Br=class extends F{createVariation(e,n){return this._client.post("/images/variations",mt(p({body:e},n)))}edit(e,n){return this._client.post("/images/edits",mt(p({body:e},n)))}generate(e,n){return this._client.post("/images/generations",p({body:e},n))}};Br||(Br={});var qr=class extends F{retrieve(e,n){return this._client.get(`/models/${e}`,n)}list(e){return this._client.getAPIList("/models",Gr,e)}del(e,n){return this._client.delete(`/models/${e}`,n)}},Gr=class extends Sr{};(function(r){r.ModelsPage=Gr})(qr||(qr={}));var Hr=class extends F{create(e,n){return this._client.post("/moderations",p({body:e},n))}};Hr||(Hr={});var Yn=class extends F{create(e,n,i){return this._client.post(`/uploads/${e}/parts`,mt(p({body:n},i)))}};Yn||(Yn={});var Wr=class extends F{constructor(){super(...arguments),this.parts=new Yn(this._client)}create(e,n){return this._client.post("/uploads",p({body:e},n))}cancel(e,n){return this._client.post(`/uploads/${e}/cancel`,n)}complete(e,n,i){return this._client.post(`/uploads/${e}/complete`,p({body:n},i))}};(function(r){r.Parts=Yn})(Wr||(Wr={}));var ug,ge=class extends hu{constructor(a={}){var u=a,{baseURL:e=ss("OPENAI_BASE_URL"),apiKey:n=ss("OPENAI_API_KEY"),organization:i=ss("OPENAI_ORG_ID")??null,project:o=ss("OPENAI_PROJECT_ID")??null}=u,s=fe(u,["baseURL","apiKey","organization","project"]);if(n===void 0)throw new q("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");let l=_(p({apiKey:n,organization:i,project:o},s),{baseURL:e||"https://api.openai.com/v1"});if(!l.dangerouslyAllowBrowser&&jm())throw new q(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:l.baseURL,timeout:l.timeout??6e5,httpAgent:l.httpAgent,maxRetries:l.maxRetries,fetch:l.fetch}),this.completions=new zr(this),this.chat=new Rr(this),this.embeddings=new $r(this),this.files=new Lr(this),this.images=new Br(this),this.audio=new Mr(this),this.moderations=new Hr(this),this.models=new qr(this),this.fineTuning=new Vr(this),this.beta=new Fr(this),this.batches=new kr(this),this.uploads=new Wr(this),this._options=l,this.apiKey=n,this.organization=i,this.project=o}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return p(_(p({},super.defaultHeaders(e)),{"OpenAI-Organization":this.organization,"OpenAI-Project":this.project}),this._options.defaultHeaders)}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}};ug=ge;ge.OpenAI=ug;ge.DEFAULT_TIMEOUT=6e5;ge.OpenAIError=q;ge.APIError=Oe;ge.APIConnectionError=fr;ge.APIConnectionTimeoutError=hr;ge.APIUserAbortError=Te;ge.NotFoundError=Ni;ge.ConflictError=ji;ge.RateLimitError=zi;ge.BadRequestError=Mi;ge.AuthenticationError=ki;ge.InternalServerError=$i;ge.PermissionDeniedError=Di;ge.UnprocessableEntityError=Fi;ge.toFile=Of;ge.fileFromPath=au;var{OpenAIError:UD,APIError:VD,APIConnectionError:BD,APIConnectionTimeoutError:lg,APIUserAbortError:cg,NotFoundError:qD,ConflictError:GD,RateLimitError:HD,BadRequestError:WD,AuthenticationError:KD,InternalServerError:ZD,PermissionDeniedError:XD,UnprocessableEntityError:JD}=Rf;(function(r){r.Page=Sr,r.CursorPage=be,r.Completions=zr,r.Chat=Rr,r.Embeddings=$r,r.Files=Lr,r.FileObjectsPage=Ur,r.Images=Br,r.Audio=Mr,r.Moderations=Hr,r.Models=qr,r.ModelsPage=Gr,r.FineTuning=Vr,r.Beta=Fr,r.Batches=kr,r.BatchesPage=Dr,r.Uploads=Wr})(ge||(ge={}));var IC=typeof window=="object"?window:{},ee="0123456789abcdef".split(""),EC=[-2147483648,8388608,32768,128],Mt=[24,16,8,0];var Me=[];function kt(r){r?(Me[0]=Me[16]=Me[1]=Me[2]=Me[3]=Me[4]=Me[5]=Me[6]=Me[7]=Me[8]=Me[9]=Me[10]=Me[11]=Me[12]=Me[13]=Me[14]=Me[15]=0,this.blocks=Me):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.h0=1732584193,this.h1=4023233417,this.h2=2562383102,this.h3=271733878,this.h4=3285377520,this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}kt.prototype.update=function(r){if(!this.finalized){var e=typeof r!="string";e&&r.constructor===IC.ArrayBuffer&&(r=new Uint8Array(r));for(var n,i=0,o,s=r.length||0,a=this.blocks;i<s;){if(this.hashed&&(this.hashed=!1,a[0]=this.block,a[16]=a[1]=a[2]=a[3]=a[4]=a[5]=a[6]=a[7]=a[8]=a[9]=a[10]=a[11]=a[12]=a[13]=a[14]=a[15]=0),e)for(o=this.start;i<s&&o<64;++i)a[o>>2]|=r[i]<<Mt[o++&3];else for(o=this.start;i<s&&o<64;++i)n=r.charCodeAt(i),n<128?a[o>>2]|=n<<Mt[o++&3]:n<2048?(a[o>>2]|=(192|n>>6)<<Mt[o++&3],a[o>>2]|=(128|n&63)<<Mt[o++&3]):n<55296||n>=57344?(a[o>>2]|=(224|n>>12)<<Mt[o++&3],a[o>>2]|=(128|n>>6&63)<<Mt[o++&3],a[o>>2]|=(128|n&63)<<Mt[o++&3]):(n=65536+((n&1023)<<10|r.charCodeAt(++i)&1023),a[o>>2]|=(240|n>>18)<<Mt[o++&3],a[o>>2]|=(128|n>>12&63)<<Mt[o++&3],a[o>>2]|=(128|n>>6&63)<<Mt[o++&3],a[o>>2]|=(128|n&63)<<Mt[o++&3]);this.lastByteIndex=o,this.bytes+=o-this.start,o>=64?(this.block=a[16],this.start=o-64,this.hash(),this.hashed=!0):this.start=o}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}};kt.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var r=this.blocks,e=this.lastByteIndex;r[16]=this.block,r[e>>2]|=EC[e&3],this.block=r[16],e>=56&&(this.hashed||this.hash(),r[0]=this.block,r[16]=r[1]=r[2]=r[3]=r[4]=r[5]=r[6]=r[7]=r[8]=r[9]=r[10]=r[11]=r[12]=r[13]=r[14]=r[15]=0),r[14]=this.hBytes<<3|this.bytes>>>29,r[15]=this.bytes<<3,this.hash()}};kt.prototype.hash=function(){var r=this.h0,e=this.h1,n=this.h2,i=this.h3,o=this.h4,s,a,u,l=this.blocks;for(a=16;a<80;++a)u=l[a-3]^l[a-8]^l[a-14]^l[a-16],l[a]=u<<1|u>>>31;for(a=0;a<20;a+=5)s=e&n|~e&i,u=r<<5|r>>>27,o=u+s+o+1518500249+l[a]<<0,e=e<<30|e>>>2,s=r&e|~r&n,u=o<<5|o>>>27,i=u+s+i+1518500249+l[a+1]<<0,r=r<<30|r>>>2,s=o&r|~o&e,u=i<<5|i>>>27,n=u+s+n+1518500249+l[a+2]<<0,o=o<<30|o>>>2,s=i&o|~i&r,u=n<<5|n>>>27,e=u+s+e+1518500249+l[a+3]<<0,i=i<<30|i>>>2,s=n&i|~n&o,u=e<<5|e>>>27,r=u+s+r+1518500249+l[a+4]<<0,n=n<<30|n>>>2;for(;a<40;a+=5)s=e^n^i,u=r<<5|r>>>27,o=u+s+o+1859775393+l[a]<<0,e=e<<30|e>>>2,s=r^e^n,u=o<<5|o>>>27,i=u+s+i+1859775393+l[a+1]<<0,r=r<<30|r>>>2,s=o^r^e,u=i<<5|i>>>27,n=u+s+n+1859775393+l[a+2]<<0,o=o<<30|o>>>2,s=i^o^r,u=n<<5|n>>>27,e=u+s+e+1859775393+l[a+3]<<0,i=i<<30|i>>>2,s=n^i^o,u=e<<5|e>>>27,r=u+s+r+1859775393+l[a+4]<<0,n=n<<30|n>>>2;for(;a<60;a+=5)s=e&n|e&i|n&i,u=r<<5|r>>>27,o=u+s+o-1894007588+l[a]<<0,e=e<<30|e>>>2,s=r&e|r&n|e&n,u=o<<5|o>>>27,i=u+s+i-1894007588+l[a+1]<<0,r=r<<30|r>>>2,s=o&r|o&e|r&e,u=i<<5|i>>>27,n=u+s+n-1894007588+l[a+2]<<0,o=o<<30|o>>>2,s=i&o|i&r|o&r,u=n<<5|n>>>27,e=u+s+e-1894007588+l[a+3]<<0,i=i<<30|i>>>2,s=n&i|n&o|i&o,u=e<<5|e>>>27,r=u+s+r-1894007588+l[a+4]<<0,n=n<<30|n>>>2;for(;a<80;a+=5)s=e^n^i,u=r<<5|r>>>27,o=u+s+o-899497514+l[a]<<0,e=e<<30|e>>>2,s=r^e^n,u=o<<5|o>>>27,i=u+s+i-899497514+l[a+1]<<0,r=r<<30|r>>>2,s=o^r^e,u=i<<5|i>>>27,n=u+s+n-899497514+l[a+2]<<0,o=o<<30|o>>>2,s=i^o^r,u=n<<5|n>>>27,e=u+s+e-899497514+l[a+3]<<0,i=i<<30|i>>>2,s=n^i^o,u=e<<5|e>>>27,r=u+s+r-899497514+l[a+4]<<0,n=n<<30|n>>>2;this.h0=this.h0+r<<0,this.h1=this.h1+e<<0,this.h2=this.h2+n<<0,this.h3=this.h3+i<<0,this.h4=this.h4+o<<0};kt.prototype.hex=function(){this.finalize();var r=this.h0,e=this.h1,n=this.h2,i=this.h3,o=this.h4;return ee[r>>28&15]+ee[r>>24&15]+ee[r>>20&15]+ee[r>>16&15]+ee[r>>12&15]+ee[r>>8&15]+ee[r>>4&15]+ee[r&15]+ee[e>>28&15]+ee[e>>24&15]+ee[e>>20&15]+ee[e>>16&15]+ee[e>>12&15]+ee[e>>8&15]+ee[e>>4&15]+ee[e&15]+ee[n>>28&15]+ee[n>>24&15]+ee[n>>20&15]+ee[n>>16&15]+ee[n>>12&15]+ee[n>>8&15]+ee[n>>4&15]+ee[n&15]+ee[i>>28&15]+ee[i>>24&15]+ee[i>>20&15]+ee[i>>16&15]+ee[i>>12&15]+ee[i>>8&15]+ee[i>>4&15]+ee[i&15]+ee[o>>28&15]+ee[o>>24&15]+ee[o>>20&15]+ee[o>>16&15]+ee[o>>12&15]+ee[o>>8&15]+ee[o>>4&15]+ee[o&15]};kt.prototype.toString=kt.prototype.hex;kt.prototype.digest=function(){this.finalize();var r=this.h0,e=this.h1,n=this.h2,i=this.h3,o=this.h4;return[r>>24&255,r>>16&255,r>>8&255,r&255,e>>24&255,e>>16&255,e>>8&255,e&255,n>>24&255,n>>16&255,n>>8&255,n&255,i>>24&255,i>>16&255,i>>8&255,i&255,o>>24&255,o>>16&255,o>>8&255,o&255]};kt.prototype.array=kt.prototype.digest;kt.prototype.arrayBuffer=function(){this.finalize();var r=new ArrayBuffer(20),e=new DataView(r);return e.setUint32(0,this.h0),e.setUint32(4,this.h1),e.setUint32(8,this.h2),e.setUint32(12,this.h3),e.setUint32(16,this.h4),r};var Xf=r=>new kt(!0).update(r).hex();var fg=(...r)=>Xf(r.join("_"));var Jf=class{},OC=new Map,Pu=class r extends Jf{constructor(e){super(),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cache=e??new Map}lookup(e,n){return Promise.resolve(this.cache.get(fg(e,n))??null)}update(e,n,i){return I(this,null,function*(){this.cache.set(fg(e,n),i)})}static global(){return new r(OC)}};var mg=G_(pg(),1);var NC=Object.defineProperty,jC=(r,e,n)=>e in r?NC(r,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[e]=n,FC=(r,e,n)=>(jC(r,typeof e!="symbol"?e+"":e,n),n);function zC(r,e){let n=Array.from({length:r.length},(i,o)=>({start:o,end:o+1}));for(;n.length>1;){let i=null;for(let o=0;o<n.length-1;o++){let s=r.slice(n[o].start,n[o+1].end),a=e.get(s.join(","));a!=null&&(i==null||a<i[0])&&(i=[a,o])}if(i!=null){let o=i[1];n[o]={start:n[o].start,end:n[o+1].end},n.splice(o+1,1)}else break}return n}function $C(r,e){return r.length===1?[e.get(r.join(","))]:zC(r,e).map(n=>e.get(r.slice(n.start,n.end).join(","))).filter(n=>n!=null)}function LC(r){return r.replace(/[\\^$*+?.()|[\]{}]/g,"\\$&")}var Qf=class{specialTokens;inverseSpecialTokens;patStr;textEncoder=new TextEncoder;textDecoder=new TextDecoder("utf-8");rankMap=new Map;textMap=new Map;constructor(r,e){this.patStr=r.pat_str;let n=r.bpe_ranks.split(`
`).filter(Boolean).reduce((i,o)=>{let[s,a,...u]=o.split(" "),l=Number.parseInt(a,10);return u.forEach((c,f)=>i[c]=l+f),i},{});for(let[i,o]of Object.entries(n)){let s=mg.default.toByteArray(i);this.rankMap.set(s.join(","),o),this.textMap.set(o,s)}this.specialTokens=p(p({},r.special_tokens),e),this.inverseSpecialTokens=Object.entries(this.specialTokens).reduce((i,[o,s])=>(i[s]=this.textEncoder.encode(o),i),{})}encode(r,e=[],n="all"){let i=new RegExp(this.patStr,"ug"),o=Qf.specialTokenRegex(Object.keys(this.specialTokens)),s=[],a=new Set(e==="all"?Object.keys(this.specialTokens):e),u=new Set(n==="all"?Object.keys(this.specialTokens).filter(c=>!a.has(c)):n);if(u.size>0){let c=Qf.specialTokenRegex([...u]),f=r.match(c);if(f!=null)throw new Error(`The text contains a special token that is not allowed: ${f[0]}`)}let l=0;for(;;){let c=null,f=l;for(;o.lastIndex=f,c=o.exec(r),!(c==null||a.has(c[0]));)f=c.index+1;let h=c?.index??r.length;for(let m of r.substring(l,h).matchAll(i)){let y=this.textEncoder.encode(m[0]),b=this.rankMap.get(y.join(","));if(b!=null){s.push(b);continue}s.push(...$C(y,this.rankMap))}if(c==null)break;let d=this.specialTokens[c[0]];s.push(d),l=c.index+c[0].length}return s}decode(r){let e=[],n=0;for(let s=0;s<r.length;++s){let a=r[s],u=this.textMap.get(a)??this.inverseSpecialTokens[a];u!=null&&(e.push(u),n+=u.length)}let i=new Uint8Array(n),o=0;for(let s of e)i.set(s,o),o+=s.length;return this.textDecoder.decode(i)}},Su=Qf;FC(Su,"specialTokenRegex",r=>new RegExp(r.map(e=>LC(e)).join("|"),"g"));function eh(r){switch(r){case"gpt2":return"gpt2";case"code-cushman-001":case"code-cushman-002":case"code-davinci-001":case"code-davinci-002":case"cushman-codex":case"davinci-codex":case"davinci-002":case"text-davinci-002":case"text-davinci-003":return"p50k_base";case"code-davinci-edit-001":case"text-davinci-edit-001":return"p50k_edit";case"ada":case"babbage":case"babbage-002":case"code-search-ada-code-001":case"code-search-babbage-code-001":case"curie":case"davinci":case"text-ada-001":case"text-babbage-001":case"text-curie-001":case"text-davinci-001":case"text-search-ada-doc-001":case"text-search-babbage-doc-001":case"text-search-curie-doc-001":case"text-search-davinci-doc-001":case"text-similarity-ada-001":case"text-similarity-babbage-001":case"text-similarity-curie-001":case"text-similarity-davinci-001":return"r50k_base";case"gpt-3.5-turbo-instruct-0914":case"gpt-3.5-turbo-instruct":case"gpt-3.5-turbo-16k-0613":case"gpt-3.5-turbo-16k":case"gpt-3.5-turbo-0613":case"gpt-3.5-turbo-0301":case"gpt-3.5-turbo":case"gpt-4-32k-0613":case"gpt-4-32k-0314":case"gpt-4-32k":case"gpt-4-0613":case"gpt-4-0314":case"gpt-4":case"gpt-3.5-turbo-1106":case"gpt-35-turbo":case"gpt-4-1106-preview":case"gpt-4-vision-preview":case"gpt-3.5-turbo-0125":case"gpt-4-turbo":case"gpt-4-turbo-2024-04-09":case"gpt-4-turbo-preview":case"gpt-4-0125-preview":case"text-embedding-ada-002":case"text-embedding-3-small":case"text-embedding-3-large":return"cl100k_base";case"gpt-4o":case"gpt-4o-2024-05-13":case"gpt-4o-2024-08-06":case"gpt-4o-mini-2024-07-18":case"gpt-4o-mini":return"o200k_base";default:throw new Error("Unknown model")}}var Ru={},UC=new So({});function VC(r){return I(this,null,function*(){return r in Ru||(Ru[r]=UC.fetch(`https://tiktoken.pages.dev/js/${r}.json`).then(e=>e.json()).then(e=>new Su(e)).catch(e=>{throw delete Ru[r],e})),yield Ru[r]})}function gg(r){return I(this,null,function*(){return VC(eh(r))})}var BC=r=>r.startsWith("gpt-3.5-turbo-16k")?"gpt-3.5-turbo-16k":r.startsWith("gpt-3.5-turbo-")?"gpt-3.5-turbo":r.startsWith("gpt-4-32k")?"gpt-4-32k":r.startsWith("gpt-4-")?"gpt-4":r.startsWith("gpt-4o")?"gpt-4o":r;function yg(r){return typeof r!="object"||!r?!1:!!("type"in r&&r.type==="function"&&"function"in r&&typeof r.function=="object"&&r.function&&"name"in r.function&&"parameters"in r.function)}var qC=()=>!1,vs=class extends Pt{get lc_attributes(){return{callbacks:void 0,verbose:void 0}}constructor(e){super(e),Object.defineProperty(this,"verbose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.verbose=e.verbose??qC(),this.callbacks=e.callbacks,this.tags=e.tags??[],this.metadata=e.metadata??{}}},bs=class extends vs{get callKeys(){return["stop","timeout","signal","tags","metadata","callbacks"]}constructor(o){var s=o,{callbacks:e,callbackManager:n}=s,i=fe(s,["callbacks","callbackManager"]);super(p({callbacks:e??n},i)),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_encoding",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof i.cache=="object"?this.cache=i.cache:i.cache?this.cache=Pu.global():this.cache=void 0,this.caller=new So(i??{})}getNumTokens(e){return I(this,null,function*(){if(typeof e!="string")return 0;let n=Math.ceil(e.length/4);if(!this._encoding)try{this._encoding=yield gg("modelName"in this?BC(this.modelName):"gpt2")}catch(i){console.warn("Failed to calculate number of tokens, falling back to approximate count",i)}if(this._encoding)try{n=this._encoding.encode(e).length}catch(i){console.warn("Failed to calculate number of tokens, falling back to approximate count",i)}return n})}static _convertInputToPromptValue(e){return typeof e=="string"?new gp(e):Array.isArray(e)?new yp(e.map(dn)):e}_identifyingParams(){return{}}_getSerializedCacheKeyParametersForCall(i){var o=i,{config:e}=o,n=fe(o,["config"]);let s=_(p(p({},this._identifyingParams()),n),{_type:this._llmType(),_model:this._modelType()});return Object.entries(s).filter(([l,c])=>c!==void 0).map(([l,c])=>`${l}:${JSON.stringify(c)}`).sort().join(",")}serialize(){return _(p({},this._identifyingParams()),{_type:this._llmType(),_model:this._modelType()})}static deserialize(e){return I(this,null,function*(){throw new Error("Use .toJSON() instead")})}};var Wt=class extends Pt{static lc_name(){return"RunnablePassthrough"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e&&(this.func=e.func)}invoke(e,n){return I(this,null,function*(){let i=gn(n);return this.func&&(yield this.func(e,i)),this._callWithConfig(o=>Promise.resolve(o),e,i)})}transform(e,n){return he(this,null,function*(){let i=gn(n),o,s=!0;try{for(var a=te(this._transformStreamWithConfig(e,h=>h,i)),u,l,c;u=!(l=yield new G(a.next())).done;u=!1){let f=l.value;if(yield f,s)if(o===void 0)o=f;else try{o=bi(o,f)}catch{o=void 0,s=!1}}}catch{c=[l]}finally{try{u&&(l=a.return)&&(yield new G(l.call(a)))}finally{if(c)throw c[0]}}this.func&&o!==void 0&&(yield new G(this.func(o,i)))})}static assign(e){return new gc(new mc({steps:e}))}};function _s(r){return typeof r?.parse=="function"}var Mu=class r extends bs{constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models",this._llmType()]})}_separateRunnableConfigFromCallOptionsCompat(e){let[n,i]=super._separateRunnableConfigFromCallOptions(e);return i.signal=n.signal,[n,i]}invoke(e,n){return I(this,null,function*(){let i=r._convertInputToPromptValue(e);return(yield this.generatePrompt([i],n,n?.callbacks)).generations[0][0].message})}_streamResponseChunks(e,n,i){return he(this,null,function*(){throw new Error("Not implemented.")})}_streamIterator(e,n){return he(this,null,function*(){if(this._streamResponseChunks===r.prototype._streamResponseChunks)yield this.invoke(e,n);else{let l=r._convertInputToPromptValue(e).toChatMessages(),[c,f]=this._separateRunnableConfigFromCallOptionsCompat(n),h=p(p({},c.metadata),this.getLsParams(f)),d=yield new G(pn.configure(c.callbacks,this.callbacks,c.tags,this.tags,h,this.metadata,{verbose:this.verbose})),m={options:f,invocation_params:this?.invocationParams(f),batch_size:1},y=yield new G(d?.handleChatModelStart(this.toJSON(),[l],c.runId,void 0,m,void 0,void 0,c.runName)),b;try{try{for(var i=te(this._streamResponseChunks(l,f,y?.[0])),o,s,a;o=!(s=yield new G(i.next())).done;o=!1){let v=s.value;v.message.response_metadata=p(p({},v.generationInfo),v.message.response_metadata),yield v.message,b?b=b.concat(v):b=v}}catch{a=[s]}finally{try{o&&(s=i.return)&&(yield new G(s.call(i)))}finally{if(a)throw a[0]}}}catch(v){throw yield new G(Promise.all((y??[]).map(g=>g?.handleLLMError(v)))),v}yield new G(Promise.all((y??[]).map(v=>v?.handleLLMEnd({generations:[[b]]}))))}})}getLsParams(e){return{ls_model_type:"chat",ls_stop:e.stop}}_generateUncached(e,n,i){return I(this,null,function*(){let o=e.map(g=>g.map(dn)),s=p(p({},i.metadata),this.getLsParams(n)),a=yield pn.configure(i.callbacks,this.callbacks,i.tags,this.tags,s,this.metadata,{verbose:this.verbose}),u={options:n,invocation_params:this?.invocationParams(n),batch_size:1},l=yield a?.handleChatModelStart(this.toJSON(),o,i.runId,void 0,u,void 0,void 0,i.runName),c=[],f=[];if(!!l?.[0].handlers.find(g=>pc(g)||dc(g))&&o.length===1&&this._streamResponseChunks!==r.prototype._streamResponseChunks)try{let g=yield this._streamResponseChunks(o[0],n,l?.[0]),A;try{for(var m=te(g),y,b,v;y=!(b=yield m.next()).done;y=!1){let E=b.value;A===void 0?A=E:A=bi(A,E)}}catch{v=[b]}finally{try{y&&(b=m.return)&&(yield b.call(m))}finally{if(v)throw v[0]}}if(A===void 0)throw new Error("Received empty response from chat model call.");c.push([A]),yield l?.[0].handleLLMEnd({generations:c,llmOutput:{}})}catch(g){throw yield l?.[0].handleLLMError(g),g}else{let g=yield Promise.allSettled(o.map((A,E)=>this._generate(A,_(p({},n),{promptIndex:E}),l?.[E])));yield Promise.all(g.map((A,E)=>I(this,null,function*(){if(A.status==="fulfilled"){let w=A.value;for(let x of w.generations)x.message.response_metadata=p(p({},x.generationInfo),x.message.response_metadata);return w.generations.length===1&&(w.generations[0].message.response_metadata=p(p({},w.llmOutput),w.generations[0].message.response_metadata)),c[E]=w.generations,f[E]=w.llmOutput,l?.[E]?.handleLLMEnd({generations:[w.generations],llmOutput:w.llmOutput})}else return yield l?.[E]?.handleLLMError(A.reason),Promise.reject(A.reason)})))}let d={generations:c,llmOutput:f.length?this._combineLLMOutput?.(...f):void 0};return Object.defineProperty(d,Da,{value:l?{runIds:l?.map(g=>g.runId)}:void 0,configurable:!0}),d})}_generateCached(a){return I(this,arguments,function*({messages:e,cache:n,llmStringKey:i,parsedOptions:o,handledOptions:s}){let u=e.map(g=>g.map(dn)),l=p(p({},s.metadata),this.getLsParams(o)),c=yield pn.configure(s.callbacks,this.callbacks,s.tags,this.tags,l,this.metadata,{verbose:this.verbose}),f={options:o,invocation_params:this?.invocationParams(o),batch_size:1,cached:!0},h=yield c?.handleChatModelStart(this.toJSON(),u,s.runId,void 0,f,void 0,void 0,s.runName),d=[],y=(yield Promise.allSettled(u.map((g,A)=>I(this,null,function*(){let E=r._convertInputToPromptValue(g).toString(),w=yield n.lookup(E,i);return w==null&&d.push(A),w})))).map((g,A)=>({result:g,runManager:h?.[A]})).filter(({result:g})=>g.status==="fulfilled"&&g.value!=null||g.status==="rejected"),b=[];yield Promise.all(y.map((w,x)=>I(this,[w,x],function*({result:g,runManager:A},E){if(g.status==="fulfilled"){let C=g.value;return b[E]=C,C.length&&(yield A?.handleLLMNewToken(C[0].text)),A?.handleLLMEnd({generations:[C]})}else return yield A?.handleLLMError(g.reason),Promise.reject(g.reason)})));let v={generations:b,missingPromptIndices:d};return Object.defineProperty(v,Da,{value:h?{runIds:h?.map(g=>g.runId)}:void 0,configurable:!0}),v})}generate(e,n,i){return I(this,null,function*(){let o;Array.isArray(n)?o={stop:n}:o=n;let s=e.map(m=>m.map(dn)),[a,u]=this._separateRunnableConfigFromCallOptionsCompat(o);if(a.callbacks=a.callbacks??i,!this.cache)return this._generateUncached(s,u,a);let{cache:l}=this,c=this._getSerializedCacheKeyParametersForCall(u),{generations:f,missingPromptIndices:h}=yield this._generateCached({messages:s,cache:l,llmStringKey:c,parsedOptions:u,handledOptions:a}),d={};if(h.length>0){let m=yield this._generateUncached(h.map(y=>s[y]),u,a);yield Promise.all(m.generations.map((y,b)=>I(this,null,function*(){let v=h[b];f[v]=y;let g=r._convertInputToPromptValue(s[v]).toString();return l.update(g,c,y)}))),d=m.llmOutput??{}}return{generations:f,llmOutput:d}})}invocationParams(e){return{}}_modelType(){return"base_chat_model"}serialize(){return _(p({},this.invocationParams()),{_type:this._llmType(),_model:this._modelType()})}generatePrompt(e,n,i){return I(this,null,function*(){let o=e.map(s=>s.toChatMessages());return this.generate(o,n,i)})}call(e,n,i){return I(this,null,function*(){return(yield this.generate([e.map(dn)],n,i)).generations[0][0].message})}callPrompt(e,n,i){return I(this,null,function*(){let o=e.toChatMessages();return this.call(o,n,i)})}predictMessages(e,n,i){return I(this,null,function*(){return this.call(e,n,i)})}predict(e,n,i){return I(this,null,function*(){let o=new hc(e),s=yield this.call([o],n,i);if(typeof s.content!="string")throw new Error("Cannot use predict when output is not a string.");return s.content})}withStructuredOutput(e,n){if(typeof this.bindTools!="function")throw new Error('Chat model must implement ".bindTools()" to use withStructuredOutput.');let i=e,o=n?.name,s=i.description??"A function available to call.",a=n?.method,u=n?.includeRaw;if(a==="jsonMode")throw new Error('Base withStructuredOutput implementation only supports "functionCalling" as a method.');let l=o??"extract",c;_s(i)?c=[{type:"function",function:{name:l,description:s,parameters:sr(i)}}]:("name"in i&&(l=i.name),c=[{type:"function",function:{name:l,description:s,parameters:i}}]);let f=this.bindTools(c),h=Na.from(b=>{if(!b.tool_calls||b.tool_calls.length===0)throw new Error("No tool calls found in the response.");let v=b.tool_calls.find(g=>g.name===l);if(!v)throw new Error(`No tool call found with name ${l}.`);return v.args});if(!u)return f.pipe(h).withConfig({runName:"StructuredOutput"});let d=Wt.assign({parsed:(b,v)=>h.invoke(b.raw,v)}),m=Wt.assign({parsed:()=>null}),y=d.withFallbacks({fallbacks:[m]});return Ro.from([{raw:f},y]).withConfig({runName:"StructuredOutputRunnable"})}};var Ki=class extends Pt{parseResultWithPrompt(e,n,i){return this.parseResult(e,i)}_baseMessageToString(e){return typeof e.content=="string"?e.content:this._baseMessageContentToString(e.content)}_baseMessageContentToString(e){return JSON.stringify(e)}invoke(e,n){return I(this,null,function*(){return typeof e=="string"?this._callWithConfig((i,o)=>I(this,null,function*(){return this.parseResult([{text:i}],o?.callbacks)}),e,_(p({},n),{runType:"parser"})):this._callWithConfig((i,o)=>I(this,null,function*(){return this.parseResult([{message:i,text:this._baseMessageToString(i)}],o?.callbacks)}),e,_(p({},n),{runType:"parser"}))})}},Zi=class extends Ki{parseResult(e,n){return this.parse(e[0].text,n)}parseWithPrompt(e,n,i){return I(this,null,function*(){return this.parse(e,i)})}_type(){throw new Error("_type not implemented")}},Kr=class extends Error{constructor(e,n,i,o=!1){if(super(e),Object.defineProperty(this,"llmOutput",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"observation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sendToLLM",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.llmOutput=n,this.observation=i,this.sendToLLM=o,o&&(i===void 0||n===void 0))throw new Error("Arguments 'observation' & 'llmOutput' are required if 'sendToLlm' is true")}};function ws(r,e){let n=typeof r;if(n!==typeof e)return!1;if(Array.isArray(r)){if(!Array.isArray(e))return!1;let i=r.length;if(i!==e.length)return!1;for(let o=0;o<i;o++)if(!ws(r[o],e[o]))return!1;return!0}if(n==="object"){if(!r||!e)return r===e;let i=Object.keys(r),o=Object.keys(e);if(i.length!==o.length)return!1;for(let a of i)if(!ws(r[a],e[a]))return!1;return!0}return r===e}var Uj=typeof self<"u"&&self.location&&self.location.origin!=="null"?new URL(self.location.origin+self.location.pathname+location.search):new URL("https://github.com/cfworker");var ZC=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,XC=[0,31,28,31,30,31,30,31,31,30,31,30,31],JC=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i,YC=/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,QC=/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,eI=/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,tI=/^(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!10(?:\.\d{1,3}){3})(?!127(?:\.\d{1,3}){3})(?!169\.254(?:\.\d{1,3}){2})(?!192\.168(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u{00a1}-\u{ffff}0-9]+-?)*[a-z\u{00a1}-\u{ffff}0-9]+)(?:\.(?:[a-z\u{00a1}-\u{ffff}0-9]+-?)*[a-z\u{00a1}-\u{ffff}0-9]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,rI=/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,nI=/^(?:\/(?:[^~/]|~0|~1)*)*$/,iI=/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,oI=/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,sI=/^\d\d\d\d-[0-1]\d-[0-3]\d$/,aI=/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,uI=/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,lI=/^(?:(?:[a-z][a-z0-9+-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,cI=r=>{if(r[0]==='"')return!1;let[e,n,...i]=r.split("@");return!e||!n||i.length!==0||e.length>64||n.length>253||e[0]==="."||e.endsWith(".")||e.includes("..")||!/^[a-z0-9.-]+$/i.test(n)||!/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+$/i.test(e)?!1:n.split(".").every(o=>/^[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?$/i.test(o))},fI=/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,hI=/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,dI=r=>r.length>1&&r.length<80&&(/^P\d+([.,]\d+)?W$/.test(r)||/^P[\dYMDTHS]*(\d[.,]\d+)?[YMDHS]$/.test(r)&&/^P([.,\d]+Y)?([.,\d]+M)?([.,\d]+D)?(T([.,\d]+H)?([.,\d]+M)?([.,\d]+S)?)?$/.test(r));function Ye(r){return r.test.bind(r)}var pI={date:bg,time:_g.bind(void 0,!1),"date-time":vI,duration:dI,uri:wI,"uri-reference":Ye(QC),"uri-template":Ye(eI),url:Ye(tI),email:cI,hostname:Ye(YC),ipv4:Ye(fI),ipv6:Ye(hI),regex:AI,uuid:Ye(rI),"json-pointer":Ye(nI),"json-pointer-uri-fragment":Ye(iI),"relative-json-pointer":Ye(oI)},mI=_(p({},pI),{date:Ye(sI),time:Ye(aI),"date-time":Ye(uI),"uri-reference":Ye(lI)});function gI(r){return r%4===0&&(r%100!==0||r%400===0)}function bg(r){let e=r.match(ZC);if(!e)return!1;let n=+e[1],i=+e[2],o=+e[3];return i>=1&&i<=12&&o>=1&&o<=(i==2&&gI(n)?29:XC[i])}function _g(r,e){let n=e.match(JC);if(!n)return!1;let i=+n[1],o=+n[2],s=+n[3],a=!!n[5];return(i<=23&&o<=59&&s<=59||i==23&&o==59&&s==60)&&(!r||a)}var yI=/t|\s/i;function vI(r){let e=r.split(yI);return e.length==2&&bg(e[0])&&_g(!0,e[1])}var bI=/\/|:/,_I=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;function wI(r){return bI.test(r)&&_I.test(r)}var xI=/[^\\]\\Z/;function AI(r){if(xI.test(r))return!1;try{return new RegExp(r),!0}catch{return!1}}var Xi=class extends Zi{_transform(e){return he(this,null,function*(){try{for(var n=te(e),i,o,s;i=!(o=yield new G(n.next())).done;i=!1){let a=o.value;typeof a=="string"?yield this.parseResult([{text:a}]):yield this.parseResult([{message:a,text:this._baseMessageToString(a)}])}}catch{s=[o]}finally{try{i&&(o=n.return)&&(yield new G(o.call(n)))}finally{if(s)throw s[0]}}})}transform(e,n){return he(this,null,function*(){yield*gd(this._transformStreamWithConfig(e,this._transform.bind(this),_(p({},n),{runType:"parser"})))})}},xs=class extends Xi{constructor(e){super(e),Object.defineProperty(this,"diff",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.diff=e?.diff??this.diff}_transform(e){return he(this,null,function*(){let n,i;try{for(var o=te(e),s,a,u;s=!(a=yield new G(o.next())).done;s=!1){let l=a.value;if(typeof l!="string"&&typeof l.content!="string")throw new Error("Cannot handle non-string output.");let c;if(sp(l)){if(typeof l.content!="string")throw new Error("Cannot handle non-string message output.");c=new mn({message:l,text:l.content})}else if(uc(l)){if(typeof l.content!="string")throw new Error("Cannot handle non-string message output.");c=new mn({message:hp(l),text:l.content})}else c=new To({text:l});i===void 0?i=c:i=i.concat(c);let f=yield new G(this.parsePartialResult([i]));f!=null&&!ws(f,n)&&(this.diff?yield this._diff(n,f):yield f,n=f)}}catch{u=[a]}finally{try{s&&(a=o.return)&&(yield new G(a.call(o)))}finally{if(u)throw u[0]}}})}};var As=class extends Zi{static lc_name(){return"StructuredOutputParser"}toJSON(){return this.toJSONNotImplemented()}constructor(e){super(e),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","structured"]})}static fromZodSchema(e){return new this(e)}static fromNamesAndDescriptions(e){let n=vi.object(Object.fromEntries(Object.entries(e).map(([i,o])=>[i,vi.string().describe(o)])));return new this(n)}getFormatInstructions(){return`You must format your output as a JSON value that adheres to a given "JSON Schema" instance.

"JSON Schema" is a declarative language that allows you to annotate and validate JSON documents.

For example, the example "JSON Schema" instance {{"properties": {{"foo": {{"description": "a list of test words", "type": "array", "items": {{"type": "string"}}}}}}, "required": ["foo"]}}}}
would match an object with one required property, "foo". The "type" property specifies "foo" must be an "array", and the "description" property semantically describes it as "a list of test words". The items within "foo" must be strings.
Thus, the object {{"foo": ["bar", "baz"]}} is a well-formatted instance of this example "JSON Schema". The object {{"properties": {{"foo": ["bar", "baz"]}}}} is not well-formatted.

Your output will be parsed and type-checked according to the provided schema instance, so make sure all fields in your output match the schema exactly and there are no trailing commas!

Here is the JSON Schema instance your output must adhere to. Include the enclosing markdown codeblock:
\`\`\`json
${JSON.stringify(sr(this.schema))}
\`\`\`
`}parse(e){return I(this,null,function*(){try{let i=(e.includes("```")?e.trim().split(/```(?:json)?/)[1]:e.trim()).replace(/"([^"\\]*(\\.[^"\\]*)*)"/g,(o,s)=>`"${s.replace(/\n/g,"\\n")}"`).replace(/\n/g,"");return yield this.schema.parseAsync(JSON.parse(i))}catch(n){throw new Kr(`Failed to parse. Text: "${e}". Error: ${n}`,e)}})}};var ei=class extends xs{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","output_parsers"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}static lc_name(){return"JsonOutputParser"}_diff(e,n){if(n)return e?ka(e,n):[{op:"replace",path:"",value:n}]}parsePartialResult(e){return I(this,null,function*(){return sc(e[0].text)})}parse(e){return I(this,null,function*(){return sc(e,JSON.parse)})}getFormatInstructions(){return""}};function rh(r,e){if(r.function===void 0)return;let n;if(e?.partial)try{n=ac(r.function.arguments??"{}")}catch{return}else try{n=JSON.parse(r.function.arguments)}catch(o){throw new Kr([`Function "${r.function.name}" arguments:`,"",r.function.arguments,"","are not valid JSON.",`Error: ${o.message}`].join(`
`))}let i={name:r.function.name,args:n,type:"tool_call"};return e?.returnId&&(i.id=r.id),i}function wg(r){if(r.id===void 0)throw new Error('All OpenAI tool calls must have an "id" field.');return{id:r.id,type:"function",function:{name:r.name,arguments:JSON.stringify(r.args)}}}function xg(r,e){return{name:r.function?.name,args:r.function?.arguments,id:r.id,error:e,type:"invalid_tool_call"}}var th=class extends Ki{static lc_name(){return"JsonOutputToolsParser"}constructor(e){super(e),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.returnId=e?.returnId??this.returnId}parseResult(e){return I(this,null,function*(){let n=e[0].message.additional_kwargs.tool_calls;if(!n)throw new Error(`No tools_call in message ${JSON.stringify(e)}`);let i=JSON.parse(JSON.stringify(n)),o=[];for(let s of i){let a=rh(s,{partial:!0});if(a!==void 0){let u={type:a.name,args:a.args,id:a.id};Object.defineProperty(u,"name",{get(){return this.type}}),Object.defineProperty(u,"arguments",{get(){return this.args}}),o.push(u)}}return o})}},Cs=class extends Ki{static lc_name(){return"JsonOutputKeyToolsParser"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"keyName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnSingle",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"initialParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"zodSchema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keyName=e.keyName,this.returnSingle=e.returnSingle??this.returnSingle,this.initialParser=new th(e),this.zodSchema=e.zodSchema}_validateResult(e){return I(this,null,function*(){if(this.zodSchema===void 0)return e;let n=yield this.zodSchema.safeParseAsync(e);if(n.success)return n.data;throw new Kr(`Failed to parse. Text: "${JSON.stringify(e,null,2)}". Error: ${JSON.stringify(n.error.errors)}`,JSON.stringify(e,null,2))})}parseResult(e){return I(this,null,function*(){let i=(yield this.initialParser.parseResult(e)).filter(a=>a.type===this.keyName),o=i;return this.returnId||(o=i.map(a=>a.args)),this.returnSingle?this._validateResult(o[0]):yield Promise.all(o.map(a=>this._validateResult(a)))})}};var Cg=Symbol("Let zodToJsonSchema decide on which parser to use"),Ag={name:void 0,$refStrategy:"root",effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",nullableStrategy:"from-target",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},Ig=r=>typeof r=="string"?_(p({},Ag),{basePath:["#"],definitions:{},name:r}):p(_(p({},Ag),{basePath:["#"],definitions:{}}),r);var Is=r=>"_def"in r?r._def:r;function Eg(r){if(!r)return!0;for(let e in r)return!1;return!0}var Og=r=>{let e=Ig(r),n=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return _(p({},e),{currentPath:n,propertyPath:void 0,seenRefs:new Set,seen:new Map(Object.entries(e.definitions).map(([i,o])=>[Is(o),{def:Is(o),path:[...e.basePath,e.definitionPath,i],jsonSchema:void 0}]))})};function nh(r,e,n,i){i?.errorMessages&&n&&(r.errorMessage=_(p({},r.errorMessage),{[e]:n}))}function re(r,e,n,i,o){r[e]=n,nh(r,e,i,o)}function Pg(){return{}}function Tg(r,e){let n={type:"array"};return r.type?._def?.typeName!==K.ZodAny&&(n.items=B(r.type._def,_(p({},e),{currentPath:[...e.currentPath,"items"]}))),r.minLength&&re(n,"minItems",r.minLength.value,r.minLength.message,e),r.maxLength&&re(n,"maxItems",r.maxLength.value,r.maxLength.message,e),r.exactLength&&(re(n,"minItems",r.exactLength.value,r.exactLength.message,e),re(n,"maxItems",r.exactLength.value,r.exactLength.message,e)),n}function Sg(r,e){let n={type:"integer",format:"int64"};if(!r.checks)return n;for(let i of r.checks)switch(i.kind){case"min":e.target==="jsonSchema7"?i.inclusive?re(n,"minimum",i.value,i.message,e):re(n,"exclusiveMinimum",i.value,i.message,e):(i.inclusive||(n.exclusiveMinimum=!0),re(n,"minimum",i.value,i.message,e));break;case"max":e.target==="jsonSchema7"?i.inclusive?re(n,"maximum",i.value,i.message,e):re(n,"exclusiveMaximum",i.value,i.message,e):(i.inclusive||(n.exclusiveMaximum=!0),re(n,"maximum",i.value,i.message,e));break;case"multipleOf":re(n,"multipleOf",i.value,i.message,e);break}return n}function Rg(){return{type:"boolean"}}function Mg(r,e){return B(r.type._def,e)}var kg=(r,e)=>B(r.innerType._def,e);function ih(r,e,n){let i=n??e.dateStrategy;if(Array.isArray(i))return{anyOf:i.map((o,s)=>ih(r,e,o))};switch(i){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return II(r,e)}}var II=(r,e)=>{let n={type:"integer",format:"unix-time"};if(e.target==="openApi3")return n;for(let i of r.checks)switch(i.kind){case"min":re(n,"minimum",i.value,i.message,e);break;case"max":re(n,"maximum",i.value,i.message,e);break}return n};function Dg(r,e){return _(p({},B(r.innerType._def,e)),{default:r.defaultValue()})}function Ng(r,e){return e.effectStrategy==="input"?B(r.schema._def,e):{}}function jg(r){return{type:"string",enum:[...r.values]}}var EI=r=>"type"in r&&r.type==="string"?!1:"allOf"in r;function Fg(r,e){let n=[B(r.left._def,_(p({},e),{currentPath:[...e.currentPath,"allOf","0"]})),B(r.right._def,_(p({},e),{currentPath:[...e.currentPath,"allOf","1"]}))].filter(s=>!!s),i=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0,o=[];return n.forEach(s=>{if(EI(s))o.push(...s.allOf),s.unevaluatedProperties===void 0&&(i=void 0);else{let u=s;if("additionalProperties"in s&&s.additionalProperties===!1){let a=s,{additionalProperties:l}=a;u=fe(a,["additionalProperties"])}else i=void 0;o.push(u)}}),o.length?p({allOf:o},i):void 0}function zg(r,e){let n=typeof r.value;return n!=="bigint"&&n!=="number"&&n!=="boolean"&&n!=="string"?{type:Array.isArray(r.value)?"array":"object"}:e.target==="openApi3"?{type:n==="bigint"?"integer":n,enum:[r.value]}:{type:n==="bigint"?"integer":n,const:r.value}}var oh,ti={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(oh===void 0&&(oh=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),oh),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/};function ku(r,e){let n={type:"string"};function i(o){return e.patternStrategy==="escape"?OI(o):o}if(r.checks)for(let o of r.checks)switch(o.kind){case"min":re(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,o.value):o.value,o.message,e);break;case"max":re(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,o.value):o.value,o.message,e);break;case"email":switch(e.emailStrategy){case"format:email":Dt(n,"email",o.message,e);break;case"format:idn-email":Dt(n,"idn-email",o.message,e);break;case"pattern:zod":Nt(n,ti.email,o.message,e);break}break;case"url":Dt(n,"uri",o.message,e);break;case"uuid":Dt(n,"uuid",o.message,e);break;case"regex":Nt(n,o.regex,o.message,e);break;case"cuid":Nt(n,ti.cuid,o.message,e);break;case"cuid2":Nt(n,ti.cuid2,o.message,e);break;case"startsWith":Nt(n,RegExp(`^${i(o.value)}`),o.message,e);break;case"endsWith":Nt(n,RegExp(`${i(o.value)}$`),o.message,e);break;case"datetime":Dt(n,"date-time",o.message,e);break;case"date":Dt(n,"date",o.message,e);break;case"time":Dt(n,"time",o.message,e);break;case"duration":Dt(n,"duration",o.message,e);break;case"length":re(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,o.value):o.value,o.message,e),re(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,o.value):o.value,o.message,e);break;case"includes":{Nt(n,RegExp(i(o.value)),o.message,e);break}case"ip":{o.version!=="v6"&&Dt(n,"ipv4",o.message,e),o.version!=="v4"&&Dt(n,"ipv6",o.message,e);break}case"emoji":Nt(n,ti.emoji,o.message,e);break;case"ulid":{Nt(n,ti.ulid,o.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{Dt(n,"binary",o.message,e);break}case"contentEncoding:base64":{re(n,"contentEncoding","base64",o.message,e);break}case"pattern:zod":{Nt(n,ti.base64,o.message,e);break}}break}case"nanoid":Nt(n,ti.nanoid,o.message,e);case"toLowerCase":case"toUpperCase":case"trim":break;default:}return n}var OI=r=>Array.from(r).map(e=>/[a-zA-Z0-9]/.test(e)?e:`\\${e}`).join(""),Dt=(r,e,n,i)=>{r.format||r.anyOf?.some(o=>o.format)?(r.anyOf||(r.anyOf=[]),r.format&&(r.anyOf.push(p({format:r.format},r.errorMessage&&i.errorMessages&&{errorMessage:{format:r.errorMessage.format}})),delete r.format,r.errorMessage&&(delete r.errorMessage.format,Object.keys(r.errorMessage).length===0&&delete r.errorMessage)),r.anyOf.push(p({format:e},n&&i.errorMessages&&{errorMessage:{format:n}}))):re(r,"format",e,n,i)},Nt=(r,e,n,i)=>{r.pattern||r.allOf?.some(o=>o.pattern)?(r.allOf||(r.allOf=[]),r.pattern&&(r.allOf.push(p({pattern:r.pattern},r.errorMessage&&i.errorMessages&&{errorMessage:{pattern:r.errorMessage.pattern}})),delete r.pattern,r.errorMessage&&(delete r.errorMessage.pattern,Object.keys(r.errorMessage).length===0&&delete r.errorMessage)),r.allOf.push(p({pattern:$g(e,i)},n&&i.errorMessages&&{errorMessage:{pattern:n}}))):re(r,"pattern",$g(e,i),n,i)},$g=(r,e)=>{let n=typeof r=="function"?r():r;if(!e.applyRegexFlags||!n.flags)return n.source;let i={i:n.flags.includes("i"),m:n.flags.includes("m"),s:n.flags.includes("s")},o=i.i?n.source.toLowerCase():n.source,s="",a=!1,u=!1,l=!1;for(let c=0;c<o.length;c++){if(a){s+=o[c],a=!1;continue}if(i.i){if(u){if(o[c].match(/[a-z]/)){l?(s+=o[c],s+=`${o[c-2]}-${o[c]}`.toUpperCase(),l=!1):o[c+1]==="-"&&o[c+2]?.match(/[a-z]/)?(s+=o[c],l=!0):s+=`${o[c]}${o[c].toUpperCase()}`;continue}}else if(o[c].match(/[a-z]/)){s+=`[${o[c]}${o[c].toUpperCase()}]`;continue}}if(i.m){if(o[c]==="^"){s+=`(^|(?<=[\r
]))`;continue}else if(o[c]==="$"){s+=`($|(?=[\r
]))`;continue}}if(i.s&&o[c]==="."){s+=u?`${o[c]}\r
`:`[${o[c]}\r
]`;continue}s+=o[c],o[c]==="\\"?a=!0:u&&o[c]==="]"?u=!1:!u&&o[c]==="["&&(u=!0)}try{let c=new RegExp(s)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),n.source}return s};function Du(r,e){if(e.target==="openApi3"&&r.keyType?._def.typeName===K.ZodEnum)return{type:"object",required:r.keyType._def.values,properties:r.keyType._def.values.reduce((i,o)=>_(p({},i),{[o]:B(r.valueType._def,_(p({},e),{currentPath:[...e.currentPath,"properties",o]}))??{}}),{}),additionalProperties:!1};let n={type:"object",additionalProperties:B(r.valueType._def,_(p({},e),{currentPath:[...e.currentPath,"additionalProperties"]}))??{}};if(e.target==="openApi3")return n;if(r.keyType?._def.typeName===K.ZodString&&r.keyType._def.checks?.length){let i=Object.entries(ku(r.keyType._def,e)).reduce((o,[s,a])=>s==="type"?o:_(p({},o),{[s]:a}),{});return _(p({},n),{propertyNames:i})}else if(r.keyType?._def.typeName===K.ZodEnum)return _(p({},n),{propertyNames:{enum:r.keyType._def.values}});return n}function Lg(r,e){if(e.mapStrategy==="record")return Du(r,e);let n=B(r.keyType._def,_(p({},e),{currentPath:[...e.currentPath,"items","items","0"]}))||{},i=B(r.valueType._def,_(p({},e),{currentPath:[...e.currentPath,"items","items","1"]}))||{};return{type:"array",maxItems:125,items:{type:"array",items:[n,i],minItems:2,maxItems:2}}}function Ug(r){let e=r.values,i=Object.keys(r.values).filter(s=>typeof e[e[s]]!="number").map(s=>e[s]),o=Array.from(new Set(i.map(s=>typeof s)));return{type:o.length===1?o[0]==="string"?"string":"number":["string","number"],enum:i}}function Vg(){return{not:{}}}function Bg(r){return r.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}var Es={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function Gg(r,e){if(e.target==="openApi3")return qg(r,e);let n=r.options instanceof Map?Array.from(r.options.values()):r.options;if(n.every(i=>i._def.typeName in Es&&(!i._def.checks||!i._def.checks.length))){let i=n.reduce((o,s)=>{let a=Es[s._def.typeName];return a&&!o.includes(a)?[...o,a]:o},[]);return{type:i.length>1?i:i[0]}}else if(n.every(i=>i._def.typeName==="ZodLiteral"&&!i.description)){let i=n.reduce((o,s)=>{let a=typeof s._def.value;switch(a){case"string":case"number":case"boolean":return[...o,a];case"bigint":return[...o,"integer"];case"object":if(s._def.value===null)return[...o,"null"];case"symbol":case"undefined":case"function":default:return o}},[]);if(i.length===n.length){let o=i.filter((s,a,u)=>u.indexOf(s)===a);return{type:o.length>1?o:o[0],enum:n.reduce((s,a)=>s.includes(a._def.value)?s:[...s,a._def.value],[])}}}else if(n.every(i=>i._def.typeName==="ZodEnum"))return{type:"string",enum:n.reduce((i,o)=>[...i,...o._def.values.filter(s=>!i.includes(s))],[])};return qg(r,e)}var qg=(r,e)=>{let n=(r.options instanceof Map?Array.from(r.options.values()):r.options).map((i,o)=>B(i._def,_(p({},e),{currentPath:[...e.currentPath,"anyOf",`${o}`]}))).filter(i=>!!i&&(!e.strictUnions||typeof i=="object"&&Object.keys(i).length>0));return n.length?{anyOf:n}:void 0};function Hg(r,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(r.innerType._def.typeName)&&(!r.innerType._def.checks||!r.innerType._def.checks.length))return e.target==="openApi3"||e.nullableStrategy==="property"?{type:Es[r.innerType._def.typeName],nullable:!0}:{type:[Es[r.innerType._def.typeName],"null"]};if(e.target==="openApi3"){let i=B(r.innerType._def,_(p({},e),{currentPath:[...e.currentPath]}));return i&&"$ref"in i?{allOf:[i],nullable:!0}:i&&_(p({},i),{nullable:!0})}let n=B(r.innerType._def,_(p({},e),{currentPath:[...e.currentPath,"anyOf","0"]}));return n&&{anyOf:[n,{type:"null"}]}}function Wg(r,e){let n={type:"number"};if(!r.checks)return n;for(let i of r.checks)switch(i.kind){case"int":n.type="integer",nh(n,"type",i.message,e);break;case"min":e.target==="jsonSchema7"?i.inclusive?re(n,"minimum",i.value,i.message,e):re(n,"exclusiveMinimum",i.value,i.message,e):(i.inclusive||(n.exclusiveMinimum=!0),re(n,"minimum",i.value,i.message,e));break;case"max":e.target==="jsonSchema7"?i.inclusive?re(n,"maximum",i.value,i.message,e):re(n,"exclusiveMaximum",i.value,i.message,e):(i.inclusive||(n.exclusiveMaximum=!0),re(n,"maximum",i.value,i.message,e));break;case"multipleOf":re(n,"multipleOf",i.value,i.message,e);break}return n}function PI(r,e){return e.removeAdditionalStrategy==="strict"?r.catchall._def.typeName==="ZodNever"?r.unknownKeys!=="strict":B(r.catchall._def,_(p({},e),{currentPath:[...e.currentPath,"additionalProperties"]}))??!0:r.catchall._def.typeName==="ZodNever"?r.unknownKeys==="passthrough":B(r.catchall._def,_(p({},e),{currentPath:[...e.currentPath,"additionalProperties"]}))??!0}function Kg(r,e){let n=_(p({type:"object"},Object.entries(r.shape()).reduce((i,[o,s])=>{if(s===void 0||s._def===void 0)return i;let a=B(s._def,_(p({},e),{currentPath:[...e.currentPath,"properties",o],propertyPath:[...e.currentPath,"properties",o]}));return a===void 0?i:{properties:_(p({},i.properties),{[o]:a}),required:s.isOptional()&&!e.openaiStrictMode?i.required:[...i.required,o]}},{properties:{},required:[]})),{additionalProperties:PI(r,e)});return n.required.length||delete n.required,n}var Zg=(r,e)=>{if(e.currentPath.toString()===e.propertyPath?.toString())return B(r.innerType._def,e);let n=B(r.innerType._def,_(p({},e),{currentPath:[...e.currentPath,"anyOf","1"]}));return n?{anyOf:[{not:{}},n]}:{}};var Xg=(r,e)=>{if(e.pipeStrategy==="input")return B(r.in._def,e);if(e.pipeStrategy==="output")return B(r.out._def,e);let n=B(r.in._def,_(p({},e),{currentPath:[...e.currentPath,"allOf","0"]})),i=B(r.out._def,_(p({},e),{currentPath:[...e.currentPath,"allOf",n?"1":"0"]}));return{allOf:[n,i].filter(o=>o!==void 0)}};function Jg(r,e){return B(r.type._def,e)}function Yg(r,e){let i={type:"array",uniqueItems:!0,items:B(r.valueType._def,_(p({},e),{currentPath:[...e.currentPath,"items"]}))};return r.minSize&&re(i,"minItems",r.minSize.value,r.minSize.message,e),r.maxSize&&re(i,"maxItems",r.maxSize.value,r.maxSize.message,e),i}function Qg(r,e){return r.rest?{type:"array",minItems:r.items.length,items:r.items.map((n,i)=>B(n._def,_(p({},e),{currentPath:[...e.currentPath,"items",`${i}`]}))).reduce((n,i)=>i===void 0?n:[...n,i],[]),additionalItems:B(r.rest._def,_(p({},e),{currentPath:[...e.currentPath,"additionalItems"]}))}:{type:"array",minItems:r.items.length,maxItems:r.items.length,items:r.items.map((n,i)=>B(n._def,_(p({},e),{currentPath:[...e.currentPath,"items",`${i}`]}))).reduce((n,i)=>i===void 0?n:[...n,i],[])}}function ey(){return{not:{}}}function ty(){return{}}var ry=(r,e)=>B(r.innerType._def,e);function B(r,e,n=!1){let i=e.seen.get(r);if(e.override){let a=e.override?.(r,e,i,n);if(a!==Cg)return a}if(i&&!n){let a=TI(i,e);if(a!==void 0)return"$ref"in a&&e.seenRefs.add(a.$ref),a}let o={def:r,path:e.currentPath,jsonSchema:void 0};e.seen.set(r,o);let s=RI(r,r.typeName,e);return s&&MI(r,e,s),o.jsonSchema=s,s}var TI=(r,e)=>{switch(e.$refStrategy){case"root":return{$ref:r.path.join("/")};case"extract-to-root":let n=r.path.slice(e.basePath.length+1).join("_");return n!==e.name&&e.nameStrategy==="duplicate-ref"&&(e.definitions[n]=r.def),{$ref:[...e.basePath,e.definitionPath,n].join("/")};case"relative":return{$ref:SI(e.currentPath,r.path)};case"none":case"seen":return r.path.length<e.currentPath.length&&r.path.every((i,o)=>e.currentPath[o]===i)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),{}):e.$refStrategy==="seen"?{}:void 0}},SI=(r,e)=>{let n=0;for(;n<r.length&&n<e.length&&r[n]===e[n];n++);return[(r.length-n).toString(),...e.slice(n)].join("/")},RI=(r,e,n)=>{switch(e){case K.ZodString:return ku(r,n);case K.ZodNumber:return Wg(r,n);case K.ZodObject:return Kg(r,n);case K.ZodBigInt:return Sg(r,n);case K.ZodBoolean:return Rg();case K.ZodDate:return ih(r,n);case K.ZodUndefined:return ey();case K.ZodNull:return Bg(n);case K.ZodArray:return Tg(r,n);case K.ZodUnion:case K.ZodDiscriminatedUnion:return Gg(r,n);case K.ZodIntersection:return Fg(r,n);case K.ZodTuple:return Qg(r,n);case K.ZodRecord:return Du(r,n);case K.ZodLiteral:return zg(r,n);case K.ZodEnum:return jg(r);case K.ZodNativeEnum:return Ug(r);case K.ZodNullable:return Hg(r,n);case K.ZodOptional:return Zg(r,n);case K.ZodMap:return Lg(r,n);case K.ZodSet:return Yg(r,n);case K.ZodLazy:return B(r.getter()._def,n);case K.ZodPromise:return Jg(r,n);case K.ZodNaN:case K.ZodNever:return Vg();case K.ZodEffects:return Ng(r,n);case K.ZodAny:return Pg();case K.ZodUnknown:return ty();case K.ZodDefault:return Dg(r,n);case K.ZodBranded:return Mg(r,n);case K.ZodReadonly:return ry(r,n);case K.ZodCatch:return kg(r,n);case K.ZodPipeline:return Xg(r,n);case K.ZodFunction:case K.ZodVoid:case K.ZodSymbol:return;default:return(i=>{})(e)}},MI=(r,e,n)=>(r.description&&(n.description=r.description,e.markdownDescription&&(n.markdownDescription=r.description)),n);var ny=(r,e)=>{let n=Og(e),i=typeof e=="string"?e:e?.nameStrategy==="title"?void 0:e?.name,o=B(r._def,i===void 0?n:_(p({},n),{currentPath:[...n.basePath,n.definitionPath,i]}),!1)??{},s=typeof e=="object"&&e.name!==void 0&&e.nameStrategy==="title"?e.name:void 0;s!==void 0&&(o.title=s);let a=(()=>{if(Eg(n.definitions))return;let l={},c=new Set;for(let f=0;f<500;f++){let h=Object.entries(n.definitions).filter(([d])=>!c.has(d));if(h.length===0)break;for(let[d,m]of h)l[d]=B(Is(m),_(p({},n),{currentPath:[...n.basePath,n.definitionPath,d]}),!0)??{},c.add(d)}return l})(),u=i===void 0?a?_(p({},o),{[n.definitionPath]:a}):o:n.nameStrategy==="duplicate-ref"?p(p({},o),a||n.seenRefs.size?{[n.definitionPath]:p(p({},a),n.seenRefs.size?{[i]:o}:void 0)}:void 0):{$ref:[...n.$refStrategy==="relative"?[]:n.basePath,n.definitionPath,i].join("/"),[n.definitionPath]:_(p({},a),{[i]:o})};return n.target==="jsonSchema7"?u.$schema="http://json-schema.org/draft-07/schema#":n.target==="jsonSchema2019-09"&&(u.$schema="https://json-schema.org/draft/2019-09/schema#"),u};function iy(r,e){return ny(r,{openaiStrictMode:!0,name:e.name,nameStrategy:"duplicate-ref",$refStrategy:"extract-to-root",nullableStrategy:"property"})}function oy(r,e,n){return $m({type:"json_schema",json_schema:_(p({},n),{name:e,strict:!0,schema:iy(r,{name:e})})},i=>r.parse(JSON.parse(i)))}function sy(r){return Lm({type:"function",function:p({name:r.name,parameters:iy(r.parameters,{name:r.name}),strict:!0},r.description?{description:r.description}:void 0)},{callback:r.function,parser:e=>r.parameters.parse(JSON.parse(e))})}function Zr(r){let{azureOpenAIApiDeploymentName:e,azureOpenAIApiInstanceName:n,azureOpenAIApiKey:i,azureOpenAIBasePath:o,baseURL:s,azureADTokenProvider:a}=r;if((i||a)&&o&&e)return`${o}/${e}`;if(i||a){if(!n)throw new Error("azureOpenAIApiInstanceName is required when using azureOpenAIApiKey");if(!e)throw new Error("azureOpenAIApiDeploymentName is a required parameter when using azureOpenAIApiKey");return`https://${n}.openai.azure.com/openai/deployments/${e}`}return s}function sh(r,e){let n=typeof e=="number"?void 0:e;return p({name:r.name,description:r.description,parameters:sr(r.schema)},n?.strict!==void 0?{strict:n.strict}:{})}function kI(r){return r!==void 0&&Array.isArray(r.lc_namespace)}function DI(r){return r!==void 0&&Pt.isRunnable(r)&&"lc_name"in r.constructor&&typeof r.constructor.lc_name=="function"&&r.constructor.lc_name()==="RunnableToolLike"}function NI(r){return!!r&&typeof r=="object"&&"name"in r&&"schema"in r&&_s(r.schema)}function ay(r){return NI(r)||DI(r)||kI(r)}function ri(r){let e;return r.constructor.name===lg.name?(e=new Error(r.message),e.name="TimeoutError"):r.constructor.name===cg.name?(e=new Error(r.message),e.name="AbortError"):e=r,e}function uy(r){if(r)return r==="any"||r==="required"?"required":r==="auto"?"auto":r==="none"?"none":typeof r=="string"?{type:"function",function:{name:r}}:r}function jI(r){return r.anyOf!==void 0&&Array.isArray(r.anyOf)}function ly(r){let e=["namespace functions {",""];for(let n of r)n.description&&e.push(`// ${n.description}`),Object.keys(n.parameters.properties??{}).length>0?(e.push(`type ${n.name} = (_: {`),e.push(cy(n.parameters,0)),e.push("}) => any;")):e.push(`type ${n.name} = () => any;`),e.push("");return e.push("} // namespace functions"),e.join(`
`)}function cy(r,e){let n=[];for(let[i,o]of Object.entries(r.properties??{}))o.description&&e<2&&n.push(`// ${o.description}`),r.required?.includes(i)?n.push(`${i}: ${Nu(o,e)},`):n.push(`${i}?: ${Nu(o,e)},`);return n.map(i=>" ".repeat(e)+i).join(`
`)}function Nu(r,e){if(jI(r))return r.anyOf.map(n=>Nu(n,e)).join(" | ");switch(r.type){case"string":return r.enum?r.enum.map(n=>`"${n}"`).join(" | "):"string";case"number":return r.enum?r.enum.map(n=>`${n}`).join(" | "):"number";case"integer":return r.enum?r.enum.map(n=>`${n}`).join(" | "):"number";case"boolean":return"boolean";case"null":return"null";case"object":return["{",cy(r,e+2),"}"].join(`
`);case"array":return r.items?`${Nu(r.items,e)}[]`:"any[]";default:return""}}function fy(r,e){let n;if(ay(r)){let i=sy({name:r.name,parameters:r.schema,description:r.description});i.function.parameters?n={type:i.type,function:p({name:i.function.name,description:i.function.description,parameters:i.function.parameters},e?.strict!==void 0?{strict:e.strict}:{})}:n={type:"function",function:sh(r,e)}}else n=r;return e?.strict!==void 0&&(n.function.strict=e.strict),n}function FI(r){return r.role!=="system"&&r.role!=="assistant"&&r.role!=="user"&&r.role!=="function"&&r.role!=="tool"&&console.warn(`Unknown message role: ${r.role}`),r.role}function py(r){let e=r._getType();switch(e){case"system":return"system";case"ai":return"assistant";case"human":return"user";case"function":return"function";case"tool":return"tool";case"generic":{if(!fc.isInstance(r))throw new Error("Invalid generic chat message");return FI(r)}default:throw new Error(`Unknown message type: ${e}`)}}function zI(r,e,n){let i=r.tool_calls;switch(r.role){case"assistant":{let o=[],s=[];for(let l of i??[])try{o.push(rh(l,{returnId:!0}))}catch(c){s.push(xg(l,c.message))}let a={function_call:r.function_call,tool_calls:i};n!==void 0&&(a.__raw_response=e);let u;return e.system_fingerprint&&(u={system_fingerprint:e.system_fingerprint}),new Po({content:r.content||"",tool_calls:o,invalid_tool_calls:s,additional_kwargs:a,response_metadata:u,id:e.id})}default:return new fc(r.content||"",r.role??"unknown")}}function $I(r,e,n,i){let o=r.role??n,s=r.content??"",a;if(r.function_call?a={function_call:r.function_call}:r.tool_calls?a={tool_calls:r.tool_calls}:a={},i&&(a.__raw_response=e),o==="user")return new cp({content:s});if(o==="assistant"){let u=[];if(Array.isArray(r.tool_calls))for(let l of r.tool_calls)u.push({name:l.function?.name,args:l.function?.arguments,id:l.id,index:l.index,type:"tool_call_chunk"});return new Ma({content:s,tool_call_chunks:u,additional_kwargs:a,id:e.id})}else return o==="system"?new fp({content:s}):o==="function"?new lp({content:s,additional_kwargs:a,name:r.name}):o==="tool"?new ap({content:s,additional_kwargs:a,tool_call_id:r.tool_call_id}):new up({content:s,role:o})}function hy(r){return r.map(e=>{let n={role:py(e),content:e.content};return e.name!=null&&(n.name=e.name),e.additional_kwargs.function_call!=null&&(n.function_call=e.additional_kwargs.function_call,n.content=null),cc(e)&&e.tool_calls?.length?(n.tool_calls=e.tool_calls.map(wg),n.content=null):(e.additional_kwargs.tool_calls!=null&&(n.tool_calls=e.additional_kwargs.tool_calls),e.tool_call_id!=null&&(n.tool_call_id=e.tool_call_id)),n})}function dy(r,e){return yg(r)?e?.strict!==void 0?_(p({},r),{function:_(p({},r.function),{strict:e.strict})}):r:fy(r,e)}var Os=class extends Mu{static lc_name(){return"ChatOpenAI"}get callKeys(){return[...super.callKeys,"options","function_call","functions","tools","tool_choice","promptIndex","response_format","seed"]}get lc_secrets(){return{openAIApiKey:"OPENAI_API_KEY",apiKey:"OPENAI_API_KEY",azureOpenAIApiKey:"AZURE_OPENAI_API_KEY",organization:"OPENAI_ORGANIZATION"}}get lc_aliases(){return{modelName:"model",openAIApiKey:"openai_api_key",apiKey:"openai_api_key",azureOpenAIApiVersion:"azure_openai_api_version",azureOpenAIApiKey:"azure_openai_api_key",azureOpenAIApiInstanceName:"azure_openai_api_instance_name",azureOpenAIApiDeploymentName:"azure_openai_api_deployment_name"}}constructor(e,n){if(super(e??{}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"presencePenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"n",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"logitBias",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(this,"modelKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stopSequences",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"user",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"streamUsage",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"logprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topLogprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"openAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureADTokenProvider",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiInstanceName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiDeploymentName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIBasePath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"organization",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"__includeRawResponse",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"supportsStrictToolCalling",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.openAIApiKey=e?.apiKey??e?.openAIApiKey??Xe("OPENAI_API_KEY"),this.apiKey=this.openAIApiKey,this.azureOpenAIApiKey=e?.azureOpenAIApiKey??Xe("AZURE_OPENAI_API_KEY"),this.azureADTokenProvider=e?.azureADTokenProvider??void 0,!this.azureOpenAIApiKey&&!this.apiKey&&!this.azureADTokenProvider)throw new Error("OpenAI or Azure OpenAI API key or Token Provider not found");if(this.azureOpenAIApiInstanceName=e?.azureOpenAIApiInstanceName??Xe("AZURE_OPENAI_API_INSTANCE_NAME"),this.azureOpenAIApiDeploymentName=e?.azureOpenAIApiDeploymentName??Xe("AZURE_OPENAI_API_DEPLOYMENT_NAME"),this.azureOpenAIApiVersion=e?.azureOpenAIApiVersion??Xe("AZURE_OPENAI_API_VERSION"),this.azureOpenAIBasePath=e?.azureOpenAIBasePath??Xe("AZURE_OPENAI_BASE_PATH"),this.organization=e?.configuration?.organization??Xe("OPENAI_ORGANIZATION"),this.modelName=e?.model??e?.modelName??this.model,this.model=this.modelName,this.modelKwargs=e?.modelKwargs??{},this.timeout=e?.timeout,this.temperature=e?.temperature??this.temperature,this.topP=e?.topP??this.topP,this.frequencyPenalty=e?.frequencyPenalty??this.frequencyPenalty,this.presencePenalty=e?.presencePenalty??this.presencePenalty,this.maxTokens=e?.maxTokens,this.logprobs=e?.logprobs,this.topLogprobs=e?.topLogprobs,this.n=e?.n??this.n,this.logitBias=e?.logitBias,this.stop=e?.stopSequences??e?.stop,this.stopSequences=this?.stop,this.user=e?.user,this.__includeRawResponse=e?.__includeRawResponse,this.azureOpenAIApiKey||this.azureADTokenProvider){if(!this.azureOpenAIApiInstanceName&&!this.azureOpenAIBasePath)throw new Error("Azure OpenAI API instance name not found");if(!this.azureOpenAIApiDeploymentName)throw new Error("Azure OpenAI API deployment name not found");if(!this.azureOpenAIApiVersion)throw new Error("Azure OpenAI API version not found");this.apiKey=this.apiKey??"",this.streamUsage=!1}this.streaming=e?.streaming??!1,this.streamUsage=e?.streamUsage??this.streamUsage,this.clientConfig=p(p({apiKey:this.apiKey,organization:this.organization,baseURL:n?.basePath??e?.configuration?.basePath,dangerouslyAllowBrowser:!0,defaultHeaders:n?.baseOptions?.headers??e?.configuration?.baseOptions?.headers,defaultQuery:n?.baseOptions?.params??e?.configuration?.baseOptions?.params},n),e?.configuration),e?.supportsStrictToolCalling!==void 0&&(this.supportsStrictToolCalling=e.supportsStrictToolCalling)}getLsParams(e){let n=this.invocationParams(e);return{ls_provider:"openai",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:n.temperature??void 0,ls_max_tokens:n.max_tokens??void 0,ls_stop:e.stop}}bindTools(e,n){let i;return n?.strict!==void 0?i=n.strict:this.supportsStrictToolCalling!==void 0&&(i=this.supportsStrictToolCalling),this.bind(p({tools:e.map(o=>dy(o,{strict:i}))},n))}createResponseFormat(e){return e&&e.type==="json_schema"&&e.json_schema.schema&&ju(e.json_schema.schema)?oy(e.json_schema.schema,e.json_schema.name,{description:e.json_schema.description}):e}invocationParams(e,n){let i;e?.strict!==void 0?i=e.strict:this.supportsStrictToolCalling!==void 0&&(i=this.supportsStrictToolCalling);let o={};return e?.stream_options!==void 0?o={stream_options:e.stream_options}:this.streamUsage&&(this.streaming||n?.streaming)&&(o={stream_options:{include_usage:!0}}),p(_(p({model:this.model,temperature:this.temperature,top_p:this.topP,frequency_penalty:this.frequencyPenalty,presence_penalty:this.presencePenalty,max_tokens:this.maxTokens===-1?void 0:this.maxTokens,logprobs:this.logprobs,top_logprobs:this.topLogprobs,n:this.n,logit_bias:this.logitBias,stop:e?.stop??this.stopSequences,user:this.user,stream:this.streaming,functions:e?.functions,function_call:e?.function_call,tools:e?.tools?.length?e.tools.map(a=>dy(a,{strict:i})):void 0,tool_choice:uy(e?.tool_choice),response_format:this.createResponseFormat(e?.response_format),seed:e?.seed},o),{parallel_tool_calls:e?.parallel_tool_calls}),this.modelKwargs)}_identifyingParams(){return p(p({model_name:this.model},this.invocationParams()),this.clientConfig)}_streamResponseChunks(e,n,i){return he(this,null,function*(){let o=hy(e),s=_(p({},this.invocationParams(n,{streaming:!0})),{messages:o,stream:!0}),a;if(s.response_format&&s.response_format.type==="json_schema"){console.warn('OpenAI does not yet support streaming with "response_format" set to "json_schema". Falling back to non-streaming mode.');let m=yield new G(this._generate(e,n,i)),y=new mn({message:new Ma(p({},m.generations[0].message)),text:m.generations[0].text,generationInfo:m.generations[0].generationInfo});return yield y,i?.handleLLMNewToken(m.generations[0].text??"",void 0,void 0,void 0,void 0,{chunk:y})}let u=yield new G(this.completionWithRetry(s,n)),l;try{for(var c=te(u),f,h,d;f=!(h=yield new G(c.next())).done;f=!1){let m=h.value;let y=m?.choices[0];if(m.usage&&(l=m.usage),!y)continue;let{delta:b}=y;if(!b)continue;let v=$I(b,m,a,this.__includeRawResponse);a=b.role??a;let g={prompt:n.promptIndex??0,completion:y.index??0};if(typeof v.content!="string"){console.log("[WARNING]: Received non-string content from OpenAI. This is currently not supported.");continue}let A=p({},g);y.finish_reason!==void 0&&(A.finish_reason=y.finish_reason,A.system_fingerprint=m.system_fingerprint),this.logprobs&&(A.logprobs=y.logprobs);let E=new mn({message:v,text:v.content,generationInfo:A});yield E,yield new G(i?.handleLLMNewToken(E.text??"",g,void 0,void 0,void 0,{chunk:E}))}}catch{d=[h]}finally{try{f&&(h=c.return)&&(yield new G(h.call(c)))}finally{if(d)throw d[0]}}if(l&&(yield new mn({message:new Ma({content:"",usage_metadata:{input_tokens:l.prompt_tokens,output_tokens:l.completion_tokens,total_tokens:l.total_tokens}}),text:""})),n.signal?.aborted)throw new Error("AbortError")})}identifyingParams(){return this._identifyingParams()}_generate(e,n,i){return I(this,null,function*(){let o={},s=this.invocationParams(n),a=hy(e);if(s.stream){let h=this._streamResponseChunks(e,n,i),d={};try{for(var u=te(h),l,c,f;l=!(c=yield u.next()).done;l=!1){let A=c.value;A.message.response_metadata=p(p({},A.generationInfo),A.message.response_metadata);let E=A.generationInfo?.completion??0;d[E]===void 0?d[E]=A:d[E]=d[E].concat(A)}}catch{f=[c]}finally{try{l&&(c=u.return)&&(yield c.call(u))}finally{if(f)throw f[0]}}let m=Object.entries(d).sort(([A],[E])=>parseInt(A,10)-parseInt(E,10)).map(([A,E])=>E),{functions:y,function_call:b}=this.invocationParams(n),v=yield this.getEstimatedTokenCountFromPrompt(e,y,b),g=yield this.getNumTokensFromGenerations(m);return o.promptTokens=v,o.completionTokens=g,o.totalTokens=v+g,{generations:m,llmOutput:{estimatedTokenUsage:o}}}else{let h;n.response_format&&n.response_format.type==="json_schema"?h=yield this.betaParsedCompletionWithRetry(_(p({},s),{stream:!1,messages:a}),p({signal:n?.signal},n?.options)):h=yield this.completionWithRetry(_(p({},s),{stream:!1,messages:a}),p({signal:n?.signal},n?.options));let{completion_tokens:d,prompt_tokens:m,total_tokens:y}=h?.usage??{};d&&(o.completionTokens=(o.completionTokens??0)+d),m&&(o.promptTokens=(o.promptTokens??0)+m),y&&(o.totalTokens=(o.totalTokens??0)+y);let b=[];for(let v of h?.choices??[]){let A={text:v.message?.content??"",message:zI(v.message??{role:"assistant"},h,this.__includeRawResponse)};A.generationInfo=p(p({},v.finish_reason?{finish_reason:v.finish_reason}:{}),v.logprobs?{logprobs:v.logprobs}:{}),cc(A.message)&&(A.message.usage_metadata={input_tokens:o.promptTokens??0,output_tokens:o.completionTokens??0,total_tokens:o.totalTokens??0}),b.push(A)}return{generations:b,llmOutput:{tokenUsage:o}}}})}getEstimatedTokenCountFromPrompt(e,n,i){return I(this,null,function*(){let o=(yield this.getNumTokensFromMessages(e)).totalCount;if(n&&i!=="auto"){let s=ly(n);o+=yield this.getNumTokens(s),o+=9}return n&&e.find(s=>s._getType()==="system")&&(o-=4),i==="none"?o+=1:typeof i=="object"&&(o+=(yield this.getNumTokens(i.name))+4),o})}getNumTokensFromGenerations(e){return I(this,null,function*(){return(yield Promise.all(e.map(i=>I(this,null,function*(){return i.message.additional_kwargs?.function_call?(yield this.getNumTokensFromMessages([i.message])).countPerMessage[0]:yield this.getNumTokens(i.message.content)})))).reduce((i,o)=>i+o,0)})}getNumTokensFromMessages(e){return I(this,null,function*(){let n=0,i=0,o=0;this.model==="gpt-3.5-turbo-0301"?(i=4,o=-1):(i=3,o=1);let s=yield Promise.all(e.map(a=>I(this,null,function*(){let u=yield this.getNumTokens(a.content),l=yield this.getNumTokens(py(a)),c=a.name!==void 0?o+(yield this.getNumTokens(a.name)):0,f=u+i+l+c,h=a;if(h._getType()==="function"&&(f-=2),h.additional_kwargs?.function_call&&(f+=3),h?.additional_kwargs.function_call?.name&&(f+=yield this.getNumTokens(h.additional_kwargs.function_call?.name)),h.additional_kwargs.function_call?.arguments)try{f+=yield this.getNumTokens(JSON.stringify(JSON.parse(h.additional_kwargs.function_call?.arguments)))}catch(d){console.error("Error parsing function arguments",d,JSON.stringify(h.additional_kwargs.function_call)),f+=yield this.getNumTokens(h.additional_kwargs.function_call?.arguments)}return n+=f,f})));return n+=3,{totalCount:n,countPerMessage:s}})}completionWithRetry(e,n){return I(this,null,function*(){let i=this._getClientOptions(n);return this.caller.call(()=>I(this,null,function*(){try{return yield this.client.chat.completions.create(e,i)}catch(o){throw ri(o)}}))})}betaParsedCompletionWithRetry(e,n){return I(this,null,function*(){let i=this._getClientOptions(n);return this.caller.call(()=>I(this,null,function*(){try{return yield this.client.beta.chat.completions.parse(e,i)}catch(o){throw ri(o)}}))})}_getClientOptions(e){if(!this.client){let i={azureOpenAIApiDeploymentName:this.azureOpenAIApiDeploymentName,azureOpenAIApiInstanceName:this.azureOpenAIApiInstanceName,azureOpenAIApiKey:this.azureOpenAIApiKey,azureOpenAIBasePath:this.azureOpenAIBasePath,baseURL:this.clientConfig.baseURL},o=Zr(i),s=_(p({},this.clientConfig),{baseURL:o,timeout:this.timeout,maxRetries:0});s.baseURL||delete s.baseURL,this.client=new ge(s)}let n=p(p({},this.clientConfig),e);return this.azureOpenAIApiKey&&(n.headers=p({"api-key":this.azureOpenAIApiKey},n.headers),n.query=p({"api-version":this.azureOpenAIApiVersion},n.query)),n}_llmType(){return"openai"}_combineLLMOutput(...e){return e.reduce((n,i)=>(i&&i.tokenUsage&&(n.tokenUsage.completionTokens+=i.tokenUsage.completionTokens??0,n.tokenUsage.promptTokens+=i.tokenUsage.promptTokens??0,n.tokenUsage.totalTokens+=i.tokenUsage.totalTokens??0),n),{tokenUsage:{completionTokens:0,promptTokens:0,totalTokens:0}})}withStructuredOutput(e,n){let i,o,s,a;LI(e)?(i=e.schema,o=e.name,s=e.method,a=e.includeRaw):(i=e,o=n?.name,s=n?.method,a=n?.includeRaw);let u,l;if(n?.strict!==void 0&&s==="jsonMode")throw new Error("Argument `strict` is only supported for `method` = 'function_calling'");if(s==="jsonMode")u=this.bind({response_format:{type:"json_object"}}),ju(i)?l=As.fromZodSchema(i):l=new ei;else if(s==="jsonSchema")u=this.bind({response_format:{type:"json_schema",json_schema:{name:o??"extract",description:i.description,schema:i,strict:n?.strict}}}),ju(i)?l=As.fromZodSchema(i):l=new ei;else{let d=o??"extract";if(ju(i)){let m=sr(i);u=this.bind(p({tools:[{type:"function",function:{name:d,description:m.description,parameters:m}}],tool_choice:{type:"function",function:{name:d}}},n?.strict!==void 0?{strict:n.strict}:{})),l=new Cs({returnSingle:!0,keyName:d,zodSchema:i})}else{let m;typeof i.name=="string"&&typeof i.parameters=="object"&&i.parameters!=null?(m=i,d=i.name):(d=i.title??d,m={name:d,description:i.description??"",parameters:i}),u=this.bind(p({tools:[{type:"function",function:m}],tool_choice:{type:"function",function:{name:d}}},n?.strict!==void 0?{strict:n.strict}:{})),l=new Cs({returnSingle:!0,keyName:d})}}if(!a)return u.pipe(l);let c=Wt.assign({parsed:(d,m)=>l.invoke(d.raw,m)}),f=Wt.assign({parsed:()=>null}),h=c.withFallbacks({fallbacks:[f]});return Ro.from([{raw:u},h])}};function ju(r){return typeof r?.parse=="function"}function LI(r){return r!==void 0&&typeof r.schema=="object"}var ah=class extends vs{get lc_namespace(){return["langchain","tools"]}constructor(e){super(e??{}),Object.defineProperty(this,"returnDirect",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"responseFormat",{enumerable:!0,configurable:!0,writable:!0,value:"content"}),this.responseFormat=e?.responseFormat??this.responseFormat}invoke(e,n){return I(this,null,function*(){let i,o;pp(e)?(i=e.id,o=e.args):o=e;let s=gn(n);return this.call(o,_(p({},s),{configurable:_(p({},s.configurable),{tool_call_id:i})}))})}call(e,n,i){return I(this,null,function*(){let o;try{o=yield this.schema.parseAsync(e)}catch{throw new mp("Received tool input did not match expected schema",JSON.stringify(e))}let s=dp(n),u=yield(yield pn.configure(s.callbacks,this.callbacks,s.tags||i,this.tags,s.metadata,this.metadata,{verbose:this.verbose}))?.handleToolStart(this.toJSON(),typeof o=="string"?o:JSON.stringify(o),s.runId,void 0,void 0,void 0,s.runName);delete s.runId;let l;try{l=yield this._call(o,u,s)}catch(m){throw yield u?.handleToolError(m),m}let c,f;if(this.responseFormat==="content_and_artifact")if(Array.isArray(l)&&l.length===2)[c,f]=l;else throw new Error(`Tool response format is "content_and_artifact" but the output was not a two-tuple.
Result: ${JSON.stringify(l)}`);else c=l;let h;s&&"configurable"in s&&(h=s.configurable.tool_call_id);let d=VI({content:c,artifact:f,toolCallId:h,name:this.name});return yield u?.handleToolEnd(d),d})}},Fu=class extends ah{constructor(e){super(e),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:vi.object({input:vi.string().optional()}).transform(n=>n.input)})}call(e,n){return super.call(typeof e=="string"||!e?{input:e}:e,n)}};function VI(r){let{content:e,artifact:n,toolCallId:i}=r;return i?typeof e=="string"||Array.isArray(e)&&e.every(o=>typeof o=="object")?new lc({content:e,artifact:n,tool_call_id:i,name:r.name}):new lc({content:BI(e),artifact:n,tool_call_id:i,name:r.name}):e}function BI(r){try{return JSON.stringify(r,null,2)}catch{return`${r}`}}var uh=class extends Fu{static lc_name(){return"DallEAPIWrapper"}constructor(e){e?.responseFormat!==void 0&&["url","b64_json"].includes(e.responseFormat)&&(e.dallEResponseFormat=e.responseFormat,e.responseFormat="content"),super(e),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"dalle_api_wrapper"}),Object.defineProperty(this,"description",{enumerable:!0,configurable:!0,writable:!0,value:"A wrapper around OpenAI DALL-E API. Useful for when you need to generate images from a text description. Input should be an image description."}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"dall-e-3"}),Object.defineProperty(this,"style",{enumerable:!0,configurable:!0,writable:!0,value:"vivid"}),Object.defineProperty(this,"quality",{enumerable:!0,configurable:!0,writable:!0,value:"standard"}),Object.defineProperty(this,"n",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"size",{enumerable:!0,configurable:!0,writable:!0,value:"1024x1024"}),Object.defineProperty(this,"dallEResponseFormat",{enumerable:!0,configurable:!0,writable:!0,value:"url"}),Object.defineProperty(this,"user",{enumerable:!0,configurable:!0,writable:!0,value:void 0});let n=e?.apiKey??e?.openAIApiKey??Xe("OPENAI_API_KEY"),i=e?.organization??Xe("OPENAI_ORGANIZATION"),o={apiKey:n,organization:i,dangerouslyAllowBrowser:!0};this.client=new ge(o),this.model=e?.model??e?.modelName??this.model,this.style=e?.style??this.style,this.quality=e?.quality??this.quality,this.n=e?.n??this.n,this.size=e?.size??this.size,this.dallEResponseFormat=e?.dallEResponseFormat??this.dallEResponseFormat,this.user=e?.user}processMultipleGeneratedUrls(e){return this.dallEResponseFormat==="url"?e.flatMap(n=>n.data.flatMap(o=>o.url?{type:"image_url",image_url:o.url}:[]).filter(o=>o!==void 0&&o.type==="image_url"&&typeof o.image_url=="string"&&o.image_url!==void 0)):e.flatMap(n=>n.data.flatMap(o=>o.b64_json?{type:"image_url",image_url:{url:o.b64_json}}:[]).filter(o=>o!==void 0&&o.type==="image_url"&&typeof o.image_url=="object"&&"url"in o.image_url&&typeof o.image_url.url=="string"&&o.image_url.url!==void 0))}_call(e){return I(this,null,function*(){let n={model:this.model,prompt:e,n:1,size:this.size,response_format:this.dallEResponseFormat,style:this.style,quality:this.quality,user:this.user};if(this.n>1){let s=yield Promise.all(Array.from({length:this.n}).map(()=>this.client.images.generate(n)));return this.processMultipleGeneratedUrls(s)}let i=yield this.client.images.generate(n),o="";return this.dallEResponseFormat==="url"?[o]=i.data.map(s=>s.url).filter(s=>s!=="undefined"):[o]=i.data.map(s=>s.b64_json).filter(s=>s!=="undefined"),o})}};Object.defineProperty(uh,"toolName",{enumerable:!0,configurable:!0,writable:!0,value:"dalle_api_wrapper"});var qI=`Generate a knowledge graph based on the given information.

The output should be in valid JSON format and match the specified schema.

Make sure that, no node should be disconnected from the graph. 

Each node must have at least one relation with another node, and the relationships should capture both direct and indirect connections.`,GI=new ei,HI=`Respond only in valid JSON. The JSON object you return should match the following schema:
{nodes:[{id: "number", label: "string", type: "string"}],links:[{source: "number", target: "number", type: "string"}]}`,zu=class r{llmGraphChain;constructor(){}initGraphLLM(e){return I(this,null,function*(){let n=yield ja.fromMessages([["system",qI+`

{format_instructions}`],["human","{query}"]]).partial({format_instructions:HI}),i=new Os({apiKey:e,temperature:0});this.llmGraphChain=n.pipe(i).pipe(GI)})}generateGraph(e){return I(this,null,function*(){console.log(e);let n=yield this.llmGraphChain.invoke({query:e});return yield this.formatGraphData(n).then(i=>i)})}formatGraphData(e){return I(this,null,function*(){let n=e.links.map(o=>({source:o.source,target:o.target,type:o.type,curvature:this.getRandomNumber()})),i={nodes:e.nodes,links:n};return yield this.buildNeighborsRelation(i).then(o=>o)})}buildNeighborsRelation(e){return I(this,null,function*(){return e.links.forEach(n=>{let i=e.nodes.find(s=>s.id==n.source),o=e.nodes.find(s=>s.id==n.target);!i.neighbors&&(i.neighbors=[]),!o.neighbors&&(o.neighbors=[]),i.neighbors.push(o),o.neighbors.push(i),!i.links&&(i.links=[]),!o.links&&(o.links=[]),i.links.push(n),o.links.push(n)}),e})}getRandomNumber(){return 0}nodeCanvasObject(e,n,i){let o=16/i,s=e.label;n.font=`${o}px Sans-Serif`;let u=[n.measureText(s).width+4,o].map(l=>l+o*.5);n.fillStyle=e.color,n.roundRect(e.x-u[0]/2,e.y-u[1]/2,u[0],u[1],[10]),n.fill(),n.fillStyle=e.nodeTextColor,n.textAlign="center",n.textBaseline="middle",n.fillStyle="white",n.fillText(s,e.x,e.y),e.__bckgDimensions=u}nodePointerAreaPaint(e,n,i){i.fillStyle=n;let o=e.__bckgDimensions;o&&i.fillRect(e.x-o[0]/2,e.y-o[1]/2,o[0],o[1])}linkCanvasObject(e,n,i,o){let s=e.type,a=16/i,u=o.nodeRelSize()*1.5,l=e.source,c=e.target;if(typeof l!="object"||typeof c!="object")return;let f=Object.assign({},...["x","y"].map(w=>({[w]:l[w]+(c[w]-l[w])/2}))),h={x:c.x-l.x,y:c.y-l.y},d=Math.atan2(h.y,h.x),m=Math.sqrt(Math.pow(h.x,2)+Math.pow(h.y,2))-u*2,y=Math.sqrt(Math.pow(h.x,2)+Math.pow(h.y,2)),b=f.x+e.curvature*y/2*Math.sin(d),v=f.y-e.curvature*y/2*Math.cos(d);n.font="1px Sans-Serif";let g=Math.min(a,m/n.measureText(s).width);n.font=`${g}px Sans-Serif`;let E=[n.measureText(s).width,g].map(w=>w+g*.2);n.save(),n.translate(b,v),n.fillStyle="#f5f5f5",n.fillRect(-E[0]/2,-E[1]/2,E[0],E[1]),n.textAlign="center",n.textBaseline="middle",n.fillStyle="black",n.fillText(s,0,0),n.restore()}linkAutoColorBy(e,n){var i=n.nodes.find(o=>o.id==e.source);return i?i.type:"other"}zoomNodeAtCenter(e,n){n.centerAt(e.x,e.y,1e3),n.zoom(6,2e3)}static \u0275fac=function(n){return new(n||r)};static \u0275prov=W({token:r,factory:r.\u0275fac,providedIn:"root"})};function my(r,e){if(r.match(/^[a-z]+:\/\//i))return r;if(r.match(/^\/\//))return window.location.protocol+r;if(r.match(/^[a-z]+:/i))return r;let n=document.implementation.createHTMLDocument(),i=n.createElement("base"),o=n.createElement("a");return n.head.appendChild(i),n.body.appendChild(o),e&&(i.href=e),o.href=r,o.href}var gy=(()=>{let r=0,e=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(r+=1,`u${e()}${r}`)})();function ut(r){let e=[];for(let n=0,i=r.length;n<i;n++)e.push(r[n]);return e}function $u(r,e){let i=(r.ownerDocument.defaultView||window).getComputedStyle(r).getPropertyValue(e);return i?parseFloat(i.replace("px","")):0}function WI(r){let e=$u(r,"border-left-width"),n=$u(r,"border-right-width");return r.clientWidth+e+n}function KI(r){let e=$u(r,"border-top-width"),n=$u(r,"border-bottom-width");return r.clientHeight+e+n}function lh(r,e={}){let n=e.width||WI(r),i=e.height||KI(r);return{width:n,height:i}}function yy(){let r,e;try{e=process}catch{}let n=e&&e.env?e.env.devicePixelRatio:null;return n&&(r=parseInt(n,10),Number.isNaN(r)&&(r=1)),r||window.devicePixelRatio||1}var at=16384;function vy(r){(r.width>at||r.height>at)&&(r.width>at&&r.height>at?r.width>r.height?(r.height*=at/r.width,r.width=at):(r.width*=at/r.height,r.height=at):r.width>at?(r.height*=at/r.width,r.width=at):(r.width*=at/r.height,r.height=at))}function by(r,e={}){return r.toBlob?new Promise(n=>{r.toBlob(n,e.type?e.type:"image/png",e.quality?e.quality:1)}):new Promise(n=>{let i=window.atob(r.toDataURL(e.type?e.type:void 0,e.quality?e.quality:void 0).split(",")[1]),o=i.length,s=new Uint8Array(o);for(let a=0;a<o;a+=1)s[a]=i.charCodeAt(a);n(new Blob([s],{type:e.type?e.type:"image/png"}))})}function Ji(r){return new Promise((e,n)=>{let i=new Image;i.decode=()=>e(i),i.onload=()=>e(i),i.onerror=n,i.crossOrigin="anonymous",i.decoding="async",i.src=r})}function ZI(r){return I(this,null,function*(){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(r)).then(encodeURIComponent).then(e=>`data:image/svg+xml;charset=utf-8,${e}`)})}function _y(r,e,n){return I(this,null,function*(){let i="http://www.w3.org/2000/svg",o=document.createElementNS(i,"svg"),s=document.createElementNS(i,"foreignObject");return o.setAttribute("width",`${e}`),o.setAttribute("height",`${n}`),o.setAttribute("viewBox",`0 0 ${e} ${n}`),s.setAttribute("width","100%"),s.setAttribute("height","100%"),s.setAttribute("x","0"),s.setAttribute("y","0"),s.setAttribute("externalResourcesRequired","true"),o.appendChild(s),s.appendChild(r),ZI(o)})}var Ue=(r,e)=>{if(r instanceof e)return!0;let n=Object.getPrototypeOf(r);return n===null?!1:n.constructor.name===e.name||Ue(n,e)};function XI(r){let e=r.getPropertyValue("content");return`${r.cssText} content: '${e.replace(/'|"/g,"")}';`}function JI(r){return ut(r).map(e=>{let n=r.getPropertyValue(e),i=r.getPropertyPriority(e);return`${e}: ${n}${i?" !important":""};`}).join(" ")}function YI(r,e,n){let i=`.${r}:${e}`,o=n.cssText?XI(n):JI(n);return document.createTextNode(`${i}{${o}}`)}function wy(r,e,n){let i=window.getComputedStyle(r,n),o=i.getPropertyValue("content");if(o===""||o==="none")return;let s=gy();try{e.className=`${e.className} ${s}`}catch{return}let a=document.createElement("style");a.appendChild(YI(s,n,i)),e.appendChild(a)}function xy(r,e){wy(r,e,":before"),wy(r,e,":after")}var Ay="application/font-woff",Cy="image/jpeg",QI={woff:Ay,woff2:Ay,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:Cy,jpeg:Cy,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function e1(r){let e=/\.([^./]*?)$/g.exec(r);return e?e[1]:""}function Yi(r){let e=e1(r).toLowerCase();return QI[e]||""}function t1(r){return r.split(/,/)[1]}function Ps(r){return r.search(/^(data:)/)!==-1}function fh(r,e){return`data:${e};base64,${r}`}function hh(r,e,n){return I(this,null,function*(){let i=yield fetch(r,e);if(i.status===404)throw new Error(`Resource "${i.url}" not found`);let o=yield i.blob();return new Promise((s,a)=>{let u=new FileReader;u.onerror=a,u.onloadend=()=>{try{s(n({res:i,result:u.result}))}catch(l){a(l)}},u.readAsDataURL(o)})})}var ch={};function r1(r,e,n){let i=r.replace(/\?.*/,"");return n&&(i=r),/ttf|otf|eot|woff2?/i.test(i)&&(i=i.replace(/.*\//,"")),e?`[${e}]${i}`:i}function Qi(r,e,n){return I(this,null,function*(){let i=r1(r,e,n.includeQueryParams);if(ch[i]!=null)return ch[i];n.cacheBust&&(r+=(/\?/.test(r)?"&":"?")+new Date().getTime());let o;try{let s=yield hh(r,n.fetchRequestInit,({res:a,result:u})=>(e||(e=a.headers.get("Content-Type")||""),t1(u)));o=fh(s,e)}catch(s){o=n.imagePlaceholder||"";let a=`Failed to fetch resource: ${r}`;s&&(a=typeof s=="string"?s:s.message),a&&console.warn(a)}return ch[i]=o,o})}function n1(r){return I(this,null,function*(){let e=r.toDataURL();return e==="data:,"?r.cloneNode(!1):Ji(e)})}function i1(r,e){return I(this,null,function*(){if(r.currentSrc){let s=document.createElement("canvas"),a=s.getContext("2d");s.width=r.clientWidth,s.height=r.clientHeight,a?.drawImage(r,0,0,s.width,s.height);let u=s.toDataURL();return Ji(u)}let n=r.poster,i=Yi(n),o=yield Qi(n,i,e);return Ji(o)})}function o1(r){return I(this,null,function*(){var e;try{if(!((e=r?.contentDocument)===null||e===void 0)&&e.body)return yield Ts(r.contentDocument.body,{},!0)}catch{}return r.cloneNode(!1)})}function s1(r,e){return I(this,null,function*(){return Ue(r,HTMLCanvasElement)?n1(r):Ue(r,HTMLVideoElement)?i1(r,e):Ue(r,HTMLIFrameElement)?o1(r):r.cloneNode(!1)})}var a1=r=>r.tagName!=null&&r.tagName.toUpperCase()==="SLOT";function u1(r,e,n){return I(this,null,function*(){var i,o;let s=[];return a1(r)&&r.assignedNodes?s=ut(r.assignedNodes()):Ue(r,HTMLIFrameElement)&&(!((i=r.contentDocument)===null||i===void 0)&&i.body)?s=ut(r.contentDocument.body.childNodes):s=ut(((o=r.shadowRoot)!==null&&o!==void 0?o:r).childNodes),s.length===0||Ue(r,HTMLVideoElement)||(yield s.reduce((a,u)=>a.then(()=>Ts(u,n)).then(l=>{l&&e.appendChild(l)}),Promise.resolve())),e})}function l1(r,e){let n=e.style;if(!n)return;let i=window.getComputedStyle(r);i.cssText?(n.cssText=i.cssText,n.transformOrigin=i.transformOrigin):ut(i).forEach(o=>{let s=i.getPropertyValue(o);o==="font-size"&&s.endsWith("px")&&(s=`${Math.floor(parseFloat(s.substring(0,s.length-2)))-.1}px`),Ue(r,HTMLIFrameElement)&&o==="display"&&s==="inline"&&(s="block"),o==="d"&&e.getAttribute("d")&&(s=`path(${e.getAttribute("d")})`),n.setProperty(o,s,i.getPropertyPriority(o))})}function c1(r,e){Ue(r,HTMLTextAreaElement)&&(e.innerHTML=r.value),Ue(r,HTMLInputElement)&&e.setAttribute("value",r.value)}function f1(r,e){if(Ue(r,HTMLSelectElement)){let n=e,i=Array.from(n.children).find(o=>r.value===o.getAttribute("value"));i&&i.setAttribute("selected","")}}function h1(r,e){return Ue(e,Element)&&(l1(r,e),xy(r,e),c1(r,e),f1(r,e)),e}function d1(r,e){return I(this,null,function*(){let n=r.querySelectorAll?r.querySelectorAll("use"):[];if(n.length===0)return r;let i={};for(let s=0;s<n.length;s++){let u=n[s].getAttribute("xlink:href");if(u){let l=r.querySelector(u),c=document.querySelector(u);!l&&c&&!i[u]&&(i[u]=yield Ts(c,e,!0))}}let o=Object.values(i);if(o.length){let s="http://www.w3.org/1999/xhtml",a=document.createElementNS(s,"svg");a.setAttribute("xmlns",s),a.style.position="absolute",a.style.width="0",a.style.height="0",a.style.overflow="hidden",a.style.display="none";let u=document.createElementNS(s,"defs");a.appendChild(u);for(let l=0;l<o.length;l++)u.appendChild(o[l]);r.appendChild(a)}return r})}function Ts(r,e,n){return I(this,null,function*(){return!n&&e.filter&&!e.filter(r)?null:Promise.resolve(r).then(i=>s1(i,e)).then(i=>u1(r,i,e)).then(i=>h1(r,i)).then(i=>d1(i,e))})}var Iy=/url\((['"]?)([^'"]+?)\1\)/g,p1=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,m1=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function g1(r){let e=r.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${e})(['"]?\\))`,"g")}function y1(r){let e=[];return r.replace(Iy,(n,i,o)=>(e.push(o),n)),e.filter(n=>!Ps(n))}function v1(r,e,n,i,o){return I(this,null,function*(){try{let s=n?my(e,n):e,a=Yi(e),u;if(o){let l=yield o(s);u=fh(l,a)}else u=yield Qi(s,a,i);return r.replace(g1(e),`$1${u}$3`)}catch{}return r})}function b1(r,{preferredFontFormat:e}){return e?r.replace(m1,n=>{for(;;){let[i,,o]=p1.exec(n)||[];if(!o)return"";if(o===e)return`src: ${i};`}}):r}function dh(r){return r.search(Iy)!==-1}function Lu(r,e,n){return I(this,null,function*(){if(!dh(r))return r;let i=b1(r,n);return y1(i).reduce((s,a)=>s.then(u=>v1(u,a,e,n)),Promise.resolve(i))})}function Uu(r,e,n){return I(this,null,function*(){var i;let o=(i=e.style)===null||i===void 0?void 0:i.getPropertyValue(r);if(o){let s=yield Lu(o,null,n);return e.style.setProperty(r,s,e.style.getPropertyPriority(r)),!0}return!1})}function _1(r,e){return I(this,null,function*(){(yield Uu("background",r,e))||(yield Uu("background-image",r,e)),(yield Uu("mask",r,e))||(yield Uu("mask-image",r,e))})}function w1(r,e){return I(this,null,function*(){let n=Ue(r,HTMLImageElement);if(!(n&&!Ps(r.src))&&!(Ue(r,SVGImageElement)&&!Ps(r.href.baseVal)))return;let i=n?r.src:r.href.baseVal,o=yield Qi(i,Yi(i),e);yield new Promise((s,a)=>{r.onload=s,r.onerror=a;let u=r;u.decode&&(u.decode=s),u.loading==="lazy"&&(u.loading="eager"),n?(r.srcset="",r.src=o):r.href.baseVal=o})})}function x1(r,e){return I(this,null,function*(){let i=ut(r.childNodes).map(o=>ph(o,e));yield Promise.all(i).then(()=>r)})}function ph(r,e){return I(this,null,function*(){Ue(r,Element)&&(yield _1(r,e),yield w1(r,e),yield x1(r,e))})}function Ey(r,e){let{style:n}=r;e.backgroundColor&&(n.backgroundColor=e.backgroundColor),e.width&&(n.width=`${e.width}px`),e.height&&(n.height=`${e.height}px`);let i=e.style;return i!=null&&Object.keys(i).forEach(o=>{n[o]=i[o]}),r}var Oy={};function Py(r){return I(this,null,function*(){let e=Oy[r];if(e!=null)return e;let i=yield(yield fetch(r)).text();return e={url:r,cssText:i},Oy[r]=e,e})}function Ty(r,e){return I(this,null,function*(){let n=r.cssText,i=/url\(["']?([^"')]+)["']?\)/g,s=(n.match(/url\([^)]+\)/g)||[]).map(a=>I(this,null,function*(){let u=a.replace(i,"$1");return u.startsWith("https://")||(u=new URL(u,r.url).href),hh(u,e.fetchRequestInit,({result:l})=>(n=n.replace(a,`url(${l})`),[a,l]))}));return Promise.all(s).then(()=>n)})}function Sy(r){if(r==null)return[];let e=[],n=/(\/\*[\s\S]*?\*\/)/gi,i=r.replace(n,""),o=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){let l=o.exec(i);if(l===null)break;e.push(l[0])}i=i.replace(o,"");let s=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,a="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",u=new RegExp(a,"gi");for(;;){let l=s.exec(i);if(l===null){if(l=u.exec(i),l===null)break;s.lastIndex=u.lastIndex}else u.lastIndex=s.lastIndex;e.push(l[0])}return e}function A1(r,e){return I(this,null,function*(){let n=[],i=[];return r.forEach(o=>{if("cssRules"in o)try{ut(o.cssRules||[]).forEach((s,a)=>{if(s.type===CSSRule.IMPORT_RULE){let u=a+1,l=s.href,c=Py(l).then(f=>Ty(f,e)).then(f=>Sy(f).forEach(h=>{try{o.insertRule(h,h.startsWith("@import")?u+=1:o.cssRules.length)}catch(d){console.error("Error inserting rule from remote css",{rule:h,error:d})}})).catch(f=>{console.error("Error loading remote css",f.toString())});i.push(c)}})}catch(s){let a=r.find(u=>u.href==null)||document.styleSheets[0];o.href!=null&&i.push(Py(o.href).then(u=>Ty(u,e)).then(u=>Sy(u).forEach(l=>{a.insertRule(l,o.cssRules.length)})).catch(u=>{console.error("Error loading remote stylesheet",u)})),console.error("Error inlining remote css file",s)}}),Promise.all(i).then(()=>(r.forEach(o=>{if("cssRules"in o)try{ut(o.cssRules||[]).forEach(s=>{n.push(s)})}catch(s){console.error(`Error while reading CSS rules from ${o.href}`,s)}}),n))})}function C1(r){return r.filter(e=>e.type===CSSRule.FONT_FACE_RULE).filter(e=>dh(e.style.getPropertyValue("src")))}function I1(r,e){return I(this,null,function*(){if(r.ownerDocument==null)throw new Error("Provided element is not within a Document");let n=ut(r.ownerDocument.styleSheets),i=yield A1(n,e);return C1(i)})}function Ry(r,e){return I(this,null,function*(){let n=yield I1(r,e);return(yield Promise.all(n.map(o=>{let s=o.parentStyleSheet?o.parentStyleSheet.href:null;return Lu(o.cssText,s,e)}))).join(`
`)})}function My(r,e){return I(this,null,function*(){let n=e.fontEmbedCSS!=null?e.fontEmbedCSS:e.skipFonts?null:yield Ry(r,e);if(n){let i=document.createElement("style"),o=document.createTextNode(n);i.appendChild(o),r.firstChild?r.insertBefore(i,r.firstChild):r.appendChild(i)}})}function E1(n){return I(this,arguments,function*(r,e={}){let{width:i,height:o}=lh(r,e),s=yield Ts(r,e,!0);return yield My(s,e),yield ph(s,e),Ey(s,e),yield _y(s,i,o)})}function O1(n){return I(this,arguments,function*(r,e={}){let{width:i,height:o}=lh(r,e),s=yield E1(r,e),a=yield Ji(s),u=document.createElement("canvas"),l=u.getContext("2d"),c=e.pixelRatio||yy(),f=e.canvasWidth||i,h=e.canvasHeight||o;return u.width=f*c,u.height=h*c,e.skipAutoScale||vy(u),u.style.width=`${f}`,u.style.height=`${h}`,e.backgroundColor&&(l.fillStyle=e.backgroundColor,l.fillRect(0,0,u.width,u.height)),l.drawImage(a,0,0,u.width,u.height),u})}function ky(n){return I(this,arguments,function*(r,e={}){let i=yield O1(r,e);return yield by(i)})}var Dy=["toast-component",""];function T1(r,e){if(r&1){let n=Eo();me(0,"button",5),He("click",function(){Et(n);let o=rt();return Ot(o.remove())}),me(1,"span",6),We(2,"\xD7"),Ie()()}}function S1(r,e){if(r&1&&(Zl(0),We(1),Xl()),r&2){let n=rt(2);pe(),fn("[",n.duplicatesCount+1,"]")}}function R1(r,e){if(r&1&&(me(0,"div"),We(1),ln(2,S1,2,1,"ng-container",4),Ie()),r&2){let n=rt();ir(n.options.titleClass),cn("aria-label",n.title),pe(),fn(" ",n.title," "),pe(),Ce("ngIf",n.duplicatesCount)}}function M1(r,e){if(r&1&&Ee(0,"div",7),r&2){let n=rt();ir(n.options.messageClass),Ce("innerHTML",n.message,Hl)}}function k1(r,e){if(r&1&&(me(0,"div",8),We(1),Ie()),r&2){let n=rt();ir(n.options.messageClass),cn("aria-label",n.message),pe(),fn(" ",n.message," ")}}function D1(r,e){if(r&1&&(me(0,"div"),Ee(1,"div",9),Ie()),r&2){let n=rt();pe(),Io("width",n.width()+"%")}}function N1(r,e){if(r&1){let n=Eo();me(0,"button",5),He("click",function(){Et(n);let o=rt();return Ot(o.remove())}),me(1,"span",6),We(2,"\xD7"),Ie()()}}function j1(r,e){if(r&1&&(Zl(0),We(1),Xl()),r&2){let n=rt(2);pe(),fn("[",n.duplicatesCount+1,"]")}}function F1(r,e){if(r&1&&(me(0,"div"),We(1),ln(2,j1,2,1,"ng-container",4),Ie()),r&2){let n=rt();ir(n.options.titleClass),cn("aria-label",n.title),pe(),fn(" ",n.title," "),pe(),Ce("ngIf",n.duplicatesCount)}}function z1(r,e){if(r&1&&Ee(0,"div",7),r&2){let n=rt();ir(n.options.messageClass),Ce("innerHTML",n.message,Hl)}}function $1(r,e){if(r&1&&(me(0,"div",8),We(1),Ie()),r&2){let n=rt();ir(n.options.messageClass),cn("aria-label",n.message),pe(),fn(" ",n.message," ")}}function L1(r,e){if(r&1&&(me(0,"div"),Ee(1,"div",9),Ie()),r&2){let n=rt();pe(),Io("width",n.width()+"%")}}var mh=class{_attachedHost;component;viewContainerRef;injector;constructor(e,n){this.component=e,this.injector=n}attach(e,n){return this._attachedHost=e,e.attach(this,n)}detach(){let e=this._attachedHost;if(e)return this._attachedHost=void 0,e.detach()}get isAttached(){return this._attachedHost!=null}setAttachedHost(e){this._attachedHost=e}},gh=class{_attachedPortal;_disposeFn;attach(e,n){return this._attachedPortal=e,this.attachComponentPortal(e,n)}detach(){this._attachedPortal&&this._attachedPortal.setAttachedHost(),this._attachedPortal=void 0,this._disposeFn&&(this._disposeFn(),this._disposeFn=void 0)}setDisposeFn(e){this._disposeFn=e}},yh=class{_overlayRef;componentInstance;duplicatesCount=0;_afterClosed=new Ne;_activate=new Ne;_manualClose=new Ne;_resetTimeout=new Ne;_countDuplicate=new Ne;constructor(e){this._overlayRef=e}manualClose(){this._manualClose.next(),this._manualClose.complete()}manualClosed(){return this._manualClose.asObservable()}timeoutReset(){return this._resetTimeout.asObservable()}countDuplicate(){return this._countDuplicate.asObservable()}close(){this._overlayRef.detach(),this._afterClosed.next(),this._manualClose.next(),this._afterClosed.complete(),this._manualClose.complete(),this._activate.complete(),this._resetTimeout.complete(),this._countDuplicate.complete()}afterClosed(){return this._afterClosed.asObservable()}isInactive(){return this._activate.isStopped}activate(){this._activate.next(),this._activate.complete()}afterActivate(){return this._activate.asObservable()}onDuplicate(e,n){e&&this._resetTimeout.next(),n&&this._countDuplicate.next(++this.duplicatesCount)}},eo=class{toastId;config;message;title;toastType;toastRef;_onTap=new Ne;_onAction=new Ne;constructor(e,n,i,o,s,a){this.toastId=e,this.config=n,this.message=i,this.title=o,this.toastType=s,this.toastRef=a,this.toastRef.afterClosed().subscribe(()=>{this._onAction.complete(),this._onTap.complete()})}triggerTap(){this._onTap.next(),this.config.tapToDismiss&&this._onTap.complete()}onTap(){return this._onTap.asObservable()}triggerAction(e){this._onAction.next(e)}onAction(){return this._onAction.asObservable()}},Ny={maxOpened:0,autoDismiss:!1,newestOnTop:!0,preventDuplicates:!1,countDuplicates:!1,resetTimeoutOnDuplicate:!1,includeTitleDuplicates:!1,iconClasses:{error:"toast-error",info:"toast-info",success:"toast-success",warning:"toast-warning"},closeButton:!1,disableTimeOut:!1,timeOut:5e3,extendedTimeOut:1e3,enableHtml:!1,progressBar:!1,toastClass:"ngx-toastr",positionClass:"toast-top-right",titleClass:"toast-title",messageClass:"toast-message",easing:"ease-in",easeTime:300,tapToDismiss:!0,onActivateTick:!1,progressAnimation:"decreasing"},jy=new ae("ToastConfig"),vh=class extends gh{_hostDomElement;_componentFactoryResolver;_appRef;constructor(e,n,i){super(),this._hostDomElement=e,this._componentFactoryResolver=n,this._appRef=i}attachComponentPortal(e,n){let i=this._componentFactoryResolver.resolveComponentFactory(e.component),o;return o=i.create(e.injector),this._appRef.attachView(o.hostView),this.setDisposeFn(()=>{this._appRef.detachView(o.hostView),o.destroy()}),n?this._hostDomElement.insertBefore(this._getComponentRootNode(o),this._hostDomElement.firstChild):this._hostDomElement.appendChild(this._getComponentRootNode(o)),o}_getComponentRootNode(e){return e.hostView.rootNodes[0]}},U1=(()=>{class r{_document=j(Pe);_containerElement;ngOnDestroy(){this._containerElement&&this._containerElement.parentNode&&this._containerElement.parentNode.removeChild(this._containerElement)}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){let n=this._document.createElement("div");n.classList.add("overlay-container"),n.setAttribute("aria-live","polite"),this._document.body.appendChild(n),this._containerElement=n}static \u0275fac=function(i){return new(i||r)};static \u0275prov=W({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),bh=class{_portalHost;constructor(e){this._portalHost=e}attach(e,n=!0){return this._portalHost.attach(e,n)}detach(){return this._portalHost.detach()}},V1=(()=>{class r{_overlayContainer=j(U1);_componentFactoryResolver=j(Ud);_appRef=j(Ir);_document=j(Pe);_paneElements=new Map;create(n,i){return this._createOverlayRef(this.getPaneElement(n,i))}getPaneElement(n="",i){return this._paneElements.get(i)||this._paneElements.set(i,{}),this._paneElements.get(i)[n]||(this._paneElements.get(i)[n]=this._createPaneElement(n,i)),this._paneElements.get(i)[n]}_createPaneElement(n,i){let o=this._document.createElement("div");return o.id="toast-container",o.classList.add(n),o.classList.add("toast-container"),i?i.getContainerElement().appendChild(o):this._overlayContainer.getContainerElement().appendChild(o),o}_createPortalHost(n){return new vh(n,this._componentFactoryResolver,this._appRef)}_createOverlayRef(n){return new bh(this._createPortalHost(n))}static \u0275fac=function(i){return new(i||r)};static \u0275prov=W({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),to=(()=>{class r{overlay;_injector;sanitizer;ngZone;toastrConfig;currentlyActive=0;toasts=[];overlayContainer;previousToastMessage;index=0;constructor(n,i,o,s,a){this.overlay=i,this._injector=o,this.sanitizer=s,this.ngZone=a,this.toastrConfig=p(p({},n.default),n.config),n.config.iconClasses&&(this.toastrConfig.iconClasses=p(p({},n.default.iconClasses),n.config.iconClasses))}show(n,i,o={},s=""){return this._preBuildNotification(s,n,i,this.applyConfig(o))}success(n,i,o={}){let s=this.toastrConfig.iconClasses.success||"";return this._preBuildNotification(s,n,i,this.applyConfig(o))}error(n,i,o={}){let s=this.toastrConfig.iconClasses.error||"";return this._preBuildNotification(s,n,i,this.applyConfig(o))}info(n,i,o={}){let s=this.toastrConfig.iconClasses.info||"";return this._preBuildNotification(s,n,i,this.applyConfig(o))}warning(n,i,o={}){let s=this.toastrConfig.iconClasses.warning||"";return this._preBuildNotification(s,n,i,this.applyConfig(o))}clear(n){for(let i of this.toasts)if(n!==void 0){if(i.toastId===n){i.toastRef.manualClose();return}}else i.toastRef.manualClose()}remove(n){let i=this._findToast(n);if(!i||(i.activeToast.toastRef.close(),this.toasts.splice(i.index,1),this.currentlyActive=this.currentlyActive-1,!this.toastrConfig.maxOpened||!this.toasts.length))return!1;if(this.currentlyActive<this.toastrConfig.maxOpened&&this.toasts[this.currentlyActive]){let o=this.toasts[this.currentlyActive].toastRef;o.isInactive()||(this.currentlyActive=this.currentlyActive+1,o.activate())}return!0}findDuplicate(n="",i="",o,s){let{includeTitleDuplicates:a}=this.toastrConfig;for(let u of this.toasts){let l=a&&u.title===n;if((!a||l)&&u.message===i)return u.toastRef.onDuplicate(o,s),u}return null}applyConfig(n={}){return p(p({},this.toastrConfig),n)}_findToast(n){for(let i=0;i<this.toasts.length;i++)if(this.toasts[i].toastId===n)return{index:i,activeToast:this.toasts[i]};return null}_preBuildNotification(n,i,o,s){return s.onActivateTick?this.ngZone.run(()=>this._buildNotification(n,i,o,s)):this._buildNotification(n,i,o,s)}_buildNotification(n,i,o,s){if(!s.toastComponent)throw new Error("toastComponent required");let a=this.findDuplicate(o,i,this.toastrConfig.resetTimeoutOnDuplicate&&s.timeOut>0,this.toastrConfig.countDuplicates);if((this.toastrConfig.includeTitleDuplicates&&o||i)&&this.toastrConfig.preventDuplicates&&a!==null)return a;this.previousToastMessage=i;let u=!1;this.toastrConfig.maxOpened&&this.currentlyActive>=this.toastrConfig.maxOpened&&(u=!0,this.toastrConfig.autoDismiss&&this.clear(this.toasts[0].toastId));let l=this.overlay.create(s.positionClass,this.overlayContainer);this.index=this.index+1;let c=i;i&&s.enableHtml&&(c=this.sanitizer.sanitize(rr.HTML,i));let f=new yh(l),h=new eo(this.index,s,c,o,n,f),d=[{provide:eo,useValue:h}],m=an.create({providers:d,parent:this._injector}),y=new mh(s.toastComponent,m),b=l.attach(y,s.newestOnTop);f.componentInstance=b.instance;let v={toastId:this.index,title:o||"",message:i||"",toastRef:f,onShown:f.afterActivate(),onHidden:f.afterClosed(),onTap:h.onTap(),onAction:h.onAction(),portal:b};return u||(this.currentlyActive=this.currentlyActive+1,setTimeout(()=>{v.toastRef.activate()})),this.toasts.push(v),v}static \u0275fac=function(i){return new(i||r)(J(jy),J(V1),J(an),J(Tc),J(tt))};static \u0275prov=W({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),B1=(()=>{class r{toastrService;toastPackage;ngZone;message;title;options;duplicatesCount;originalTimeout;width=nr(-1);toastClasses="";state;get _state(){return this.state()}get displayStyle(){if(this.state().value==="inactive")return"none"}timeout;intervalId;hideTime;sub;sub1;sub2;sub3;constructor(n,i,o){this.toastrService=n,this.toastPackage=i,this.ngZone=o,this.message=i.message,this.title=i.title,this.options=i.config,this.originalTimeout=i.config.timeOut,this.toastClasses=`${i.toastType} ${i.config.toastClass}`,this.sub=i.toastRef.afterActivate().subscribe(()=>{this.activateToast()}),this.sub1=i.toastRef.manualClosed().subscribe(()=>{this.remove()}),this.sub2=i.toastRef.timeoutReset().subscribe(()=>{this.resetTimeout()}),this.sub3=i.toastRef.countDuplicate().subscribe(s=>{this.duplicatesCount=s}),this.state=nr({value:"inactive",params:{easeTime:this.toastPackage.config.easeTime,easing:"ease-in"}})}ngOnDestroy(){this.sub.unsubscribe(),this.sub1.unsubscribe(),this.sub2.unsubscribe(),this.sub3.unsubscribe(),clearInterval(this.intervalId),clearTimeout(this.timeout)}activateToast(){this.state.update(n=>_(p({},n),{value:"active"})),!(this.options.disableTimeOut===!0||this.options.disableTimeOut==="timeOut")&&this.options.timeOut&&(this.outsideTimeout(()=>this.remove(),this.options.timeOut),this.hideTime=new Date().getTime()+this.options.timeOut,this.options.progressBar&&this.outsideInterval(()=>this.updateProgress(),10))}updateProgress(){if(this.width()===0||this.width()===100||!this.options.timeOut)return;let n=new Date().getTime(),i=this.hideTime-n;this.width.set(i/this.options.timeOut*100),this.options.progressAnimation==="increasing"&&this.width.update(o=>100-o),this.width()<=0&&this.width.set(0),this.width()>=100&&this.width.set(100)}resetTimeout(){clearTimeout(this.timeout),clearInterval(this.intervalId),this.state.update(n=>_(p({},n),{value:"active"})),this.outsideTimeout(()=>this.remove(),this.originalTimeout),this.options.timeOut=this.originalTimeout,this.hideTime=new Date().getTime()+(this.options.timeOut||0),this.width.set(-1),this.options.progressBar&&this.outsideInterval(()=>this.updateProgress(),10)}remove(){this.state().value!=="removed"&&(clearTimeout(this.timeout),this.state.update(n=>_(p({},n),{value:"removed"})),this.outsideTimeout(()=>this.toastrService.remove(this.toastPackage.toastId),+this.toastPackage.config.easeTime))}tapToast(){this.state().value!=="removed"&&(this.toastPackage.triggerTap(),this.options.tapToDismiss&&this.remove())}stickAround(){this.state().value!=="removed"&&this.options.disableTimeOut!=="extendedTimeOut"&&(clearTimeout(this.timeout),this.options.timeOut=0,this.hideTime=0,clearInterval(this.intervalId),this.width.set(0))}delayedHideToast(){this.options.disableTimeOut===!0||this.options.disableTimeOut==="extendedTimeOut"||this.options.extendedTimeOut===0||this.state().value==="removed"||(this.outsideTimeout(()=>this.remove(),this.options.extendedTimeOut),this.options.timeOut=this.options.extendedTimeOut,this.hideTime=new Date().getTime()+(this.options.timeOut||0),this.width.set(-1),this.options.progressBar&&this.outsideInterval(()=>this.updateProgress(),10))}outsideTimeout(n,i){this.ngZone?this.ngZone.runOutsideAngular(()=>this.timeout=setTimeout(()=>this.runInsideAngular(n),i)):this.timeout=setTimeout(()=>n(),i)}outsideInterval(n,i){this.ngZone?this.ngZone.runOutsideAngular(()=>this.intervalId=setInterval(()=>this.runInsideAngular(n),i)):this.intervalId=setInterval(()=>n(),i)}runInsideAngular(n){this.ngZone?this.ngZone.run(()=>n()):n()}static \u0275fac=function(i){return new(i||r)(Ae(to),Ae(eo),Ae(tt))};static \u0275cmp=Yt({type:r,selectors:[["","toast-component",""]],hostVars:5,hostBindings:function(i,o){i&1&&He("click",function(){return o.tapToast()})("mouseenter",function(){return o.stickAround()})("mouseleave",function(){return o.delayedHideToast()}),i&2&&(Wd("@flyInOut",o._state),ir(o.toastClasses),Io("display",o.displayStyle))},standalone:!0,features:[or],attrs:Dy,decls:5,vars:5,consts:[["type","button","class","toast-close-button","aria-label","Close",3,"click",4,"ngIf"],[3,"class",4,"ngIf"],["role","alert",3,"class","innerHTML",4,"ngIf"],["role","alert",3,"class",4,"ngIf"],[4,"ngIf"],["type","button","aria-label","Close",1,"toast-close-button",3,"click"],["aria-hidden","true"],["role","alert",3,"innerHTML"],["role","alert"],[1,"toast-progress"]],template:function(i,o){i&1&&ln(0,T1,3,0,"button",0)(1,R1,3,5,"div",1)(2,M1,1,3,"div",2)(3,k1,2,4,"div",3)(4,D1,2,2,"div",4),i&2&&(Ce("ngIf",o.options.closeButton),pe(),Ce("ngIf",o.title),pe(),Ce("ngIf",o.message&&o.options.enableHtml),pe(),Ce("ngIf",o.message&&!o.options.enableHtml),pe(),Ce("ngIf",o.options.progressBar))},dependencies:[rc],encapsulation:2,data:{animation:[op("flyInOut",[Ra("inactive",Sa({opacity:0})),Ra("active",Sa({opacity:1})),Ra("removed",Sa({opacity:0})),oc("inactive => active",ic("{{ easeTime }}ms {{ easing }}")),oc("active => removed",ic("{{ easeTime }}ms {{ easing }}"))])]},changeDetection:0})}return r})(),q1=_(p({},Ny),{toastComponent:B1}),Fy=(r={})=>er([{provide:jy,useValue:{default:q1,config:r}}]);var G1=(()=>{class r{toastrService;toastPackage;appRef;message;title;options;duplicatesCount;originalTimeout;width=nr(-1);toastClasses="";get displayStyle(){return this.state()==="inactive"?"none":null}state=nr("inactive");timeout;intervalId;hideTime;sub;sub1;sub2;sub3;constructor(n,i,o){this.toastrService=n,this.toastPackage=i,this.appRef=o,this.message=i.message,this.title=i.title,this.options=i.config,this.originalTimeout=i.config.timeOut,this.toastClasses=`${i.toastType} ${i.config.toastClass}`,this.sub=i.toastRef.afterActivate().subscribe(()=>{this.activateToast()}),this.sub1=i.toastRef.manualClosed().subscribe(()=>{this.remove()}),this.sub2=i.toastRef.timeoutReset().subscribe(()=>{this.resetTimeout()}),this.sub3=i.toastRef.countDuplicate().subscribe(s=>{this.duplicatesCount=s})}ngOnDestroy(){this.sub.unsubscribe(),this.sub1.unsubscribe(),this.sub2.unsubscribe(),this.sub3.unsubscribe(),clearInterval(this.intervalId),clearTimeout(this.timeout)}activateToast(){this.state.set("active"),!(this.options.disableTimeOut===!0||this.options.disableTimeOut==="timeOut")&&this.options.timeOut&&(this.timeout=setTimeout(()=>{this.remove()},this.options.timeOut),this.hideTime=new Date().getTime()+this.options.timeOut,this.options.progressBar&&(this.intervalId=setInterval(()=>this.updateProgress(),10))),this.options.onActivateTick&&this.appRef.tick()}updateProgress(){if(this.width()===0||this.width()===100||!this.options.timeOut)return;let n=new Date().getTime(),i=this.hideTime-n;this.width.set(i/this.options.timeOut*100),this.options.progressAnimation==="increasing"&&this.width.update(o=>100-o),this.width()<=0&&this.width.set(0),this.width()>=100&&this.width.set(100)}resetTimeout(){clearTimeout(this.timeout),clearInterval(this.intervalId),this.state.set("active"),this.options.timeOut=this.originalTimeout,this.timeout=setTimeout(()=>this.remove(),this.originalTimeout),this.hideTime=new Date().getTime()+(this.originalTimeout||0),this.width.set(-1),this.options.progressBar&&(this.intervalId=setInterval(()=>this.updateProgress(),10))}remove(){this.state()!=="removed"&&(clearTimeout(this.timeout),this.state.set("removed"),this.timeout=setTimeout(()=>this.toastrService.remove(this.toastPackage.toastId)))}tapToast(){this.state()!=="removed"&&(this.toastPackage.triggerTap(),this.options.tapToDismiss&&this.remove())}stickAround(){this.state()!=="removed"&&(clearTimeout(this.timeout),this.options.timeOut=0,this.hideTime=0,clearInterval(this.intervalId),this.width.set(0))}delayedHideToast(){this.options.disableTimeOut===!0||this.options.disableTimeOut==="extendedTimeOut"||this.options.extendedTimeOut===0||this.state()==="removed"||(this.timeout=setTimeout(()=>this.remove(),this.options.extendedTimeOut),this.options.timeOut=this.options.extendedTimeOut,this.hideTime=new Date().getTime()+(this.options.timeOut||0),this.width.set(-1),this.options.progressBar&&(this.intervalId=setInterval(()=>this.updateProgress(),10)))}static \u0275fac=function(i){return new(i||r)(Ae(to),Ae(eo),Ae(Ir))};static \u0275cmp=Yt({type:r,selectors:[["","toast-component",""]],hostVars:4,hostBindings:function(i,o){i&1&&He("click",function(){return o.tapToast()})("mouseenter",function(){return o.stickAround()})("mouseleave",function(){return o.delayedHideToast()}),i&2&&(ir(o.toastClasses),Io("display",o.displayStyle))},standalone:!0,features:[or],attrs:Dy,decls:5,vars:5,consts:[["type","button","class","toast-close-button","aria-label","Close",3,"click",4,"ngIf"],[3,"class",4,"ngIf"],["role","alert",3,"class","innerHTML",4,"ngIf"],["role","alert",3,"class",4,"ngIf"],[4,"ngIf"],["type","button","aria-label","Close",1,"toast-close-button",3,"click"],["aria-hidden","true"],["role","alert",3,"innerHTML"],["role","alert"],[1,"toast-progress"]],template:function(i,o){i&1&&ln(0,N1,3,0,"button",0)(1,F1,3,5,"div",1)(2,z1,1,3,"div",2)(3,$1,2,4,"div",3)(4,L1,2,2,"div",4),i&2&&(Ce("ngIf",o.options.closeButton),pe(),Ce("ngIf",o.title),pe(),Ce("ngIf",o.message&&o.options.enableHtml),pe(),Ce("ngIf",o.message&&!o.options.enableHtml),pe(),Ce("ngIf",o.options.progressBar))},dependencies:[rc],encapsulation:2,changeDetection:0})}return r})(),vV=_(p({},Ny),{toastComponent:G1});var Vu=class r{constructor(e,n){this.http=e;this.toastr=n}htmlToImageCopy(e){ky(e).then(n=>{if(n){let i=new ClipboardItem({"image/png":n});navigator.clipboard.write([i]),this.toastr.success("Graph copied to clipboard!","Success")}}).catch(n=>{console.error("oops, something went wrong!",n)})}static \u0275fac=function(n){return new(n||r)(J(xc),J(to))};static \u0275prov=W({token:r,factory:r.\u0275fac,providedIn:"root"})};var Bu=class r{constructor(){}setItem(e,n){localStorage.setItem(e,JSON.stringify(n))}getItem(e){let n=localStorage.getItem(e);return n?JSON.parse(n):null}removeItem(e){localStorage.removeItem(e)}clear(){localStorage.clear()}static \u0275fac=function(n){return new(n||r)};static \u0275prov=W({token:r,factory:r.\u0275fac,providedIn:"root"})};var qu="http://www.w3.org/1999/xhtml",_h={svg:"http://www.w3.org/2000/svg",xhtml:qu,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function gr(r){var e=r+="",n=e.indexOf(":");return n>=0&&(e=r.slice(0,n))!=="xmlns"&&(r=r.slice(n+1)),_h.hasOwnProperty(e)?{space:_h[e],local:r}:r}function W1(r){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===qu&&e.documentElement.namespaceURI===qu?e.createElement(r):e.createElementNS(n,r)}}function K1(r){return function(){return this.ownerDocument.createElementNS(r.space,r.local)}}function Gu(r){var e=gr(r);return(e.local?K1:W1)(e)}function Z1(){}function ni(r){return r==null?Z1:function(){return this.querySelector(r)}}function zy(r){typeof r!="function"&&(r=ni(r));for(var e=this._groups,n=e.length,i=new Array(n),o=0;o<n;++o)for(var s=e[o],a=s.length,u=i[o]=new Array(a),l,c,f=0;f<a;++f)(l=s[f])&&(c=r.call(l,l.__data__,f,s))&&("__data__"in l&&(c.__data__=l.__data__),u[f]=c);return new we(i,this._parents)}function wh(r){return r==null?[]:Array.isArray(r)?r:Array.from(r)}function X1(){return[]}function Ss(r){return r==null?X1:function(){return this.querySelectorAll(r)}}function J1(r){return function(){return wh(r.apply(this,arguments))}}function $y(r){typeof r=="function"?r=J1(r):r=Ss(r);for(var e=this._groups,n=e.length,i=[],o=[],s=0;s<n;++s)for(var a=e[s],u=a.length,l,c=0;c<u;++c)(l=a[c])&&(i.push(r.call(l,l.__data__,c,a)),o.push(l));return new we(i,o)}function Rs(r){return function(){return this.matches(r)}}function Hu(r){return function(e){return e.matches(r)}}var Y1=Array.prototype.find;function Q1(r){return function(){return Y1.call(this.children,r)}}function eE(){return this.firstElementChild}function Ly(r){return this.select(r==null?eE:Q1(typeof r=="function"?r:Hu(r)))}var tE=Array.prototype.filter;function rE(){return Array.from(this.children)}function nE(r){return function(){return tE.call(this.children,r)}}function Uy(r){return this.selectAll(r==null?rE:nE(typeof r=="function"?r:Hu(r)))}function Vy(r){typeof r!="function"&&(r=Rs(r));for(var e=this._groups,n=e.length,i=new Array(n),o=0;o<n;++o)for(var s=e[o],a=s.length,u=i[o]=[],l,c=0;c<a;++c)(l=s[c])&&r.call(l,l.__data__,c,s)&&u.push(l);return new we(i,this._parents)}function Wu(r){return new Array(r.length)}function By(){return new we(this._enter||this._groups.map(Wu),this._parents)}function Ms(r,e){this.ownerDocument=r.ownerDocument,this.namespaceURI=r.namespaceURI,this._next=null,this._parent=r,this.__data__=e}Ms.prototype={constructor:Ms,appendChild:function(r){return this._parent.insertBefore(r,this._next)},insertBefore:function(r,e){return this._parent.insertBefore(r,e)},querySelector:function(r){return this._parent.querySelector(r)},querySelectorAll:function(r){return this._parent.querySelectorAll(r)}};function qy(r){return function(){return r}}function iE(r,e,n,i,o,s){for(var a=0,u,l=e.length,c=s.length;a<c;++a)(u=e[a])?(u.__data__=s[a],i[a]=u):n[a]=new Ms(r,s[a]);for(;a<l;++a)(u=e[a])&&(o[a]=u)}function oE(r,e,n,i,o,s,a){var u,l,c=new Map,f=e.length,h=s.length,d=new Array(f),m;for(u=0;u<f;++u)(l=e[u])&&(d[u]=m=a.call(l,l.__data__,u,e)+"",c.has(m)?o[u]=l:c.set(m,l));for(u=0;u<h;++u)m=a.call(r,s[u],u,s)+"",(l=c.get(m))?(i[u]=l,l.__data__=s[u],c.delete(m)):n[u]=new Ms(r,s[u]);for(u=0;u<f;++u)(l=e[u])&&c.get(d[u])===l&&(o[u]=l)}function sE(r){return r.__data__}function Gy(r,e){if(!arguments.length)return Array.from(this,sE);var n=e?oE:iE,i=this._parents,o=this._groups;typeof r!="function"&&(r=qy(r));for(var s=o.length,a=new Array(s),u=new Array(s),l=new Array(s),c=0;c<s;++c){var f=i[c],h=o[c],d=h.length,m=aE(r.call(f,f&&f.__data__,c,i)),y=m.length,b=u[c]=new Array(y),v=a[c]=new Array(y),g=l[c]=new Array(d);n(f,h,b,v,g,m,e);for(var A=0,E=0,w,x;A<y;++A)if(w=b[A]){for(A>=E&&(E=A+1);!(x=v[E])&&++E<y;);w._next=x||null}}return a=new we(a,i),a._enter=u,a._exit=l,a}function aE(r){return typeof r=="object"&&"length"in r?r:Array.from(r)}function Hy(){return new we(this._exit||this._groups.map(Wu),this._parents)}function Wy(r,e,n){var i=this.enter(),o=this,s=this.exit();return typeof r=="function"?(i=r(i),i&&(i=i.selection())):i=i.append(r+""),e!=null&&(o=e(o),o&&(o=o.selection())),n==null?s.remove():n(s),i&&o?i.merge(o).order():o}function Ky(r){for(var e=r.selection?r.selection():r,n=this._groups,i=e._groups,o=n.length,s=i.length,a=Math.min(o,s),u=new Array(o),l=0;l<a;++l)for(var c=n[l],f=i[l],h=c.length,d=u[l]=new Array(h),m,y=0;y<h;++y)(m=c[y]||f[y])&&(d[y]=m);for(;l<o;++l)u[l]=n[l];return new we(u,this._parents)}function Zy(){for(var r=this._groups,e=-1,n=r.length;++e<n;)for(var i=r[e],o=i.length-1,s=i[o],a;--o>=0;)(a=i[o])&&(s&&a.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(a,s),s=a);return this}function Xy(r){r||(r=uE);function e(h,d){return h&&d?r(h.__data__,d.__data__):!h-!d}for(var n=this._groups,i=n.length,o=new Array(i),s=0;s<i;++s){for(var a=n[s],u=a.length,l=o[s]=new Array(u),c,f=0;f<u;++f)(c=a[f])&&(l[f]=c);l.sort(e)}return new we(o,this._parents).order()}function uE(r,e){return r<e?-1:r>e?1:r>=e?0:NaN}function Jy(){var r=arguments[0];return arguments[0]=this,r.apply(null,arguments),this}function Yy(){return Array.from(this)}function Qy(){for(var r=this._groups,e=0,n=r.length;e<n;++e)for(var i=r[e],o=0,s=i.length;o<s;++o){var a=i[o];if(a)return a}return null}function ev(){let r=0;for(let e of this)++r;return r}function tv(){return!this.node()}function rv(r){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var o=e[n],s=0,a=o.length,u;s<a;++s)(u=o[s])&&r.call(u,u.__data__,s,o);return this}function lE(r){return function(){this.removeAttribute(r)}}function cE(r){return function(){this.removeAttributeNS(r.space,r.local)}}function fE(r,e){return function(){this.setAttribute(r,e)}}function hE(r,e){return function(){this.setAttributeNS(r.space,r.local,e)}}function dE(r,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(r):this.setAttribute(r,n)}}function pE(r,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(r.space,r.local):this.setAttributeNS(r.space,r.local,n)}}function nv(r,e){var n=gr(r);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((e==null?n.local?cE:lE:typeof e=="function"?n.local?pE:dE:n.local?hE:fE)(n,e))}function Ku(r){return r.ownerDocument&&r.ownerDocument.defaultView||r.document&&r||r.defaultView}function mE(r){return function(){this.style.removeProperty(r)}}function gE(r,e,n){return function(){this.style.setProperty(r,e,n)}}function yE(r,e,n){return function(){var i=e.apply(this,arguments);i==null?this.style.removeProperty(r):this.style.setProperty(r,i,n)}}function iv(r,e,n){return arguments.length>1?this.each((e==null?mE:typeof e=="function"?yE:gE)(r,e,n??"")):Xr(this.node(),r)}function Xr(r,e){return r.style.getPropertyValue(e)||Ku(r).getComputedStyle(r,null).getPropertyValue(e)}function vE(r){return function(){delete this[r]}}function bE(r,e){return function(){this[r]=e}}function _E(r,e){return function(){var n=e.apply(this,arguments);n==null?delete this[r]:this[r]=n}}function ov(r,e){return arguments.length>1?this.each((e==null?vE:typeof e=="function"?_E:bE)(r,e)):this.node()[r]}function sv(r){return r.trim().split(/^|\s+/)}function xh(r){return r.classList||new av(r)}function av(r){this._node=r,this._names=sv(r.getAttribute("class")||"")}av.prototype={add:function(r){var e=this._names.indexOf(r);e<0&&(this._names.push(r),this._node.setAttribute("class",this._names.join(" ")))},remove:function(r){var e=this._names.indexOf(r);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(r){return this._names.indexOf(r)>=0}};function uv(r,e){for(var n=xh(r),i=-1,o=e.length;++i<o;)n.add(e[i])}function lv(r,e){for(var n=xh(r),i=-1,o=e.length;++i<o;)n.remove(e[i])}function wE(r){return function(){uv(this,r)}}function xE(r){return function(){lv(this,r)}}function AE(r,e){return function(){(e.apply(this,arguments)?uv:lv)(this,r)}}function cv(r,e){var n=sv(r+"");if(arguments.length<2){for(var i=xh(this.node()),o=-1,s=n.length;++o<s;)if(!i.contains(n[o]))return!1;return!0}return this.each((typeof e=="function"?AE:e?wE:xE)(n,e))}function CE(){this.textContent=""}function IE(r){return function(){this.textContent=r}}function EE(r){return function(){var e=r.apply(this,arguments);this.textContent=e??""}}function fv(r){return arguments.length?this.each(r==null?CE:(typeof r=="function"?EE:IE)(r)):this.node().textContent}function OE(){this.innerHTML=""}function PE(r){return function(){this.innerHTML=r}}function TE(r){return function(){var e=r.apply(this,arguments);this.innerHTML=e??""}}function hv(r){return arguments.length?this.each(r==null?OE:(typeof r=="function"?TE:PE)(r)):this.node().innerHTML}function SE(){this.nextSibling&&this.parentNode.appendChild(this)}function dv(){return this.each(SE)}function RE(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function pv(){return this.each(RE)}function mv(r){var e=typeof r=="function"?r:Gu(r);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function ME(){return null}function gv(r,e){var n=typeof r=="function"?r:Gu(r),i=e==null?ME:typeof e=="function"?e:ni(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)})}function kE(){var r=this.parentNode;r&&r.removeChild(this)}function yv(){return this.each(kE)}function DE(){var r=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(r,this.nextSibling):r}function NE(){var r=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(r,this.nextSibling):r}function vv(r){return this.select(r?NE:DE)}function bv(r){return arguments.length?this.property("__data__",r):this.node().__data__}function jE(r){return function(e){r.call(this,e,this.__data__)}}function FE(r){return r.trim().split(/^|\s+/).map(function(e){var n="",i=e.indexOf(".");return i>=0&&(n=e.slice(i+1),e=e.slice(0,i)),{type:e,name:n}})}function zE(r){return function(){var e=this.__on;if(e){for(var n=0,i=-1,o=e.length,s;n<o;++n)s=e[n],(!r.type||s.type===r.type)&&s.name===r.name?this.removeEventListener(s.type,s.listener,s.options):e[++i]=s;++i?e.length=i:delete this.__on}}}function $E(r,e,n){return function(){var i=this.__on,o,s=jE(e);if(i){for(var a=0,u=i.length;a<u;++a)if((o=i[a]).type===r.type&&o.name===r.name){this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=s,o.options=n),o.value=e;return}}this.addEventListener(r.type,s,n),o={type:r.type,name:r.name,value:e,listener:s,options:n},i?i.push(o):this.__on=[o]}}function _v(r,e,n){var i=FE(r+""),o,s=i.length,a;if(arguments.length<2){var u=this.node().__on;if(u){for(var l=0,c=u.length,f;l<c;++l)for(o=0,f=u[l];o<s;++o)if((a=i[o]).type===f.type&&a.name===f.name)return f.value}return}for(u=e?$E:zE,o=0;o<s;++o)this.each(u(i[o],e,n));return this}function wv(r,e,n){var i=Ku(r),o=i.CustomEvent;typeof o=="function"?o=new o(e,n):(o=i.document.createEvent("Event"),n?(o.initEvent(e,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(e,!1,!1)),r.dispatchEvent(o)}function LE(r,e){return function(){return wv(this,r,e)}}function UE(r,e){return function(){return wv(this,r,e.apply(this,arguments))}}function xv(r,e){return this.each((typeof e=="function"?UE:LE)(r,e))}function*Av(){for(var r=this._groups,e=0,n=r.length;e<n;++e)for(var i=r[e],o=0,s=i.length,a;o<s;++o)(a=i[o])&&(yield a)}var Ah=[null];function we(r,e){this._groups=r,this._parents=e}function Cv(){return new we([[document.documentElement]],Ah)}function VE(){return this}we.prototype=Cv.prototype={constructor:we,select:zy,selectAll:$y,selectChild:Ly,selectChildren:Uy,filter:Vy,data:Gy,enter:By,exit:Hy,join:Wy,merge:Ky,selection:VE,order:Zy,sort:Xy,call:Jy,nodes:Yy,node:Qy,size:ev,empty:tv,each:rv,attr:nv,style:iv,property:ov,classed:cv,text:fv,html:hv,raise:dv,lower:pv,append:mv,insert:gv,remove:yv,clone:vv,datum:bv,on:_v,dispatch:xv,[Symbol.iterator]:Av};var yr=Cv;function Ve(r){return typeof r=="string"?new we([[document.querySelector(r)]],[document.documentElement]):new we([[r]],Ah)}function Iv(r){let e;for(;e=r.sourceEvent;)r=e;return r}function yt(r,e){if(r=Iv(r),e===void 0&&(e=r.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=r.clientX,i.y=r.clientY,i=i.matrixTransform(e.getScreenCTM().inverse()),[i.x,i.y]}if(e.getBoundingClientRect){var o=e.getBoundingClientRect();return[r.clientX-o.left-e.clientLeft,r.clientY-o.top-e.clientTop]}}return[r.pageX,r.pageY]}var BE={value:()=>{}};function Ov(){for(var r=0,e=arguments.length,n={},i;r<e;++r){if(!(i=arguments[r]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new Zu(n)}function Zu(r){this._=r}function qE(r,e){return r.trim().split(/^|\s+/).map(function(n){var i="",o=n.indexOf(".");if(o>=0&&(i=n.slice(o+1),n=n.slice(0,o)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:i}})}Zu.prototype=Ov.prototype={constructor:Zu,on:function(r,e){var n=this._,i=qE(r+"",n),o,s=-1,a=i.length;if(arguments.length<2){for(;++s<a;)if((o=(r=i[s]).type)&&(o=GE(n[o],r.name)))return o;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++s<a;)if(o=(r=i[s]).type)n[o]=Ev(n[o],r.name,e);else if(e==null)for(o in n)n[o]=Ev(n[o],r.name,null);return this},copy:function(){var r={},e=this._;for(var n in e)r[n]=e[n].slice();return new Zu(r)},call:function(r,e){if((o=arguments.length-2)>0)for(var n=new Array(o),i=0,o,s;i<o;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(s=this._[r],i=0,o=s.length;i<o;++i)s[i].value.apply(e,n)},apply:function(r,e,n){if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(var i=this._[r],o=0,s=i.length;o<s;++o)i[o].value.apply(e,n)}};function GE(r,e){for(var n=0,i=r.length,o;n<i;++n)if((o=r[n]).name===e)return o.value}function Ev(r,e,n){for(var i=0,o=r.length;i<o;++i)if(r[i].name===e){r[i]=BE,r=r.slice(0,i).concat(r.slice(i+1));break}return n!=null&&r.push({name:e,value:n}),r}var vr=Ov;var Pv={passive:!1},ii={capture:!0,passive:!1};function Xu(r){r.stopImmediatePropagation()}function Jr(r){r.preventDefault(),r.stopImmediatePropagation()}function ks(r){var e=r.document.documentElement,n=Ve(r).on("dragstart.drag",Jr,ii);"onselectstart"in e?n.on("selectstart.drag",Jr,ii):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function Ds(r,e){var n=r.document.documentElement,i=Ve(r).on("dragstart.drag",null);e&&(i.on("click.drag",Jr,ii),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}var Ns=r=>()=>r;function js(r,{sourceEvent:e,subject:n,target:i,identifier:o,active:s,x:a,y:u,dx:l,dy:c,dispatch:f}){Object.defineProperties(this,{type:{value:r,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},identifier:{value:o,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:u,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:f}})}js.prototype.on=function(){var r=this._.on.apply(this._,arguments);return r===this._?this:r};function HE(r){return!r.ctrlKey&&!r.button}function WE(){return this.parentNode}function KE(r,e){return e??{x:r.x,y:r.y}}function ZE(){return navigator.maxTouchPoints||"ontouchstart"in this}function Ch(){var r=HE,e=WE,n=KE,i=ZE,o={},s=vr("start","drag","end"),a=0,u,l,c,f,h=0;function d(w){w.on("mousedown.drag",m).filter(i).on("touchstart.drag",v).on("touchmove.drag",g,Pv).on("touchend.drag touchcancel.drag",A).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function m(w,x){if(!(f||!r.call(this,w,x))){var C=E(this,e.call(this,w,x),w,x,"mouse");C&&(Ve(w.view).on("mousemove.drag",y,ii).on("mouseup.drag",b,ii),ks(w.view),Xu(w),c=!1,u=w.clientX,l=w.clientY,C("start",w))}}function y(w){if(Jr(w),!c){var x=w.clientX-u,C=w.clientY-l;c=x*x+C*C>h}o.mouse("drag",w)}function b(w){Ve(w.view).on("mousemove.drag mouseup.drag",null),Ds(w.view,c),Jr(w),o.mouse("end",w)}function v(w,x){if(r.call(this,w,x)){var C=w.changedTouches,O=e.call(this,w,x),T=C.length,M,D;for(M=0;M<T;++M)(D=E(this,O,w,x,C[M].identifier,C[M]))&&(Xu(w),D("start",w,C[M]))}}function g(w){var x=w.changedTouches,C=x.length,O,T;for(O=0;O<C;++O)(T=o[x[O].identifier])&&(Jr(w),T("drag",w,x[O]))}function A(w){var x=w.changedTouches,C=x.length,O,T;for(f&&clearTimeout(f),f=setTimeout(function(){f=null},500),O=0;O<C;++O)(T=o[x[O].identifier])&&(Xu(w),T("end",w,x[O]))}function E(w,x,C,O,T,M){var D=s.copy(),z=yt(M||C,x),L,Q,P;if((P=n.call(w,new js("beforestart",{sourceEvent:C,target:d,identifier:T,active:a,x:z[0],y:z[1],dx:0,dy:0,dispatch:D}),O))!=null)return L=P.x-z[0]||0,Q=P.y-z[1]||0,function k(S,N,U){var Z=z,X;switch(S){case"start":o[T]=k,X=a++;break;case"end":delete o[T],--a;case"drag":z=yt(U||N,x),X=a;break}D.call(S,w,new js(S,{sourceEvent:N,subject:P,target:d,identifier:T,active:X,x:z[0]+L,y:z[1]+Q,dx:z[0]-Z[0],dy:z[1]-Z[1],dispatch:D}),O)}}return d.filter=function(w){return arguments.length?(r=typeof w=="function"?w:Ns(!!w),d):r},d.container=function(w){return arguments.length?(e=typeof w=="function"?w:Ns(w),d):e},d.subject=function(w){return arguments.length?(n=typeof w=="function"?w:Ns(w),d):n},d.touchable=function(w){return arguments.length?(i=typeof w=="function"?w:Ns(!!w),d):i},d.on=function(){var w=s.on.apply(s,arguments);return w===s?d:w},d.clickDistance=function(w){return arguments.length?(h=(w=+w)*w,d):Math.sqrt(h)},d}function Ju(r,e,n){r.prototype=e.prototype=n,n.constructor=r}function Ih(r,e){var n=Object.create(r.prototype);for(var i in e)n[i]=e[i];return n}function $s(){}var Fs=.7,el=1/Fs,ro="\\s*([+-]?\\d+)\\s*",zs="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Kt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",XE=/^#([0-9a-f]{3,8})$/,JE=new RegExp(`^rgb\\(${ro},${ro},${ro}\\)$`),YE=new RegExp(`^rgb\\(${Kt},${Kt},${Kt}\\)$`),QE=new RegExp(`^rgba\\(${ro},${ro},${ro},${zs}\\)$`),eO=new RegExp(`^rgba\\(${Kt},${Kt},${Kt},${zs}\\)$`),tO=new RegExp(`^hsl\\(${zs},${Kt},${Kt}\\)$`),rO=new RegExp(`^hsla\\(${zs},${Kt},${Kt},${zs}\\)$`),Tv={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Ju($s,Yr,{copy(r){return Object.assign(new this.constructor,this,r)},displayable(){return this.rgb().displayable()},hex:Sv,formatHex:Sv,formatHex8:nO,formatHsl:iO,formatRgb:Rv,toString:Rv});function Sv(){return this.rgb().formatHex()}function nO(){return this.rgb().formatHex8()}function iO(){return Fv(this).formatHsl()}function Rv(){return this.rgb().formatRgb()}function Yr(r){var e,n;return r=(r+"").trim().toLowerCase(),(e=XE.exec(r))?(n=e[1].length,e=parseInt(e[1],16),n===6?Mv(e):n===3?new Qe(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?Yu(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?Yu(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=JE.exec(r))?new Qe(e[1],e[2],e[3],1):(e=YE.exec(r))?new Qe(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=QE.exec(r))?Yu(e[1],e[2],e[3],e[4]):(e=eO.exec(r))?Yu(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=tO.exec(r))?Nv(e[1],e[2]/100,e[3]/100,1):(e=rO.exec(r))?Nv(e[1],e[2]/100,e[3]/100,e[4]):Tv.hasOwnProperty(r)?Mv(Tv[r]):r==="transparent"?new Qe(NaN,NaN,NaN,0):null}function Mv(r){return new Qe(r>>16&255,r>>8&255,r&255,1)}function Yu(r,e,n,i){return i<=0&&(r=e=n=NaN),new Qe(r,e,n,i)}function oO(r){return r instanceof $s||(r=Yr(r)),r?(r=r.rgb(),new Qe(r.r,r.g,r.b,r.opacity)):new Qe}function no(r,e,n,i){return arguments.length===1?oO(r):new Qe(r,e,n,i??1)}function Qe(r,e,n,i){this.r=+r,this.g=+e,this.b=+n,this.opacity=+i}Ju(Qe,no,Ih($s,{brighter(r){return r=r==null?el:Math.pow(el,r),new Qe(this.r*r,this.g*r,this.b*r,this.opacity)},darker(r){return r=r==null?Fs:Math.pow(Fs,r),new Qe(this.r*r,this.g*r,this.b*r,this.opacity)},rgb(){return this},clamp(){return new Qe(si(this.r),si(this.g),si(this.b),tl(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:kv,formatHex:kv,formatHex8:sO,formatRgb:Dv,toString:Dv}));function kv(){return`#${oi(this.r)}${oi(this.g)}${oi(this.b)}`}function sO(){return`#${oi(this.r)}${oi(this.g)}${oi(this.b)}${oi((isNaN(this.opacity)?1:this.opacity)*255)}`}function Dv(){let r=tl(this.opacity);return`${r===1?"rgb(":"rgba("}${si(this.r)}, ${si(this.g)}, ${si(this.b)}${r===1?")":`, ${r})`}`}function tl(r){return isNaN(r)?1:Math.max(0,Math.min(1,r))}function si(r){return Math.max(0,Math.min(255,Math.round(r)||0))}function oi(r){return r=si(r),(r<16?"0":"")+r.toString(16)}function Nv(r,e,n,i){return i<=0?r=e=n=NaN:n<=0||n>=1?r=e=NaN:e<=0&&(r=NaN),new jt(r,e,n,i)}function Fv(r){if(r instanceof jt)return new jt(r.h,r.s,r.l,r.opacity);if(r instanceof $s||(r=Yr(r)),!r)return new jt;if(r instanceof jt)return r;r=r.rgb();var e=r.r/255,n=r.g/255,i=r.b/255,o=Math.min(e,n,i),s=Math.max(e,n,i),a=NaN,u=s-o,l=(s+o)/2;return u?(e===s?a=(n-i)/u+(n<i)*6:n===s?a=(i-e)/u+2:a=(e-n)/u+4,u/=l<.5?s+o:2-s-o,a*=60):u=l>0&&l<1?0:a,new jt(a,u,l,r.opacity)}function zv(r,e,n,i){return arguments.length===1?Fv(r):new jt(r,e,n,i??1)}function jt(r,e,n,i){this.h=+r,this.s=+e,this.l=+n,this.opacity=+i}Ju(jt,zv,Ih($s,{brighter(r){return r=r==null?el:Math.pow(el,r),new jt(this.h,this.s,this.l*r,this.opacity)},darker(r){return r=r==null?Fs:Math.pow(Fs,r),new jt(this.h,this.s,this.l*r,this.opacity)},rgb(){var r=this.h%360+(this.h<0)*360,e=isNaN(r)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,o=2*n-i;return new Qe(Eh(r>=240?r-240:r+120,o,i),Eh(r,o,i),Eh(r<120?r+240:r-120,o,i),this.opacity)},clamp(){return new jt(jv(this.h),Qu(this.s),Qu(this.l),tl(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let r=tl(this.opacity);return`${r===1?"hsl(":"hsla("}${jv(this.h)}, ${Qu(this.s)*100}%, ${Qu(this.l)*100}%${r===1?")":`, ${r})`}`}}));function jv(r){return r=(r||0)%360,r<0?r+360:r}function Qu(r){return Math.max(0,Math.min(1,r||0))}function Eh(r,e,n){return(r<60?e+(n-e)*r/60:r<180?n:r<240?e+(n-e)*(240-r)/60:e)*255}function Oh(r,e,n,i,o){var s=r*r,a=s*r;return((1-3*r+3*s-a)*e+(4-6*s+3*a)*n+(1+3*r+3*s-3*a)*i+a*o)/6}function $v(r){var e=r.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),o=r[i],s=r[i+1],a=i>0?r[i-1]:2*o-s,u=i<e-1?r[i+2]:2*s-o;return Oh((n-i/e)*e,a,o,s,u)}}function Lv(r){var e=r.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*e),o=r[(i+e-1)%e],s=r[i%e],a=r[(i+1)%e],u=r[(i+2)%e];return Oh((n-i/e)*e,o,s,a,u)}}var Ph=r=>()=>r;function aO(r,e){return function(n){return r+n*e}}function uO(r,e,n){return r=Math.pow(r,n),e=Math.pow(e,n)-r,n=1/n,function(i){return Math.pow(r+i*e,n)}}function Uv(r){return(r=+r)==1?rl:function(e,n){return n-e?uO(e,n,r):Ph(isNaN(e)?n:e)}}function rl(r,e){var n=e-r;return n?aO(r,n):Ph(isNaN(r)?e:r)}var nl=function r(e){var n=Uv(e);function i(o,s){var a=n((o=no(o)).r,(s=no(s)).r),u=n(o.g,s.g),l=n(o.b,s.b),c=rl(o.opacity,s.opacity);return function(f){return o.r=a(f),o.g=u(f),o.b=l(f),o.opacity=c(f),o+""}}return i.gamma=r,i}(1);function Vv(r){return function(e){var n=e.length,i=new Array(n),o=new Array(n),s=new Array(n),a,u;for(a=0;a<n;++a)u=no(e[a]),i[a]=u.r||0,o[a]=u.g||0,s[a]=u.b||0;return i=r(i),o=r(o),s=r(s),u.opacity=1,function(l){return u.r=i(l),u.g=o(l),u.b=s(l),u+""}}}var lO=Vv($v),cO=Vv(Lv);function vt(r,e){return r=+r,e=+e,function(n){return r*(1-n)+e*n}}var Sh=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Th=new RegExp(Sh.source,"g");function fO(r){return function(){return r}}function hO(r){return function(e){return r(e)+""}}function Rh(r,e){var n=Sh.lastIndex=Th.lastIndex=0,i,o,s,a=-1,u=[],l=[];for(r=r+"",e=e+"";(i=Sh.exec(r))&&(o=Th.exec(e));)(s=o.index)>n&&(s=e.slice(n,s),u[a]?u[a]+=s:u[++a]=s),(i=i[0])===(o=o[0])?u[a]?u[a]+=o:u[++a]=o:(u[++a]=null,l.push({i:a,x:vt(i,o)})),n=Th.lastIndex;return n<e.length&&(s=e.slice(n),u[a]?u[a]+=s:u[++a]=s),u.length<2?l[0]?hO(l[0].x):fO(e):(e=l.length,function(c){for(var f=0,h;f<e;++f)u[(h=l[f]).i]=h.x(c);return u.join("")})}var Bv=180/Math.PI,il={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Mh(r,e,n,i,o,s){var a,u,l;return(a=Math.sqrt(r*r+e*e))&&(r/=a,e/=a),(l=r*n+e*i)&&(n-=r*l,i-=e*l),(u=Math.sqrt(n*n+i*i))&&(n/=u,i/=u,l/=u),r*i<e*n&&(r=-r,e=-e,l=-l,a=-a),{translateX:o,translateY:s,rotate:Math.atan2(e,r)*Bv,skewX:Math.atan(l)*Bv,scaleX:a,scaleY:u}}var ol;function qv(r){let e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(r+"");return e.isIdentity?il:Mh(e.a,e.b,e.c,e.d,e.e,e.f)}function Gv(r){return r==null?il:(ol||(ol=document.createElementNS("http://www.w3.org/2000/svg","g")),ol.setAttribute("transform",r),(r=ol.transform.baseVal.consolidate())?(r=r.matrix,Mh(r.a,r.b,r.c,r.d,r.e,r.f)):il)}function Hv(r,e,n,i){function o(c){return c.length?c.pop()+" ":""}function s(c,f,h,d,m,y){if(c!==h||f!==d){var b=m.push("translate(",null,e,null,n);y.push({i:b-4,x:vt(c,h)},{i:b-2,x:vt(f,d)})}else(h||d)&&m.push("translate("+h+e+d+n)}function a(c,f,h,d){c!==f?(c-f>180?f+=360:f-c>180&&(c+=360),d.push({i:h.push(o(h)+"rotate(",null,i)-2,x:vt(c,f)})):f&&h.push(o(h)+"rotate("+f+i)}function u(c,f,h,d){c!==f?d.push({i:h.push(o(h)+"skewX(",null,i)-2,x:vt(c,f)}):f&&h.push(o(h)+"skewX("+f+i)}function l(c,f,h,d,m,y){if(c!==h||f!==d){var b=m.push(o(m)+"scale(",null,",",null,")");y.push({i:b-4,x:vt(c,h)},{i:b-2,x:vt(f,d)})}else(h!==1||d!==1)&&m.push(o(m)+"scale("+h+","+d+")")}return function(c,f){var h=[],d=[];return c=r(c),f=r(f),s(c.translateX,c.translateY,f.translateX,f.translateY,h,d),a(c.rotate,f.rotate,h,d),u(c.skewX,f.skewX,h,d),l(c.scaleX,c.scaleY,f.scaleX,f.scaleY,h,d),c=f=null,function(m){for(var y=-1,b=d.length,v;++y<b;)h[(v=d[y]).i]=v.x(m);return h.join("")}}}var kh=Hv(qv,"px, ","px)","deg)"),Dh=Hv(Gv,", ",")",")");var dO=1e-12;function Wv(r){return((r=Math.exp(r))+1/r)/2}function pO(r){return((r=Math.exp(r))-1/r)/2}function mO(r){return((r=Math.exp(2*r))-1)/(r+1)}var Nh=function r(e,n,i){function o(s,a){var u=s[0],l=s[1],c=s[2],f=a[0],h=a[1],d=a[2],m=f-u,y=h-l,b=m*m+y*y,v,g;if(b<dO)g=Math.log(d/c)/e,v=function(O){return[u+O*m,l+O*y,c*Math.exp(e*O*g)]};else{var A=Math.sqrt(b),E=(d*d-c*c+i*b)/(2*c*n*A),w=(d*d-c*c-i*b)/(2*d*n*A),x=Math.log(Math.sqrt(E*E+1)-E),C=Math.log(Math.sqrt(w*w+1)-w);g=(C-x)/e,v=function(O){var T=O*g,M=Wv(x),D=c/(n*A)*(M*mO(e*T+x)-pO(x));return[u+D*m,l+D*y,c*M/Wv(e*T+x)]}}return v.duration=g*1e3*e/Math.SQRT2,v}return o.rho=function(s){var a=Math.max(.001,+s),u=a*a,l=u*u;return r(a,u,l)},o}(Math.SQRT2,2,4);var io=0,Us=0,Ls=0,Zv=1e3,sl,Vs,al=0,ai=0,ul=0,Bs=typeof performance=="object"&&performance.now?performance:Date,Xv=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(r){setTimeout(r,17)};function Gs(){return ai||(Xv(gO),ai=Bs.now()+ul)}function gO(){ai=0}function qs(){this._call=this._time=this._next=null}qs.prototype=oo.prototype={constructor:qs,restart:function(r,e,n){if(typeof r!="function")throw new TypeError("callback is not a function");n=(n==null?Gs():+n)+(e==null?0:+e),!this._next&&Vs!==this&&(Vs?Vs._next=this:sl=this,Vs=this),this._call=r,this._time=n,jh()},stop:function(){this._call&&(this._call=null,this._time=1/0,jh())}};function oo(r,e,n){var i=new qs;return i.restart(r,e,n),i}function Jv(){Gs(),++io;for(var r=sl,e;r;)(e=ai-r._time)>=0&&r._call.call(void 0,e),r=r._next;--io}function Kv(){ai=(al=Bs.now())+ul,io=Us=0;try{Jv()}finally{io=0,vO(),ai=0}}function yO(){var r=Bs.now(),e=r-al;e>Zv&&(ul-=e,al=r)}function vO(){for(var r,e=sl,n,i=1/0;e;)e._call?(i>e._time&&(i=e._time),r=e,e=e._next):(n=e._next,e._next=null,e=r?r._next=n:sl=n);Vs=r,jh(i)}function jh(r){if(!io){Us&&(Us=clearTimeout(Us));var e=r-ai;e>24?(r<1/0&&(Us=setTimeout(Kv,r-Bs.now()-ul)),Ls&&(Ls=clearInterval(Ls))):(Ls||(al=Bs.now(),Ls=setInterval(yO,Zv)),io=1,Xv(Kv))}}function ll(r,e,n){var i=new qs;return e=e==null?0:+e,i.restart(o=>{i.stop(),r(o+e)},e,n),i}var bO=vr("start","end","cancel","interrupt"),_O=[],e0=0,Yv=1,fl=2,cl=3,Qv=4,hl=5,Hs=6;function Qr(r,e,n,i,o,s){var a=r.__transition;if(!a)r.__transition={};else if(n in a)return;wO(r,n,{name:e,index:i,group:o,on:bO,tween:_O,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:e0})}function Ws(r,e){var n=Re(r,e);if(n.state>e0)throw new Error("too late; already scheduled");return n}function $e(r,e){var n=Re(r,e);if(n.state>cl)throw new Error("too late; already running");return n}function Re(r,e){var n=r.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function wO(r,e,n){var i=r.__transition,o;i[e]=n,n.timer=oo(s,0,n.time);function s(c){n.state=Yv,n.timer.restart(a,n.delay,n.time),n.delay<=c&&a(c-n.delay)}function a(c){var f,h,d,m;if(n.state!==Yv)return l();for(f in i)if(m=i[f],m.name===n.name){if(m.state===cl)return ll(a);m.state===Qv?(m.state=Hs,m.timer.stop(),m.on.call("interrupt",r,r.__data__,m.index,m.group),delete i[f]):+f<e&&(m.state=Hs,m.timer.stop(),m.on.call("cancel",r,r.__data__,m.index,m.group),delete i[f])}if(ll(function(){n.state===cl&&(n.state=Qv,n.timer.restart(u,n.delay,n.time),u(c))}),n.state=fl,n.on.call("start",r,r.__data__,n.index,n.group),n.state===fl){for(n.state=cl,o=new Array(d=n.tween.length),f=0,h=-1;f<d;++f)(m=n.tween[f].value.call(r,r.__data__,n.index,n.group))&&(o[++h]=m);o.length=h+1}}function u(c){for(var f=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(l),n.state=hl,1),h=-1,d=o.length;++h<d;)o[h].call(r,f);n.state===hl&&(n.on.call("end",r,r.__data__,n.index,n.group),l())}function l(){n.state=Hs,n.timer.stop(),delete i[e];for(var c in i)return;delete r.__transition}}function ui(r,e){var n=r.__transition,i,o,s=!0,a;if(n){e=e==null?null:e+"";for(a in n){if((i=n[a]).name!==e){s=!1;continue}o=i.state>fl&&i.state<hl,i.state=Hs,i.timer.stop(),i.on.call(o?"interrupt":"cancel",r,r.__data__,i.index,i.group),delete n[a]}s&&delete r.__transition}}function t0(r){return this.each(function(){ui(this,r)})}function xO(r,e){var n,i;return function(){var o=$e(this,r),s=o.tween;if(s!==n){i=n=s;for(var a=0,u=i.length;a<u;++a)if(i[a].name===e){i=i.slice(),i.splice(a,1);break}}o.tween=i}}function AO(r,e,n){var i,o;if(typeof n!="function")throw new Error;return function(){var s=$e(this,r),a=s.tween;if(a!==i){o=(i=a).slice();for(var u={name:e,value:n},l=0,c=o.length;l<c;++l)if(o[l].name===e){o[l]=u;break}l===c&&o.push(u)}s.tween=o}}function r0(r,e){var n=this._id;if(r+="",arguments.length<2){for(var i=Re(this.node(),n).tween,o=0,s=i.length,a;o<s;++o)if((a=i[o]).name===r)return a.value;return null}return this.each((e==null?xO:AO)(n,r,e))}function so(r,e,n){var i=r._id;return r.each(function(){var o=$e(this,i);(o.value||(o.value={}))[e]=n.apply(this,arguments)}),function(o){return Re(o,i).value[e]}}function dl(r,e){var n;return(typeof e=="number"?vt:e instanceof Yr?nl:(n=Yr(e))?(e=n,nl):Rh)(r,e)}function CO(r){return function(){this.removeAttribute(r)}}function IO(r){return function(){this.removeAttributeNS(r.space,r.local)}}function EO(r,e,n){var i,o=n+"",s;return function(){var a=this.getAttribute(r);return a===o?null:a===i?s:s=e(i=a,n)}}function OO(r,e,n){var i,o=n+"",s;return function(){var a=this.getAttributeNS(r.space,r.local);return a===o?null:a===i?s:s=e(i=a,n)}}function PO(r,e,n){var i,o,s;return function(){var a,u=n(this),l;return u==null?void this.removeAttribute(r):(a=this.getAttribute(r),l=u+"",a===l?null:a===i&&l===o?s:(o=l,s=e(i=a,u)))}}function TO(r,e,n){var i,o,s;return function(){var a,u=n(this),l;return u==null?void this.removeAttributeNS(r.space,r.local):(a=this.getAttributeNS(r.space,r.local),l=u+"",a===l?null:a===i&&l===o?s:(o=l,s=e(i=a,u)))}}function n0(r,e){var n=gr(r),i=n==="transform"?Dh:dl;return this.attrTween(r,typeof e=="function"?(n.local?TO:PO)(n,i,so(this,"attr."+r,e)):e==null?(n.local?IO:CO)(n):(n.local?OO:EO)(n,i,e))}function SO(r,e){return function(n){this.setAttribute(r,e.call(this,n))}}function RO(r,e){return function(n){this.setAttributeNS(r.space,r.local,e.call(this,n))}}function MO(r,e){var n,i;function o(){var s=e.apply(this,arguments);return s!==i&&(n=(i=s)&&RO(r,s)),n}return o._value=e,o}function kO(r,e){var n,i;function o(){var s=e.apply(this,arguments);return s!==i&&(n=(i=s)&&SO(r,s)),n}return o._value=e,o}function i0(r,e){var n="attr."+r;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var i=gr(r);return this.tween(n,(i.local?MO:kO)(i,e))}function DO(r,e){return function(){Ws(this,r).delay=+e.apply(this,arguments)}}function NO(r,e){return e=+e,function(){Ws(this,r).delay=e}}function o0(r){var e=this._id;return arguments.length?this.each((typeof r=="function"?DO:NO)(e,r)):Re(this.node(),e).delay}function jO(r,e){return function(){$e(this,r).duration=+e.apply(this,arguments)}}function FO(r,e){return e=+e,function(){$e(this,r).duration=e}}function s0(r){var e=this._id;return arguments.length?this.each((typeof r=="function"?jO:FO)(e,r)):Re(this.node(),e).duration}function zO(r,e){if(typeof e!="function")throw new Error;return function(){$e(this,r).ease=e}}function a0(r){var e=this._id;return arguments.length?this.each(zO(e,r)):Re(this.node(),e).ease}function $O(r,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;$e(this,r).ease=n}}function u0(r){if(typeof r!="function")throw new Error;return this.each($O(this._id,r))}function l0(r){typeof r!="function"&&(r=Rs(r));for(var e=this._groups,n=e.length,i=new Array(n),o=0;o<n;++o)for(var s=e[o],a=s.length,u=i[o]=[],l,c=0;c<a;++c)(l=s[c])&&r.call(l,l.__data__,c,s)&&u.push(l);return new Ke(i,this._parents,this._name,this._id)}function c0(r){if(r._id!==this._id)throw new Error;for(var e=this._groups,n=r._groups,i=e.length,o=n.length,s=Math.min(i,o),a=new Array(i),u=0;u<s;++u)for(var l=e[u],c=n[u],f=l.length,h=a[u]=new Array(f),d,m=0;m<f;++m)(d=l[m]||c[m])&&(h[m]=d);for(;u<i;++u)a[u]=e[u];return new Ke(a,this._parents,this._name,this._id)}function LO(r){return(r+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function UO(r,e,n){var i,o,s=LO(e)?Ws:$e;return function(){var a=s(this,r),u=a.on;u!==i&&(o=(i=u).copy()).on(e,n),a.on=o}}function f0(r,e){var n=this._id;return arguments.length<2?Re(this.node(),n).on.on(r):this.each(UO(n,r,e))}function VO(r){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==r)return;e&&e.removeChild(this)}}function h0(){return this.on("end.remove",VO(this._id))}function d0(r){var e=this._name,n=this._id;typeof r!="function"&&(r=ni(r));for(var i=this._groups,o=i.length,s=new Array(o),a=0;a<o;++a)for(var u=i[a],l=u.length,c=s[a]=new Array(l),f,h,d=0;d<l;++d)(f=u[d])&&(h=r.call(f,f.__data__,d,u))&&("__data__"in f&&(h.__data__=f.__data__),c[d]=h,Qr(c[d],e,n,d,c,Re(f,n)));return new Ke(s,this._parents,e,n)}function p0(r){var e=this._name,n=this._id;typeof r!="function"&&(r=Ss(r));for(var i=this._groups,o=i.length,s=[],a=[],u=0;u<o;++u)for(var l=i[u],c=l.length,f,h=0;h<c;++h)if(f=l[h]){for(var d=r.call(f,f.__data__,h,l),m,y=Re(f,n),b=0,v=d.length;b<v;++b)(m=d[b])&&Qr(m,e,n,b,d,y);s.push(d),a.push(f)}return new Ke(s,a,e,n)}var BO=yr.prototype.constructor;function m0(){return new BO(this._groups,this._parents)}function qO(r,e){var n,i,o;return function(){var s=Xr(this,r),a=(this.style.removeProperty(r),Xr(this,r));return s===a?null:s===n&&a===i?o:o=e(n=s,i=a)}}function g0(r){return function(){this.style.removeProperty(r)}}function GO(r,e,n){var i,o=n+"",s;return function(){var a=Xr(this,r);return a===o?null:a===i?s:s=e(i=a,n)}}function HO(r,e,n){var i,o,s;return function(){var a=Xr(this,r),u=n(this),l=u+"";return u==null&&(l=u=(this.style.removeProperty(r),Xr(this,r))),a===l?null:a===i&&l===o?s:(o=l,s=e(i=a,u))}}function WO(r,e){var n,i,o,s="style."+e,a="end."+s,u;return function(){var l=$e(this,r),c=l.on,f=l.value[s]==null?u||(u=g0(e)):void 0;(c!==n||o!==f)&&(i=(n=c).copy()).on(a,o=f),l.on=i}}function y0(r,e,n){var i=(r+="")=="transform"?kh:dl;return e==null?this.styleTween(r,qO(r,i)).on("end.style."+r,g0(r)):typeof e=="function"?this.styleTween(r,HO(r,i,so(this,"style."+r,e))).each(WO(this._id,r)):this.styleTween(r,GO(r,i,e),n).on("end.style."+r,null)}function KO(r,e,n){return function(i){this.style.setProperty(r,e.call(this,i),n)}}function ZO(r,e,n){var i,o;function s(){var a=e.apply(this,arguments);return a!==o&&(i=(o=a)&&KO(r,a,n)),i}return s._value=e,s}function v0(r,e,n){var i="style."+(r+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(e==null)return this.tween(i,null);if(typeof e!="function")throw new Error;return this.tween(i,ZO(r,e,n??""))}function XO(r){return function(){this.textContent=r}}function JO(r){return function(){var e=r(this);this.textContent=e??""}}function b0(r){return this.tween("text",typeof r=="function"?JO(so(this,"text",r)):XO(r==null?"":r+""))}function YO(r){return function(e){this.textContent=r.call(this,e)}}function QO(r){var e,n;function i(){var o=r.apply(this,arguments);return o!==n&&(e=(n=o)&&YO(o)),e}return i._value=r,i}function _0(r){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(r==null)return this.tween(e,null);if(typeof r!="function")throw new Error;return this.tween(e,QO(r))}function w0(){for(var r=this._name,e=this._id,n=pl(),i=this._groups,o=i.length,s=0;s<o;++s)for(var a=i[s],u=a.length,l,c=0;c<u;++c)if(l=a[c]){var f=Re(l,e);Qr(l,r,n,c,a,{time:f.time+f.delay+f.duration,delay:0,duration:f.duration,ease:f.ease})}return new Ke(i,this._parents,r,n)}function x0(){var r,e,n=this,i=n._id,o=n.size();return new Promise(function(s,a){var u={value:a},l={value:function(){--o===0&&s()}};n.each(function(){var c=$e(this,i),f=c.on;f!==r&&(e=(r=f).copy(),e._.cancel.push(u),e._.interrupt.push(u),e._.end.push(l)),c.on=e}),o===0&&s()})}var eP=0;function Ke(r,e,n,i){this._groups=r,this._parents=e,this._name=n,this._id=i}function A0(r){return yr().transition(r)}function pl(){return++eP}var br=yr.prototype;Ke.prototype=A0.prototype={constructor:Ke,select:d0,selectAll:p0,selectChild:br.selectChild,selectChildren:br.selectChildren,filter:l0,merge:c0,selection:m0,transition:w0,call:br.call,nodes:br.nodes,node:br.node,size:br.size,empty:br.empty,each:br.each,on:f0,attr:n0,attrTween:i0,style:y0,styleTween:v0,text:b0,textTween:_0,remove:h0,tween:r0,delay:o0,duration:s0,ease:a0,easeVarying:u0,end:x0,[Symbol.iterator]:br[Symbol.iterator]};function ml(r){return((r*=2)<=1?r*r*r:(r-=2)*r*r+2)/2}var tP={time:null,delay:0,duration:250,ease:ml};function rP(r,e){for(var n;!(n=r.__transition)||!(n=n[e]);)if(!(r=r.parentNode))throw new Error(`transition ${e} not found`);return n}function C0(r){var e,n;r instanceof Ke?(e=r._id,r=r._name):(e=pl(),(n=tP).time=Gs(),r=r==null?null:r+"");for(var i=this._groups,o=i.length,s=0;s<o;++s)for(var a=i[s],u=a.length,l,c=0;c<u;++c)(l=a[c])&&Qr(l,r,e,c,a,n||rP(l,e));return new Ke(i,this._parents,r,e)}yr.prototype.interrupt=t0;yr.prototype.transition=C0;var Ks=r=>()=>r;function Fh(r,{sourceEvent:e,target:n,transform:i,dispatch:o}){Object.defineProperties(this,{type:{value:r,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:o}})}function Ft(r,e,n){this.k=r,this.x=e,this.y=n}Ft.prototype={constructor:Ft,scale:function(r){return r===1?this:new Ft(this.k*r,this.x,this.y)},translate:function(r,e){return r===0&e===0?this:new Ft(this.k,this.x+this.k*r,this.y+this.k*e)},apply:function(r){return[r[0]*this.k+this.x,r[1]*this.k+this.y]},applyX:function(r){return r*this.k+this.x},applyY:function(r){return r*this.k+this.y},invert:function(r){return[(r[0]-this.x)/this.k,(r[1]-this.y)/this.k]},invertX:function(r){return(r-this.x)/this.k},invertY:function(r){return(r-this.y)/this.k},rescaleX:function(r){return r.copy().domain(r.range().map(this.invertX,this).map(r.invert,r))},rescaleY:function(r){return r.copy().domain(r.range().map(this.invertY,this).map(r.invert,r))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Zs=new Ft(1,0,0);lt.prototype=Ft.prototype;function lt(r){for(;!r.__zoom;)if(!(r=r.parentNode))return Zs;return r.__zoom}function gl(r){r.stopImmediatePropagation()}function ao(r){r.preventDefault(),r.stopImmediatePropagation()}function nP(r){return(!r.ctrlKey||r.type==="wheel")&&!r.button}function iP(){var r=this;return r instanceof SVGElement?(r=r.ownerSVGElement||r,r.hasAttribute("viewBox")?(r=r.viewBox.baseVal,[[r.x,r.y],[r.x+r.width,r.y+r.height]]):[[0,0],[r.width.baseVal.value,r.height.baseVal.value]]):[[0,0],[r.clientWidth,r.clientHeight]]}function I0(){return this.__zoom||Zs}function oP(r){return-r.deltaY*(r.deltaMode===1?.05:r.deltaMode?1:.002)*(r.ctrlKey?10:1)}function sP(){return navigator.maxTouchPoints||"ontouchstart"in this}function aP(r,e,n){var i=r.invertX(e[0][0])-n[0][0],o=r.invertX(e[1][0])-n[1][0],s=r.invertY(e[0][1])-n[0][1],a=r.invertY(e[1][1])-n[1][1];return r.translate(o>i?(i+o)/2:Math.min(0,i)||Math.max(0,o),a>s?(s+a)/2:Math.min(0,s)||Math.max(0,a))}function zh(){var r=nP,e=iP,n=aP,i=oP,o=sP,s=[0,1/0],a=[[-1/0,-1/0],[1/0,1/0]],u=250,l=Nh,c=vr("start","zoom","end"),f,h,d,m=500,y=150,b=0,v=10;function g(P){P.property("__zoom",I0).on("wheel.zoom",T,{passive:!1}).on("mousedown.zoom",M).on("dblclick.zoom",D).filter(o).on("touchstart.zoom",z).on("touchmove.zoom",L).on("touchend.zoom touchcancel.zoom",Q).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}g.transform=function(P,k,S,N){var U=P.selection?P.selection():P;U.property("__zoom",I0),P!==U?x(P,k,S,N):U.interrupt().each(function(){C(this,arguments).event(N).start().zoom(null,typeof k=="function"?k.apply(this,arguments):k).end()})},g.scaleBy=function(P,k,S,N){g.scaleTo(P,function(){var U=this.__zoom.k,Z=typeof k=="function"?k.apply(this,arguments):k;return U*Z},S,N)},g.scaleTo=function(P,k,S,N){g.transform(P,function(){var U=e.apply(this,arguments),Z=this.__zoom,X=S==null?w(U):typeof S=="function"?S.apply(this,arguments):S,ie=Z.invert(X),ce=typeof k=="function"?k.apply(this,arguments):k;return n(E(A(Z,ce),X,ie),U,a)},S,N)},g.translateBy=function(P,k,S,N){g.transform(P,function(){return n(this.__zoom.translate(typeof k=="function"?k.apply(this,arguments):k,typeof S=="function"?S.apply(this,arguments):S),e.apply(this,arguments),a)},null,N)},g.translateTo=function(P,k,S,N,U){g.transform(P,function(){var Z=e.apply(this,arguments),X=this.__zoom,ie=N==null?w(Z):typeof N=="function"?N.apply(this,arguments):N;return n(Zs.translate(ie[0],ie[1]).scale(X.k).translate(typeof k=="function"?-k.apply(this,arguments):-k,typeof S=="function"?-S.apply(this,arguments):-S),Z,a)},N,U)};function A(P,k){return k=Math.max(s[0],Math.min(s[1],k)),k===P.k?P:new Ft(k,P.x,P.y)}function E(P,k,S){var N=k[0]-S[0]*P.k,U=k[1]-S[1]*P.k;return N===P.x&&U===P.y?P:new Ft(P.k,N,U)}function w(P){return[(+P[0][0]+ +P[1][0])/2,(+P[0][1]+ +P[1][1])/2]}function x(P,k,S,N){P.on("start.zoom",function(){C(this,arguments).event(N).start()}).on("interrupt.zoom end.zoom",function(){C(this,arguments).event(N).end()}).tween("zoom",function(){var U=this,Z=arguments,X=C(U,Z).event(N),ie=e.apply(U,Z),ce=S==null?w(ie):typeof S=="function"?S.apply(U,Z):S,De=Math.max(ie[1][0]-ie[0][0],ie[1][1]-ie[0][1]),xe=U.__zoom,At=typeof k=="function"?k.apply(U,Z):k,Xt=l(xe.invert(ce).concat(De/xe.k),At.invert(ce).concat(De/At.k));return function(Ct){if(Ct===1)Ct=At;else{var Jt=Xt(Ct),kl=De/Jt[2];Ct=new Ft(kl,ce[0]-Jt[0]*kl,ce[1]-Jt[1]*kl)}X.zoom(null,Ct)}})}function C(P,k,S){return!S&&P.__zooming||new O(P,k)}function O(P,k){this.that=P,this.args=k,this.active=0,this.sourceEvent=null,this.extent=e.apply(P,k),this.taps=0}O.prototype={event:function(P){return P&&(this.sourceEvent=P),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(P,k){return this.mouse&&P!=="mouse"&&(this.mouse[1]=k.invert(this.mouse[0])),this.touch0&&P!=="touch"&&(this.touch0[1]=k.invert(this.touch0[0])),this.touch1&&P!=="touch"&&(this.touch1[1]=k.invert(this.touch1[0])),this.that.__zoom=k,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(P){var k=Ve(this.that).datum();c.call(P,this.that,new Fh(P,{sourceEvent:this.sourceEvent,target:g,type:P,transform:this.that.__zoom,dispatch:c}),k)}};function T(P,...k){if(!r.apply(this,arguments))return;var S=C(this,k).event(P),N=this.__zoom,U=Math.max(s[0],Math.min(s[1],N.k*Math.pow(2,i.apply(this,arguments)))),Z=yt(P);if(S.wheel)(S.mouse[0][0]!==Z[0]||S.mouse[0][1]!==Z[1])&&(S.mouse[1]=N.invert(S.mouse[0]=Z)),clearTimeout(S.wheel);else{if(N.k===U)return;S.mouse=[Z,N.invert(Z)],ui(this),S.start()}ao(P),S.wheel=setTimeout(X,y),S.zoom("mouse",n(E(A(N,U),S.mouse[0],S.mouse[1]),S.extent,a));function X(){S.wheel=null,S.end()}}function M(P,...k){if(d||!r.apply(this,arguments))return;var S=P.currentTarget,N=C(this,k,!0).event(P),U=Ve(P.view).on("mousemove.zoom",ce,!0).on("mouseup.zoom",De,!0),Z=yt(P,S),X=P.clientX,ie=P.clientY;ks(P.view),gl(P),N.mouse=[Z,this.__zoom.invert(Z)],ui(this),N.start();function ce(xe){if(ao(xe),!N.moved){var At=xe.clientX-X,Xt=xe.clientY-ie;N.moved=At*At+Xt*Xt>b}N.event(xe).zoom("mouse",n(E(N.that.__zoom,N.mouse[0]=yt(xe,S),N.mouse[1]),N.extent,a))}function De(xe){U.on("mousemove.zoom mouseup.zoom",null),Ds(xe.view,N.moved),ao(xe),N.event(xe).end()}}function D(P,...k){if(r.apply(this,arguments)){var S=this.__zoom,N=yt(P.changedTouches?P.changedTouches[0]:P,this),U=S.invert(N),Z=S.k*(P.shiftKey?.5:2),X=n(E(A(S,Z),N,U),e.apply(this,k),a);ao(P),u>0?Ve(this).transition().duration(u).call(x,X,N,P):Ve(this).call(g.transform,X,N,P)}}function z(P,...k){if(r.apply(this,arguments)){var S=P.touches,N=S.length,U=C(this,k,P.changedTouches.length===N).event(P),Z,X,ie,ce;for(gl(P),X=0;X<N;++X)ie=S[X],ce=yt(ie,this),ce=[ce,this.__zoom.invert(ce),ie.identifier],U.touch0?!U.touch1&&U.touch0[2]!==ce[2]&&(U.touch1=ce,U.taps=0):(U.touch0=ce,Z=!0,U.taps=1+!!f);f&&(f=clearTimeout(f)),Z&&(U.taps<2&&(h=ce[0],f=setTimeout(function(){f=null},m)),ui(this),U.start())}}function L(P,...k){if(this.__zooming){var S=C(this,k).event(P),N=P.changedTouches,U=N.length,Z,X,ie,ce;for(ao(P),Z=0;Z<U;++Z)X=N[Z],ie=yt(X,this),S.touch0&&S.touch0[2]===X.identifier?S.touch0[0]=ie:S.touch1&&S.touch1[2]===X.identifier&&(S.touch1[0]=ie);if(X=S.that.__zoom,S.touch1){var De=S.touch0[0],xe=S.touch0[1],At=S.touch1[0],Xt=S.touch1[1],Ct=(Ct=At[0]-De[0])*Ct+(Ct=At[1]-De[1])*Ct,Jt=(Jt=Xt[0]-xe[0])*Jt+(Jt=Xt[1]-xe[1])*Jt;X=A(X,Math.sqrt(Ct/Jt)),ie=[(De[0]+At[0])/2,(De[1]+At[1])/2],ce=[(xe[0]+Xt[0])/2,(xe[1]+Xt[1])/2]}else if(S.touch0)ie=S.touch0[0],ce=S.touch0[1];else return;S.zoom("touch",n(E(X,ie,ce),S.extent,a))}}function Q(P,...k){if(this.__zooming){var S=C(this,k).event(P),N=P.changedTouches,U=N.length,Z,X;for(gl(P),d&&clearTimeout(d),d=setTimeout(function(){d=null},m),Z=0;Z<U;++Z)X=N[Z],S.touch0&&S.touch0[2]===X.identifier?delete S.touch0:S.touch1&&S.touch1[2]===X.identifier&&delete S.touch1;if(S.touch1&&!S.touch0&&(S.touch0=S.touch1,delete S.touch1),S.touch0)S.touch0[1]=this.__zoom.invert(S.touch0[0]);else if(S.end(),S.taps===2&&(X=yt(X,this),Math.hypot(h[0]-X[0],h[1]-X[1])<v)){var ie=Ve(this).on("dblclick.zoom");ie&&ie.apply(this,arguments)}}}return g.wheelDelta=function(P){return arguments.length?(i=typeof P=="function"?P:Ks(+P),g):i},g.filter=function(P){return arguments.length?(r=typeof P=="function"?P:Ks(!!P),g):r},g.touchable=function(P){return arguments.length?(o=typeof P=="function"?P:Ks(!!P),g):o},g.extent=function(P){return arguments.length?(e=typeof P=="function"?P:Ks([[+P[0][0],+P[0][1]],[+P[1][0],+P[1][1]]]),g):e},g.scaleExtent=function(P){return arguments.length?(s[0]=+P[0],s[1]=+P[1],g):[s[0],s[1]]},g.translateExtent=function(P){return arguments.length?(a[0][0]=+P[0][0],a[1][0]=+P[1][0],a[0][1]=+P[0][1],a[1][1]=+P[1][1],g):[[a[0][0],a[0][1]],[a[1][0],a[1][1]]]},g.constrain=function(P){return arguments.length?(n=P,g):n},g.duration=function(P){return arguments.length?(u=+P,g):u},g.interpolate=function(P){return arguments.length?(l=P,g):l},g.on=function(){var P=c.on.apply(c,arguments);return P===c?g:P},g.clickDistance=function(P){return arguments.length?(b=(P=+P)*P,g):Math.sqrt(b)},g.tapDistance=function(P){return arguments.length?(v=+P,g):v},g}var uo=class extends Map{constructor(e,n=cP){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(let[i,o]of e)this.set(i,o)}get(e){return super.get(E0(this,e))}has(e){return super.has(E0(this,e))}set(e,n){return super.set(uP(this,e),n)}delete(e){return super.delete(lP(this,e))}};function E0({_intern:r,_key:e},n){let i=e(n);return r.has(i)?r.get(i):n}function uP({_intern:r,_key:e},n){let i=e(n);return r.has(i)?r.get(i):(r.set(i,n),n)}function lP({_intern:r,_key:e},n){let i=e(n);return r.has(i)&&(n=r.get(i),r.delete(i)),n}function cP(r){return r!==null&&typeof r=="object"?r.valueOf():r}function Xs(r,e){let n;if(e===void 0)for(let i of r)i!=null&&(n<i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let o of r)(o=e(o,++i,r))!=null&&(n<o||n===void 0&&o>=o)&&(n=o)}return n}function Js(r,e){let n;if(e===void 0)for(let i of r)i!=null&&(n>i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let o of r)(o=e(o,++i,r))!=null&&(n>o||n===void 0&&o>=o)&&(n=o)}return n}var fP=typeof global=="object"&&global&&global.Object===Object&&global,O0=fP;var hP=typeof self=="object"&&self&&self.Object===Object&&self,dP=O0||hP||Function("return this")(),yl=dP;var pP=yl.Symbol,lo=pP;var P0=Object.prototype,mP=P0.hasOwnProperty,gP=P0.toString,Ys=lo?lo.toStringTag:void 0;function yP(r){var e=mP.call(r,Ys),n=r[Ys];try{r[Ys]=void 0;var i=!0}catch{}var o=gP.call(r);return i&&(e?r[Ys]=n:delete r[Ys]),o}var T0=yP;var vP=Object.prototype,bP=vP.toString;function _P(r){return bP.call(r)}var S0=_P;var wP="[object Null]",xP="[object Undefined]",R0=lo?lo.toStringTag:void 0;function AP(r){return r==null?r===void 0?xP:wP:R0&&R0 in Object(r)?T0(r):S0(r)}var M0=AP;function CP(r){return r!=null&&typeof r=="object"}var k0=CP;var IP="[object Symbol]";function EP(r){return typeof r=="symbol"||k0(r)&&M0(r)==IP}var D0=EP;var OP=/\s/;function PP(r){for(var e=r.length;e--&&OP.test(r.charAt(e)););return e}var N0=PP;var TP=/^\s+/;function SP(r){return r&&r.slice(0,N0(r)+1).replace(TP,"")}var j0=SP;function RP(r){var e=typeof r;return r!=null&&(e=="object"||e=="function")}var li=RP;var F0=NaN,MP=/^[-+]0x[0-9a-f]+$/i,kP=/^0b[01]+$/i,DP=/^0o[0-7]+$/i,NP=parseInt;function jP(r){if(typeof r=="number")return r;if(D0(r))return F0;if(li(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=li(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=j0(r);var n=kP.test(r);return n||DP.test(r)?NP(r.slice(2),n?2:8):MP.test(r)?F0:+r}var $h=jP;var FP=function(){return yl.Date.now()},vl=FP;var zP="Expected a function",$P=Math.max,LP=Math.min;function UP(r,e,n){var i,o,s,a,u,l,c=0,f=!1,h=!1,d=!0;if(typeof r!="function")throw new TypeError(zP);e=$h(e)||0,li(n)&&(f=!!n.leading,h="maxWait"in n,s=h?$P($h(n.maxWait)||0,e):s,d="trailing"in n?!!n.trailing:d);function m(C){var O=i,T=o;return i=o=void 0,c=C,a=r.apply(T,O),a}function y(C){return c=C,u=setTimeout(g,e),f?m(C):a}function b(C){var O=C-l,T=C-c,M=e-O;return h?LP(M,s-T):M}function v(C){var O=C-l,T=C-c;return l===void 0||O>=e||O<0||h&&T>=s}function g(){var C=vl();if(v(C))return A(C);u=setTimeout(g,b(C))}function A(C){return u=void 0,d&&i?m(C):(i=o=void 0,a)}function E(){u!==void 0&&clearTimeout(u),c=0,i=l=o=u=void 0}function w(){return u===void 0?a:A(vl())}function x(){var C=vl(),O=v(C);if(i=arguments,o=this,l=C,O){if(u===void 0)return y(l);if(h)return clearTimeout(u),u=setTimeout(g,e),m(l)}return u===void 0&&(u=setTimeout(g,e)),a}return x.cancel=E,x.flush=w,x}var bl=UP;var VP="Expected a function";function BP(r,e,n){var i=!0,o=!0;if(typeof r!="function")throw new TypeError(VP);return li(n)&&(i="leading"in n?!!n.leading:i,o="trailing"in n?!!n.trailing:o),bl(r,e,{leading:i,maxWait:e,trailing:o})}var Lh=BP;var en=Object.freeze({Linear:Object.freeze({None:function(r){return r},In:function(r){return r},Out:function(r){return r},InOut:function(r){return r}}),Quadratic:Object.freeze({In:function(r){return r*r},Out:function(r){return r*(2-r)},InOut:function(r){return(r*=2)<1?.5*r*r:-.5*(--r*(r-2)-1)}}),Cubic:Object.freeze({In:function(r){return r*r*r},Out:function(r){return--r*r*r+1},InOut:function(r){return(r*=2)<1?.5*r*r*r:.5*((r-=2)*r*r+2)}}),Quartic:Object.freeze({In:function(r){return r*r*r*r},Out:function(r){return 1- --r*r*r*r},InOut:function(r){return(r*=2)<1?.5*r*r*r*r:-.5*((r-=2)*r*r*r-2)}}),Quintic:Object.freeze({In:function(r){return r*r*r*r*r},Out:function(r){return--r*r*r*r*r+1},InOut:function(r){return(r*=2)<1?.5*r*r*r*r*r:.5*((r-=2)*r*r*r*r+2)}}),Sinusoidal:Object.freeze({In:function(r){return 1-Math.sin((1-r)*Math.PI/2)},Out:function(r){return Math.sin(r*Math.PI/2)},InOut:function(r){return .5*(1-Math.sin(Math.PI*(.5-r)))}}),Exponential:Object.freeze({In:function(r){return r===0?0:Math.pow(1024,r-1)},Out:function(r){return r===1?1:1-Math.pow(2,-10*r)},InOut:function(r){return r===0?0:r===1?1:(r*=2)<1?.5*Math.pow(1024,r-1):.5*(-Math.pow(2,-10*(r-1))+2)}}),Circular:Object.freeze({In:function(r){return 1-Math.sqrt(1-r*r)},Out:function(r){return Math.sqrt(1- --r*r)},InOut:function(r){return(r*=2)<1?-.5*(Math.sqrt(1-r*r)-1):.5*(Math.sqrt(1-(r-=2)*r)+1)}}),Elastic:Object.freeze({In:function(r){return r===0?0:r===1?1:-Math.pow(2,10*(r-1))*Math.sin((r-1.1)*5*Math.PI)},Out:function(r){return r===0?0:r===1?1:Math.pow(2,-10*r)*Math.sin((r-.1)*5*Math.PI)+1},InOut:function(r){return r===0?0:r===1?1:(r*=2,r<1?-.5*Math.pow(2,10*(r-1))*Math.sin((r-1.1)*5*Math.PI):.5*Math.pow(2,-10*(r-1))*Math.sin((r-1.1)*5*Math.PI)+1)}}),Back:Object.freeze({In:function(r){var e=1.70158;return r===1?1:r*r*((e+1)*r-e)},Out:function(r){var e=1.70158;return r===0?0:--r*r*((e+1)*r+e)+1},InOut:function(r){var e=2.5949095;return(r*=2)<1?.5*(r*r*((e+1)*r-e)):.5*((r-=2)*r*((e+1)*r+e)+2)}}),Bounce:Object.freeze({In:function(r){return 1-en.Bounce.Out(1-r)},Out:function(r){return r<.36363636363636365?7.5625*r*r:r<.7272727272727273?7.5625*(r-=.5454545454545454)*r+.75:r<.9090909090909091?7.5625*(r-=.8181818181818182)*r+.9375:7.5625*(r-=.9545454545454546)*r+.984375},InOut:function(r){return r<.5?en.Bounce.In(r*2)*.5:en.Bounce.Out(r*2-1)*.5+.5}}),generatePow:function(r){return r===void 0&&(r=4),r=r<Number.EPSILON?Number.EPSILON:r,r=r>1e4?1e4:r,{In:function(e){return Math.pow(e,r)},Out:function(e){return 1-Math.pow(1-e,r)},InOut:function(e){return e<.5?Math.pow(e*2,r)/2:(1-Math.pow(2-e*2,r))/2+.5}}}}),Qs=function(){return performance.now()},qP=function(){function r(){this._tweens={},this._tweensAddedDuringUpdate={}}return r.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map(function(n){return e._tweens[n]})},r.prototype.removeAll=function(){this._tweens={}},r.prototype.add=function(e){this._tweens[e.getId()]=e,this._tweensAddedDuringUpdate[e.getId()]=e},r.prototype.remove=function(e){delete this._tweens[e.getId()],delete this._tweensAddedDuringUpdate[e.getId()]},r.prototype.update=function(e,n){e===void 0&&(e=Qs()),n===void 0&&(n=!1);var i=Object.keys(this._tweens);if(i.length===0)return!1;for(;i.length>0;){this._tweensAddedDuringUpdate={};for(var o=0;o<i.length;o++){var s=this._tweens[i[o]],a=!n;s&&s.update(e,a)===!1&&!n&&delete this._tweens[i[o]]}i=Object.keys(this._tweensAddedDuringUpdate)}return!0},r}(),co={Linear:function(r,e){var n=r.length-1,i=n*e,o=Math.floor(i),s=co.Utils.Linear;return e<0?s(r[0],r[1],i):e>1?s(r[n],r[n-1],n-i):s(r[o],r[o+1>n?n:o+1],i-o)},Bezier:function(r,e){for(var n=0,i=r.length-1,o=Math.pow,s=co.Utils.Bernstein,a=0;a<=i;a++)n+=o(1-e,i-a)*o(e,a)*r[a]*s(i,a);return n},CatmullRom:function(r,e){var n=r.length-1,i=n*e,o=Math.floor(i),s=co.Utils.CatmullRom;return r[0]===r[n]?(e<0&&(o=Math.floor(i=n*(1+e))),s(r[(o-1+n)%n],r[o],r[(o+1)%n],r[(o+2)%n],i-o)):e<0?r[0]-(s(r[0],r[0],r[1],r[1],-i)-r[0]):e>1?r[n]-(s(r[n],r[n],r[n-1],r[n-1],i-n)-r[n]):s(r[o?o-1:0],r[o],r[n<o+1?n:o+1],r[n<o+2?n:o+2],i-o)},Utils:{Linear:function(r,e,n){return(e-r)*n+r},Bernstein:function(r,e){var n=co.Utils.Factorial;return n(r)/n(e)/n(r-e)},Factorial:function(){var r=[1];return function(e){var n=1;if(r[e])return r[e];for(var i=e;i>1;i--)n*=i;return r[e]=n,n}}(),CatmullRom:function(r,e,n,i,o){var s=(n-r)*.5,a=(i-e)*.5,u=o*o,l=o*u;return(2*e-2*n+s+a)*l+(-3*e+3*n-2*s-a)*u+s*o+e}}},z0=function(){function r(){}return r.nextId=function(){return r._nextId++},r._nextId=0,r}(),Uh=new qP,Vh=function(){function r(e,n){n===void 0&&(n=Uh),this._object=e,this._group=n,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=en.Linear.None,this._interpolationFunction=co.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=z0.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1}return r.prototype.getId=function(){return this._id},r.prototype.isPlaying=function(){return this._isPlaying},r.prototype.isPaused=function(){return this._isPaused},r.prototype.getDuration=function(){return this._duration},r.prototype.to=function(e,n){if(n===void 0&&(n=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=e,this._propertiesAreSetUp=!1,this._duration=n<0?0:n,this},r.prototype.duration=function(e){return e===void 0&&(e=1e3),this._duration=e<0?0:e,this},r.prototype.dynamic=function(e){return e===void 0&&(e=!1),this._isDynamic=e,this},r.prototype.start=function(e,n){if(e===void 0&&(e=Qs()),n===void 0&&(n=!1),this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var i in this._valuesStartRepeat)this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i]}if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=e,this._startTime+=this._delayTime,!this._propertiesAreSetUp||n){if(this._propertiesAreSetUp=!0,!this._isDynamic){var o={};for(var s in this._valuesEnd)o[s]=this._valuesEnd[s];this._valuesEnd=o}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,n)}return this},r.prototype.startFromCurrentValues=function(e){return this.start(e,!0)},r.prototype._setupProperties=function(e,n,i,o,s){for(var a in i){var u=e[a],l=Array.isArray(u),c=l?"array":typeof u,f=!l&&Array.isArray(i[a]);if(!(c==="undefined"||c==="function")){if(f){var h=i[a];if(h.length===0)continue;for(var d=[u],m=0,y=h.length;m<y;m+=1){var b=this._handleRelativeValue(u,h[m]);if(isNaN(b)){f=!1,console.warn("Found invalid interpolation list. Skipping.");break}d.push(b)}f&&(i[a]=d)}if((c==="object"||l)&&u&&!f){n[a]=l?[]:{};var v=u;for(var g in v)n[a][g]=v[g];o[a]=l?[]:{};var h=i[a];if(!this._isDynamic){var A={};for(var g in h)A[g]=h[g];i[a]=h=A}this._setupProperties(v,n[a],h,o[a],s)}else(typeof n[a]>"u"||s)&&(n[a]=u),l||(n[a]*=1),f?o[a]=i[a].slice().reverse():o[a]=n[a]||0}}},r.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},r.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},r.prototype.pause=function(e){return e===void 0&&(e=Qs()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=e,this._group&&this._group.remove(this),this)},r.prototype.resume=function(e){return e===void 0&&(e=Qs()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this)},r.prototype.stopChainedTweens=function(){for(var e=0,n=this._chainedTweens.length;e<n;e++)this._chainedTweens[e].stop();return this},r.prototype.group=function(e){return e===void 0&&(e=Uh),this._group=e,this},r.prototype.delay=function(e){return e===void 0&&(e=0),this._delayTime=e,this},r.prototype.repeat=function(e){return e===void 0&&(e=0),this._initialRepeat=e,this._repeat=e,this},r.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},r.prototype.yoyo=function(e){return e===void 0&&(e=!1),this._yoyo=e,this},r.prototype.easing=function(e){return e===void 0&&(e=en.Linear.None),this._easingFunction=e,this},r.prototype.interpolation=function(e){return e===void 0&&(e=co.Linear),this._interpolationFunction=e,this},r.prototype.chain=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return this._chainedTweens=e,this},r.prototype.onStart=function(e){return this._onStartCallback=e,this},r.prototype.onEveryStart=function(e){return this._onEveryStartCallback=e,this},r.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},r.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},r.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},r.prototype.onStop=function(e){return this._onStopCallback=e,this},r.prototype.update=function(e,n){var i=this,o;if(e===void 0&&(e=Qs()),n===void 0&&(n=!0),this._isPaused)return!0;var s,a=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(e>a)return!1;n&&this.start(e,!0)}if(this._goToEnd=!1,e<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),this._onEveryStartCallbackFired===!1&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var u=e-this._startTime,l=this._duration+((o=this._repeatDelayTime)!==null&&o!==void 0?o:this._delayTime),c=this._duration+this._repeat*l,f=function(){if(i._duration===0||u>c)return 1;var v=Math.trunc(u/l),g=u-v*l,A=Math.min(g/i._duration,1);return A===0&&u===i._duration?1:A},h=f(),d=this._easingFunction(h);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,d),this._onUpdateCallback&&this._onUpdateCallback(this._object,h),this._duration===0||u>=this._duration)if(this._repeat>0){var m=Math.min(Math.trunc((u-this._duration)/l)+1,this._repeat);isFinite(this._repeat)&&(this._repeat-=m);for(s in this._valuesStartRepeat)!this._yoyo&&typeof this._valuesEnd[s]=="string"&&(this._valuesStartRepeat[s]=this._valuesStartRepeat[s]+parseFloat(this._valuesEnd[s])),this._yoyo&&this._swapEndStartRepeatValues(s),this._valuesStart[s]=this._valuesStartRepeat[s];return this._yoyo&&(this._reversed=!this._reversed),this._startTime+=l*m,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}else{this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var y=0,b=this._chainedTweens.length;y<b;y++)this._chainedTweens[y].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},r.prototype._updateProperties=function(e,n,i,o){for(var s in i)if(n[s]!==void 0){var a=n[s]||0,u=i[s],l=Array.isArray(e[s]),c=Array.isArray(u),f=!l&&c;f?e[s]=this._interpolationFunction(u,o):typeof u=="object"&&u?this._updateProperties(e[s],a,u,o):(u=this._handleRelativeValue(a,u),typeof u=="number"&&(e[s]=a+(u-a)*o))}},r.prototype._handleRelativeValue=function(e,n){return typeof n!="string"?n:n.charAt(0)==="+"||n.charAt(0)==="-"?e+parseFloat(n):parseFloat(n)},r.prototype._swapEndStartRepeatValues=function(e){var n=this._valuesStartRepeat[e],i=this._valuesEnd[e];typeof i=="string"?this._valuesStartRepeat[e]=this._valuesStartRepeat[e]+parseFloat(i):this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=n},r}();var k7=z0.nextId,Zt=Uh,D7=Zt.getAll.bind(Zt),N7=Zt.removeAll.bind(Zt),j7=Zt.add.bind(Zt),F7=Zt.remove.bind(Zt),$0=Zt.update.bind(Zt);function HP(r,e){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var i,o,s,a,u=[],l=!0,c=!1;try{if(s=(n=n.call(r)).next,e===0){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=s.call(n)).done)&&(u.push(i.value),u.length!==e);l=!0);}catch(f){c=!0,o=f}finally{try{if(!l&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}function WP(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function L0(r,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,eT(i.key),i)}}function KP(r,e,n){return e&&L0(r.prototype,e),n&&L0(r,n),Object.defineProperty(r,"prototype",{writable:!1}),r}function ZP(r,e){return XP(r)||HP(r,e)||JP(r,e)||YP()}function XP(r){if(Array.isArray(r))return r}function JP(r,e){if(r){if(typeof r=="string")return U0(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);if(n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set")return Array.from(r);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return U0(r,e)}}function U0(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=r[n];return i}function YP(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QP(r,e){if(typeof r!="object"||r===null)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function eT(r){var e=QP(r,"string");return typeof e=="symbol"?e:String(e)}var tT=KP(function r(e,n){var i=n.default,o=i===void 0?null:i,s=n.triggerUpdate,a=s===void 0?!0:s,u=n.onChange,l=u===void 0?function(c,f){}:u;WP(this,r),this.name=e,this.defaultVal=o,this.triggerUpdate=a,this.onChange=l});function Bh(r){var e=r.stateInit,n=e===void 0?function(){return{}}:e,i=r.props,o=i===void 0?{}:i,s=r.methods,a=s===void 0?{}:s,u=r.aliases,l=u===void 0?{}:u,c=r.init,f=c===void 0?function(){}:c,h=r.update,d=h===void 0?function(){}:h,m=Object.keys(o).map(function(y){return new tT(y,o[y])});return function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},b=Object.assign({},n instanceof Function?n(y):n,{initialised:!1}),v={};function g(w){return A(w,y),E(),g}var A=function(x,C){f.call(g,x,b,C),b.initialised=!0},E=bl(function(){b.initialised&&(d.call(g,b,v),v={})},1);return m.forEach(function(w){g[w.name]=x(w);function x(C){var O=C.name,T=C.triggerUpdate,M=T===void 0?!1:T,D=C.onChange,z=D===void 0?function(P,k){}:D,L=C.defaultVal,Q=L===void 0?null:L;return function(P){var k=b[O];if(!arguments.length)return k;var S=P===void 0?Q:P;return b[O]=S,z.call(g,S,b,k),!v.hasOwnProperty(O)&&(v[O]=k),M&&E(),g}}}),Object.keys(a).forEach(function(w){g[w]=function(){for(var x,C=arguments.length,O=new Array(C),T=0;T<C;T++)O[T]=arguments[T];return(x=a[w]).call.apply(x,[g,b].concat(O))}}),Object.entries(l).forEach(function(w){var x=ZP(w,2),C=x[0],O=x[1];return g[C]=g[O]}),g.resetProps=function(){return m.forEach(function(w){g[w.name](w.defaultVal)}),g},g.resetProps(),b._rerender=E,g}}var le=function(r){return typeof r=="function"?r:typeof r=="string"?function(e){return e[r]}:function(e){return r}};function _l(r){"@babel/helpers - typeof";return _l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_l(r)}var rT=/^\s+/,nT=/\s+$/;function $(r,e){if(r=r||"",e=e||{},r instanceof $)return r;if(!(this instanceof $))return new $(r,e);var n=iT(r);this._originalInput=r,this._r=n.r,this._g=n.g,this._b=n.b,this._a=n.a,this._roundA=Math.round(100*this._a)/100,this._format=e.format||n.format,this._gradientType=e.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=n.ok}$.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},getLuminance:function(){var e=this.toRgb(),n,i,o,s,a,u;return n=e.r/255,i=e.g/255,o=e.b/255,n<=.03928?s=n/12.92:s=Math.pow((n+.055)/1.055,2.4),i<=.03928?a=i/12.92:a=Math.pow((i+.055)/1.055,2.4),o<=.03928?u=o/12.92:u=Math.pow((o+.055)/1.055,2.4),.2126*s+.7152*a+.0722*u},setAlpha:function(e){return this._a=K0(e),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var e=B0(this._r,this._g,this._b);return{h:e.h*360,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=B0(this._r,this._g,this._b),n=Math.round(e.h*360),i=Math.round(e.s*100),o=Math.round(e.v*100);return this._a==1?"hsv("+n+", "+i+"%, "+o+"%)":"hsva("+n+", "+i+"%, "+o+"%, "+this._roundA+")"},toHsl:function(){var e=V0(this._r,this._g,this._b);return{h:e.h*360,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=V0(this._r,this._g,this._b),n=Math.round(e.h*360),i=Math.round(e.s*100),o=Math.round(e.l*100);return this._a==1?"hsl("+n+", "+i+"%, "+o+"%)":"hsla("+n+", "+i+"%, "+o+"%, "+this._roundA+")"},toHex:function(e){return q0(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return uT(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(ve(this._r,255)*100)+"%",g:Math.round(ve(this._g,255)*100)+"%",b:Math.round(ve(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(ve(this._r,255)*100)+"%, "+Math.round(ve(this._g,255)*100)+"%, "+Math.round(ve(this._b,255)*100)+"%)":"rgba("+Math.round(ve(this._r,255)*100)+"%, "+Math.round(ve(this._g,255)*100)+"%, "+Math.round(ve(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:_T[q0(this._r,this._g,this._b,!0)]||!1},toFilter:function(e){var n="#"+G0(this._r,this._g,this._b,this._a),i=n,o=this._gradientType?"GradientType = 1, ":"";if(e){var s=$(e);i="#"+G0(s._r,s._g,s._b,s._a)}return"progid:DXImageTransform.Microsoft.gradient("+o+"startColorstr="+n+",endColorstr="+i+")"},toString:function(e){var n=!!e;e=e||this._format;var i=!1,o=this._a<1&&this._a>=0,s=!n&&o&&(e==="hex"||e==="hex6"||e==="hex3"||e==="hex4"||e==="hex8"||e==="name");return s?e==="name"&&this._a===0?this.toName():this.toRgbString():(e==="rgb"&&(i=this.toRgbString()),e==="prgb"&&(i=this.toPercentageRgbString()),(e==="hex"||e==="hex6")&&(i=this.toHexString()),e==="hex3"&&(i=this.toHexString(!0)),e==="hex4"&&(i=this.toHex8String(!0)),e==="hex8"&&(i=this.toHex8String()),e==="name"&&(i=this.toName()),e==="hsl"&&(i=this.toHslString()),e==="hsv"&&(i=this.toHsvString()),i||this.toHexString())},clone:function(){return $(this.toString())},_applyModification:function(e,n){var i=e.apply(null,[this].concat([].slice.call(n)));return this._r=i._r,this._g=i._g,this._b=i._b,this.setAlpha(i._a),this},lighten:function(){return this._applyModification(hT,arguments)},brighten:function(){return this._applyModification(dT,arguments)},darken:function(){return this._applyModification(pT,arguments)},desaturate:function(){return this._applyModification(lT,arguments)},saturate:function(){return this._applyModification(cT,arguments)},greyscale:function(){return this._applyModification(fT,arguments)},spin:function(){return this._applyModification(mT,arguments)},_applyCombination:function(e,n){return e.apply(null,[this].concat([].slice.call(n)))},analogous:function(){return this._applyCombination(vT,arguments)},complement:function(){return this._applyCombination(gT,arguments)},monochromatic:function(){return this._applyCombination(bT,arguments)},splitcomplement:function(){return this._applyCombination(yT,arguments)},triad:function(){return this._applyCombination(H0,[3])},tetrad:function(){return this._applyCombination(H0,[4])}};$.fromRatio=function(r,e){if(_l(r)=="object"){var n={};for(var i in r)r.hasOwnProperty(i)&&(i==="a"?n[i]=r[i]:n[i]=ea(r[i]));r=n}return $(r,e)};function iT(r){var e={r:0,g:0,b:0},n=1,i=null,o=null,s=null,a=!1,u=!1;return typeof r=="string"&&(r=CT(r)),_l(r)=="object"&&(_r(r.r)&&_r(r.g)&&_r(r.b)?(e=oT(r.r,r.g,r.b),a=!0,u=String(r.r).substr(-1)==="%"?"prgb":"rgb"):_r(r.h)&&_r(r.s)&&_r(r.v)?(i=ea(r.s),o=ea(r.v),e=aT(r.h,i,o),a=!0,u="hsv"):_r(r.h)&&_r(r.s)&&_r(r.l)&&(i=ea(r.s),s=ea(r.l),e=sT(r.h,i,s),a=!0,u="hsl"),r.hasOwnProperty("a")&&(n=r.a)),n=K0(n),{ok:a,format:r.format||u,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:n}}function oT(r,e,n){return{r:ve(r,255)*255,g:ve(e,255)*255,b:ve(n,255)*255}}function V0(r,e,n){r=ve(r,255),e=ve(e,255),n=ve(n,255);var i=Math.max(r,e,n),o=Math.min(r,e,n),s,a,u=(i+o)/2;if(i==o)s=a=0;else{var l=i-o;switch(a=u>.5?l/(2-i-o):l/(i+o),i){case r:s=(e-n)/l+(e<n?6:0);break;case e:s=(n-r)/l+2;break;case n:s=(r-e)/l+4;break}s/=6}return{h:s,s:a,l:u}}function sT(r,e,n){var i,o,s;r=ve(r,360),e=ve(e,100),n=ve(n,100);function a(c,f,h){return h<0&&(h+=1),h>1&&(h-=1),h<1/6?c+(f-c)*6*h:h<1/2?f:h<2/3?c+(f-c)*(2/3-h)*6:c}if(e===0)i=o=s=n;else{var u=n<.5?n*(1+e):n+e-n*e,l=2*n-u;i=a(l,u,r+1/3),o=a(l,u,r),s=a(l,u,r-1/3)}return{r:i*255,g:o*255,b:s*255}}function B0(r,e,n){r=ve(r,255),e=ve(e,255),n=ve(n,255);var i=Math.max(r,e,n),o=Math.min(r,e,n),s,a,u=i,l=i-o;if(a=i===0?0:l/i,i==o)s=0;else{switch(i){case r:s=(e-n)/l+(e<n?6:0);break;case e:s=(n-r)/l+2;break;case n:s=(r-e)/l+4;break}s/=6}return{h:s,s:a,v:u}}function aT(r,e,n){r=ve(r,360)*6,e=ve(e,100),n=ve(n,100);var i=Math.floor(r),o=r-i,s=n*(1-e),a=n*(1-o*e),u=n*(1-(1-o)*e),l=i%6,c=[n,a,s,s,u,n][l],f=[u,n,n,a,s,s][l],h=[s,s,u,n,n,a][l];return{r:c*255,g:f*255,b:h*255}}function q0(r,e,n,i){var o=[$t(Math.round(r).toString(16)),$t(Math.round(e).toString(16)),$t(Math.round(n).toString(16))];return i&&o[0].charAt(0)==o[0].charAt(1)&&o[1].charAt(0)==o[1].charAt(1)&&o[2].charAt(0)==o[2].charAt(1)?o[0].charAt(0)+o[1].charAt(0)+o[2].charAt(0):o.join("")}function uT(r,e,n,i,o){var s=[$t(Math.round(r).toString(16)),$t(Math.round(e).toString(16)),$t(Math.round(n).toString(16)),$t(Z0(i))];return o&&s[0].charAt(0)==s[0].charAt(1)&&s[1].charAt(0)==s[1].charAt(1)&&s[2].charAt(0)==s[2].charAt(1)&&s[3].charAt(0)==s[3].charAt(1)?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0)+s[3].charAt(0):s.join("")}function G0(r,e,n,i){var o=[$t(Z0(i)),$t(Math.round(r).toString(16)),$t(Math.round(e).toString(16)),$t(Math.round(n).toString(16))];return o.join("")}$.equals=function(r,e){return!r||!e?!1:$(r).toRgbString()==$(e).toRgbString()};$.random=function(){return $.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function lT(r,e){e=e===0?0:e||10;var n=$(r).toHsl();return n.s-=e/100,n.s=wl(n.s),$(n)}function cT(r,e){e=e===0?0:e||10;var n=$(r).toHsl();return n.s+=e/100,n.s=wl(n.s),$(n)}function fT(r){return $(r).desaturate(100)}function hT(r,e){e=e===0?0:e||10;var n=$(r).toHsl();return n.l+=e/100,n.l=wl(n.l),$(n)}function dT(r,e){e=e===0?0:e||10;var n=$(r).toRgb();return n.r=Math.max(0,Math.min(255,n.r-Math.round(255*-(e/100)))),n.g=Math.max(0,Math.min(255,n.g-Math.round(255*-(e/100)))),n.b=Math.max(0,Math.min(255,n.b-Math.round(255*-(e/100)))),$(n)}function pT(r,e){e=e===0?0:e||10;var n=$(r).toHsl();return n.l-=e/100,n.l=wl(n.l),$(n)}function mT(r,e){var n=$(r).toHsl(),i=(n.h+e)%360;return n.h=i<0?360+i:i,$(n)}function gT(r){var e=$(r).toHsl();return e.h=(e.h+180)%360,$(e)}function H0(r,e){if(isNaN(e)||e<=0)throw new Error("Argument to polyad must be a positive number");for(var n=$(r).toHsl(),i=[$(r)],o=360/e,s=1;s<e;s++)i.push($({h:(n.h+s*o)%360,s:n.s,l:n.l}));return i}function yT(r){var e=$(r).toHsl(),n=e.h;return[$(r),$({h:(n+72)%360,s:e.s,l:e.l}),$({h:(n+216)%360,s:e.s,l:e.l})]}function vT(r,e,n){e=e||6,n=n||30;var i=$(r).toHsl(),o=360/n,s=[$(r)];for(i.h=(i.h-(o*e>>1)+720)%360;--e;)i.h=(i.h+o)%360,s.push($(i));return s}function bT(r,e){e=e||6;for(var n=$(r).toHsv(),i=n.h,o=n.s,s=n.v,a=[],u=1/e;e--;)a.push($({h:i,s:o,v:s})),s=(s+u)%1;return a}$.mix=function(r,e,n){n=n===0?0:n||50;var i=$(r).toRgb(),o=$(e).toRgb(),s=n/100,a={r:(o.r-i.r)*s+i.r,g:(o.g-i.g)*s+i.g,b:(o.b-i.b)*s+i.b,a:(o.a-i.a)*s+i.a};return $(a)};$.readability=function(r,e){var n=$(r),i=$(e);return(Math.max(n.getLuminance(),i.getLuminance())+.05)/(Math.min(n.getLuminance(),i.getLuminance())+.05)};$.isReadable=function(r,e,n){var i=$.readability(r,e),o,s;switch(s=!1,o=IT(n),o.level+o.size){case"AAsmall":case"AAAlarge":s=i>=4.5;break;case"AAlarge":s=i>=3;break;case"AAAsmall":s=i>=7;break}return s};$.mostReadable=function(r,e,n){var i=null,o=0,s,a,u,l;n=n||{},a=n.includeFallbackColors,u=n.level,l=n.size;for(var c=0;c<e.length;c++)s=$.readability(r,e[c]),s>o&&(o=s,i=$(e[c]));return $.isReadable(r,i,{level:u,size:l})||!a?i:(n.includeFallbackColors=!1,$.mostReadable(r,["#fff","#000"],n))};var qh=$.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},_T=$.hexNames=wT(qh);function wT(r){var e={};for(var n in r)r.hasOwnProperty(n)&&(e[r[n]]=n);return e}function K0(r){return r=parseFloat(r),(isNaN(r)||r<0||r>1)&&(r=1),r}function ve(r,e){xT(r)&&(r="100%");var n=AT(r);return r=Math.min(e,Math.max(0,parseFloat(r))),n&&(r=parseInt(r*e,10)/100),Math.abs(r-e)<1e-6?1:r%e/parseFloat(e)}function wl(r){return Math.min(1,Math.max(0,r))}function ct(r){return parseInt(r,16)}function xT(r){return typeof r=="string"&&r.indexOf(".")!=-1&&parseFloat(r)===1}function AT(r){return typeof r=="string"&&r.indexOf("%")!=-1}function $t(r){return r.length==1?"0"+r:""+r}function ea(r){return r<=1&&(r=r*100+"%"),r}function Z0(r){return Math.round(parseFloat(r)*255).toString(16)}function W0(r){return ct(r)/255}var zt=function(){var r="[-\\+]?\\d+%?",e="[-\\+]?\\d*\\.\\d+%?",n="(?:"+e+")|(?:"+r+")",i="[\\s|\\(]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")\\s*\\)?",o="[\\s|\\(]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")\\s*\\)?";return{CSS_UNIT:new RegExp(n),rgb:new RegExp("rgb"+i),rgba:new RegExp("rgba"+o),hsl:new RegExp("hsl"+i),hsla:new RegExp("hsla"+o),hsv:new RegExp("hsv"+i),hsva:new RegExp("hsva"+o),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function _r(r){return!!zt.CSS_UNIT.exec(r)}function CT(r){r=r.replace(rT,"").replace(nT,"").toLowerCase();var e=!1;if(qh[r])r=qh[r],e=!0;else if(r=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var n;return(n=zt.rgb.exec(r))?{r:n[1],g:n[2],b:n[3]}:(n=zt.rgba.exec(r))?{r:n[1],g:n[2],b:n[3],a:n[4]}:(n=zt.hsl.exec(r))?{h:n[1],s:n[2],l:n[3]}:(n=zt.hsla.exec(r))?{h:n[1],s:n[2],l:n[3],a:n[4]}:(n=zt.hsv.exec(r))?{h:n[1],s:n[2],v:n[3]}:(n=zt.hsva.exec(r))?{h:n[1],s:n[2],v:n[3],a:n[4]}:(n=zt.hex8.exec(r))?{r:ct(n[1]),g:ct(n[2]),b:ct(n[3]),a:W0(n[4]),format:e?"name":"hex8"}:(n=zt.hex6.exec(r))?{r:ct(n[1]),g:ct(n[2]),b:ct(n[3]),format:e?"name":"hex"}:(n=zt.hex4.exec(r))?{r:ct(n[1]+""+n[1]),g:ct(n[2]+""+n[2]),b:ct(n[3]+""+n[3]),a:W0(n[4]+""+n[4]),format:e?"name":"hex8"}:(n=zt.hex3.exec(r))?{r:ct(n[1]+""+n[1]),g:ct(n[2]+""+n[2]),b:ct(n[3]+""+n[3]),format:e?"name":"hex"}:!1}function IT(r){var e,n;return r=r||{level:"AA",size:"small"},e=(r.level||"AA").toUpperCase(),n=(r.size||"small").toLowerCase(),e!=="AA"&&e!=="AAA"&&(e="AA"),n!=="small"&&n!=="large"&&(n="small"),{level:e,size:n}}function Gh(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=Array(e);n<e;n++)i[n]=r[n];return i}function ET(r){if(Array.isArray(r))return Gh(r)}function OT(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function PT(r,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,DT(i.key),i)}}function TT(r,e,n){return e&&PT(r.prototype,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function ST(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function RT(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MT(r){return ET(r)||ST(r)||NT(r)||RT()}function kT(r,e){if(typeof r!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}function DT(r){var e=kT(r,"string");return typeof e=="symbol"?e:e+""}function NT(r,e){if(r){if(typeof r=="string")return Gh(r,e);var n={}.toString.call(r).slice(8,-1);return n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set"?Array.from(r):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Gh(r,e):void 0}}var jT=123,FT=function(e){return"#".concat(Math.min(e,Math.pow(2,24)).toString(16).padStart(6,"0"))},J0=function(e,n,i){return(e<<16)+(n<<8)+i},zT=function(e){var n=$(e).toRgb(),i=n.r,o=n.g,s=n.b;return J0(i,o,s)},X0=function(e,n){return e*jT%Math.pow(2,n)},Y0=function(){function r(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:6;OT(this,r),this.csBits=e,this.registry=["__reserved for background__"]}return TT(r,[{key:"register",value:function(n){if(this.registry.length>=Math.pow(2,24-this.csBits))return null;var i=this.registry.length,o=X0(i,this.csBits),s=FT(i+(o<<24-this.csBits));return this.registry.push(n),s}},{key:"lookup",value:function(n){var i=typeof n=="string"?zT(n):J0.apply(void 0,MT(n));if(!i)return null;var o=i&Math.pow(2,24-this.csBits)-1,s=i>>24-this.csBits&Math.pow(2,this.csBits)-1;return X0(o,this.csBits)!==s||o>=this.registry.length?null:this.registry[o]}}])}();function Hh(r,e,n){var i,o=1;r==null&&(r=0),e==null&&(e=0),n==null&&(n=0);function s(){var a,u=i.length,l,c=0,f=0,h=0;for(a=0;a<u;++a)l=i[a],c+=l.x||0,f+=l.y||0,h+=l.z||0;for(c=(c/u-r)*o,f=(f/u-e)*o,h=(h/u-n)*o,a=0;a<u;++a)l=i[a],c&&(l.x-=c),f&&(l.y-=f),h&&(l.z-=h)}return s.initialize=function(a){i=a},s.x=function(a){return arguments.length?(r=+a,s):r},s.y=function(a){return arguments.length?(e=+a,s):e},s.z=function(a){return arguments.length?(n=+a,s):n},s.strength=function(a){return arguments.length?(o=+a,s):o},s}function Q0(r){let e=+this._x.call(null,r);return eb(this.cover(e),e,r)}function eb(r,e,n){if(isNaN(e))return r;var i,o=r._root,s={data:n},a=r._x0,u=r._x1,l,c,f,h,d;if(!o)return r._root=s,r;for(;o.length;)if((f=e>=(l=(a+u)/2))?a=l:u=l,i=o,!(o=o[h=+f]))return i[h]=s,r;if(c=+r._x.call(null,o.data),e===c)return s.next=o,i?i[h]=s:r._root=s,r;do i=i?i[h]=new Array(2):r._root=new Array(2),(f=e>=(l=(a+u)/2))?a=l:u=l;while((h=+f)==(d=+(c>=l)));return i[d]=o,i[h]=s,r}function tb(r){Array.isArray(r)||(r=Array.from(r));let e=r.length,n=new Float64Array(e),i=1/0,o=-1/0;for(let s=0,a;s<e;++s)isNaN(a=+this._x.call(null,r[s]))||(n[s]=a,a<i&&(i=a),a>o&&(o=a));if(i>o)return this;this.cover(i).cover(o);for(let s=0;s<e;++s)eb(this,n[s],r[s]);return this}function rb(r){if(isNaN(r=+r))return this;var e=this._x0,n=this._x1;if(isNaN(e))n=(e=Math.floor(r))+1;else{for(var i=n-e||1,o=this._root,s,a;e>r||r>=n;)switch(a=+(r<e),s=new Array(2),s[a]=o,o=s,i*=2,a){case 0:n=e+i;break;case 1:e=n-i;break}this._root&&this._root.length&&(this._root=o)}return this._x0=e,this._x1=n,this}function nb(){var r=[];return this.visit(function(e){if(!e.length)do r.push(e.data);while(e=e.next)}),r}function ib(r){return arguments.length?this.cover(+r[0][0]).cover(+r[1][0]):isNaN(this._x0)?void 0:[[this._x0],[this._x1]]}function bt(r,e,n){this.node=r,this.x0=e,this.x1=n}function ob(r,e){var n,i=this._x0,o,s,a=this._x1,u=[],l=this._root,c,f;for(l&&u.push(new bt(l,i,a)),e==null?e=1/0:(i=r-e,a=r+e);c=u.pop();)if(!(!(l=c.node)||(o=c.x0)>a||(s=c.x1)<i))if(l.length){var h=(o+s)/2;u.push(new bt(l[1],h,s),new bt(l[0],o,h)),(f=+(r>=h))&&(c=u[u.length-1],u[u.length-1]=u[u.length-1-f],u[u.length-1-f]=c)}else{var d=Math.abs(r-+this._x.call(null,l.data));d<e&&(e=d,i=r-d,a=r+d,n=l.data)}return n}function sb(r){if(isNaN(l=+this._x.call(null,r)))return this;var e,n=this._root,i,o,s,a=this._x0,u=this._x1,l,c,f,h,d;if(!n)return this;if(n.length)for(;;){if((f=l>=(c=(a+u)/2))?a=c:u=c,e=n,!(n=n[h=+f]))return this;if(!n.length)break;e[h+1&1]&&(i=e,d=h)}for(;n.data!==r;)if(o=n,!(n=n.next))return this;return(s=n.next)&&delete n.next,o?(s?o.next=s:delete o.next,this):e?(s?e[h]=s:delete e[h],(n=e[0]||e[1])&&n===(e[1]||e[0])&&!n.length&&(i?i[d]=n:this._root=n),this):(this._root=s,this)}function ab(r){for(var e=0,n=r.length;e<n;++e)this.remove(r[e]);return this}function ub(){return this._root}function lb(){var r=0;return this.visit(function(e){if(!e.length)do++r;while(e=e.next)}),r}function cb(r){var e=[],n,i=this._root,o,s,a;for(i&&e.push(new bt(i,this._x0,this._x1));n=e.pop();)if(!r(i=n.node,s=n.x0,a=n.x1)&&i.length){var u=(s+a)/2;(o=i[1])&&e.push(new bt(o,u,a)),(o=i[0])&&e.push(new bt(o,s,u))}return this}function fb(r){var e=[],n=[],i;for(this._root&&e.push(new bt(this._root,this._x0,this._x1));i=e.pop();){var o=i.node;if(o.length){var s,a=i.x0,u=i.x1,l=(a+u)/2;(s=o[0])&&e.push(new bt(s,a,l)),(s=o[1])&&e.push(new bt(s,l,u))}n.push(i)}for(;i=n.pop();)r(i.node,i.x0,i.x1);return this}function hb(r){return r[0]}function db(r){return arguments.length?(this._x=r,this):this._x}function ta(r,e){var n=new Wh(e??hb,NaN,NaN);return r==null?n:n.addAll(r)}function Wh(r,e,n){this._x=r,this._x0=e,this._x1=n,this._root=void 0}function pb(r){for(var e={data:r.data},n=e;r=r.next;)n=n.next={data:r.data};return e}var et=ta.prototype=Wh.prototype;et.copy=function(){var r=new Wh(this._x,this._x0,this._x1),e=this._root,n,i;if(!e)return r;if(!e.length)return r._root=pb(e),r;for(n=[{source:e,target:r._root=new Array(2)}];e=n.pop();)for(var o=0;o<2;++o)(i=e.source[o])&&(i.length?n.push({source:i,target:e.target[o]=new Array(2)}):e.target[o]=pb(i));return r};et.add=Q0;et.addAll=tb;et.cover=rb;et.data=nb;et.extent=ib;et.find=ob;et.remove=sb;et.removeAll=ab;et.root=ub;et.size=lb;et.visit=cb;et.visitAfter=fb;et.x=db;function mb(r){let e=+this._x.call(null,r),n=+this._y.call(null,r);return gb(this.cover(e,n),e,n,r)}function gb(r,e,n,i){if(isNaN(e)||isNaN(n))return r;var o,s=r._root,a={data:i},u=r._x0,l=r._y0,c=r._x1,f=r._y1,h,d,m,y,b,v,g,A;if(!s)return r._root=a,r;for(;s.length;)if((b=e>=(h=(u+c)/2))?u=h:c=h,(v=n>=(d=(l+f)/2))?l=d:f=d,o=s,!(s=s[g=v<<1|b]))return o[g]=a,r;if(m=+r._x.call(null,s.data),y=+r._y.call(null,s.data),e===m&&n===y)return a.next=s,o?o[g]=a:r._root=a,r;do o=o?o[g]=new Array(4):r._root=new Array(4),(b=e>=(h=(u+c)/2))?u=h:c=h,(v=n>=(d=(l+f)/2))?l=d:f=d;while((g=v<<1|b)===(A=(y>=d)<<1|m>=h));return o[A]=s,o[g]=a,r}function yb(r){var e,n,i=r.length,o,s,a=new Array(i),u=new Array(i),l=1/0,c=1/0,f=-1/0,h=-1/0;for(n=0;n<i;++n)isNaN(o=+this._x.call(null,e=r[n]))||isNaN(s=+this._y.call(null,e))||(a[n]=o,u[n]=s,o<l&&(l=o),o>f&&(f=o),s<c&&(c=s),s>h&&(h=s));if(l>f||c>h)return this;for(this.cover(l,c).cover(f,h),n=0;n<i;++n)gb(this,a[n],u[n],r[n]);return this}function vb(r,e){if(isNaN(r=+r)||isNaN(e=+e))return this;var n=this._x0,i=this._y0,o=this._x1,s=this._y1;if(isNaN(n))o=(n=Math.floor(r))+1,s=(i=Math.floor(e))+1;else{for(var a=o-n||1,u=this._root,l,c;n>r||r>=o||i>e||e>=s;)switch(c=(e<i)<<1|r<n,l=new Array(4),l[c]=u,u=l,a*=2,c){case 0:o=n+a,s=i+a;break;case 1:n=o-a,s=i+a;break;case 2:o=n+a,i=s-a;break;case 3:n=o-a,i=s-a;break}this._root&&this._root.length&&(this._root=u)}return this._x0=n,this._y0=i,this._x1=o,this._y1=s,this}function bb(){var r=[];return this.visit(function(e){if(!e.length)do r.push(e.data);while(e=e.next)}),r}function _b(r){return arguments.length?this.cover(+r[0][0],+r[0][1]).cover(+r[1][0],+r[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function ke(r,e,n,i,o){this.node=r,this.x0=e,this.y0=n,this.x1=i,this.y1=o}function wb(r,e,n){var i,o=this._x0,s=this._y0,a,u,l,c,f=this._x1,h=this._y1,d=[],m=this._root,y,b;for(m&&d.push(new ke(m,o,s,f,h)),n==null?n=1/0:(o=r-n,s=e-n,f=r+n,h=e+n,n*=n);y=d.pop();)if(!(!(m=y.node)||(a=y.x0)>f||(u=y.y0)>h||(l=y.x1)<o||(c=y.y1)<s))if(m.length){var v=(a+l)/2,g=(u+c)/2;d.push(new ke(m[3],v,g,l,c),new ke(m[2],a,g,v,c),new ke(m[1],v,u,l,g),new ke(m[0],a,u,v,g)),(b=(e>=g)<<1|r>=v)&&(y=d[d.length-1],d[d.length-1]=d[d.length-1-b],d[d.length-1-b]=y)}else{var A=r-+this._x.call(null,m.data),E=e-+this._y.call(null,m.data),w=A*A+E*E;if(w<n){var x=Math.sqrt(n=w);o=r-x,s=e-x,f=r+x,h=e+x,i=m.data}}return i}function xb(r){if(isNaN(f=+this._x.call(null,r))||isNaN(h=+this._y.call(null,r)))return this;var e,n=this._root,i,o,s,a=this._x0,u=this._y0,l=this._x1,c=this._y1,f,h,d,m,y,b,v,g;if(!n)return this;if(n.length)for(;;){if((y=f>=(d=(a+l)/2))?a=d:l=d,(b=h>=(m=(u+c)/2))?u=m:c=m,e=n,!(n=n[v=b<<1|y]))return this;if(!n.length)break;(e[v+1&3]||e[v+2&3]||e[v+3&3])&&(i=e,g=v)}for(;n.data!==r;)if(o=n,!(n=n.next))return this;return(s=n.next)&&delete n.next,o?(s?o.next=s:delete o.next,this):e?(s?e[v]=s:delete e[v],(n=e[0]||e[1]||e[2]||e[3])&&n===(e[3]||e[2]||e[1]||e[0])&&!n.length&&(i?i[g]=n:this._root=n),this):(this._root=s,this)}function Ab(r){for(var e=0,n=r.length;e<n;++e)this.remove(r[e]);return this}function Cb(){return this._root}function Ib(){var r=0;return this.visit(function(e){if(!e.length)do++r;while(e=e.next)}),r}function Eb(r){var e=[],n,i=this._root,o,s,a,u,l;for(i&&e.push(new ke(i,this._x0,this._y0,this._x1,this._y1));n=e.pop();)if(!r(i=n.node,s=n.x0,a=n.y0,u=n.x1,l=n.y1)&&i.length){var c=(s+u)/2,f=(a+l)/2;(o=i[3])&&e.push(new ke(o,c,f,u,l)),(o=i[2])&&e.push(new ke(o,s,f,c,l)),(o=i[1])&&e.push(new ke(o,c,a,u,f)),(o=i[0])&&e.push(new ke(o,s,a,c,f))}return this}function Ob(r){var e=[],n=[],i;for(this._root&&e.push(new ke(this._root,this._x0,this._y0,this._x1,this._y1));i=e.pop();){var o=i.node;if(o.length){var s,a=i.x0,u=i.y0,l=i.x1,c=i.y1,f=(a+l)/2,h=(u+c)/2;(s=o[0])&&e.push(new ke(s,a,u,f,h)),(s=o[1])&&e.push(new ke(s,f,u,l,h)),(s=o[2])&&e.push(new ke(s,a,h,f,c)),(s=o[3])&&e.push(new ke(s,f,h,l,c))}n.push(i)}for(;i=n.pop();)r(i.node,i.x0,i.y0,i.x1,i.y1);return this}function Pb(r){return r[0]}function Tb(r){return arguments.length?(this._x=r,this):this._x}function Sb(r){return r[1]}function Rb(r){return arguments.length?(this._y=r,this):this._y}function ra(r,e,n){var i=new Kh(e??Pb,n??Sb,NaN,NaN,NaN,NaN);return r==null?i:i.addAll(r)}function Kh(r,e,n,i,o,s){this._x=r,this._y=e,this._x0=n,this._y0=i,this._x1=o,this._y1=s,this._root=void 0}function Mb(r){for(var e={data:r.data},n=e;r=r.next;)n=n.next={data:r.data};return e}var Ze=ra.prototype=Kh.prototype;Ze.copy=function(){var r=new Kh(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,n,i;if(!e)return r;if(!e.length)return r._root=Mb(e),r;for(n=[{source:e,target:r._root=new Array(4)}];e=n.pop();)for(var o=0;o<4;++o)(i=e.source[o])&&(i.length?n.push({source:i,target:e.target[o]=new Array(4)}):e.target[o]=Mb(i));return r};Ze.add=mb;Ze.addAll=yb;Ze.cover=vb;Ze.data=bb;Ze.extent=_b;Ze.find=wb;Ze.remove=xb;Ze.removeAll=Ab;Ze.root=Cb;Ze.size=Ib;Ze.visit=Eb;Ze.visitAfter=Ob;Ze.x=Tb;Ze.y=Rb;function kb(r){let e=+this._x.call(null,r),n=+this._y.call(null,r),i=+this._z.call(null,r);return Db(this.cover(e,n,i),e,n,i,r)}function Db(r,e,n,i,o){if(isNaN(e)||isNaN(n)||isNaN(i))return r;var s,a=r._root,u={data:o},l=r._x0,c=r._y0,f=r._z0,h=r._x1,d=r._y1,m=r._z1,y,b,v,g,A,E,w,x,C,O,T;if(!a)return r._root=u,r;for(;a.length;)if((w=e>=(y=(l+h)/2))?l=y:h=y,(x=n>=(b=(c+d)/2))?c=b:d=b,(C=i>=(v=(f+m)/2))?f=v:m=v,s=a,!(a=a[O=C<<2|x<<1|w]))return s[O]=u,r;if(g=+r._x.call(null,a.data),A=+r._y.call(null,a.data),E=+r._z.call(null,a.data),e===g&&n===A&&i===E)return u.next=a,s?s[O]=u:r._root=u,r;do s=s?s[O]=new Array(8):r._root=new Array(8),(w=e>=(y=(l+h)/2))?l=y:h=y,(x=n>=(b=(c+d)/2))?c=b:d=b,(C=i>=(v=(f+m)/2))?f=v:m=v;while((O=C<<2|x<<1|w)===(T=(E>=v)<<2|(A>=b)<<1|g>=y));return s[T]=a,s[O]=u,r}function Nb(r){Array.isArray(r)||(r=Array.from(r));let e=r.length,n=new Float64Array(e),i=new Float64Array(e),o=new Float64Array(e),s=1/0,a=1/0,u=1/0,l=-1/0,c=-1/0,f=-1/0;for(let h=0,d,m,y,b;h<e;++h)isNaN(m=+this._x.call(null,d=r[h]))||isNaN(y=+this._y.call(null,d))||isNaN(b=+this._z.call(null,d))||(n[h]=m,i[h]=y,o[h]=b,m<s&&(s=m),m>l&&(l=m),y<a&&(a=y),y>c&&(c=y),b<u&&(u=b),b>f&&(f=b));if(s>l||a>c||u>f)return this;this.cover(s,a,u).cover(l,c,f);for(let h=0;h<e;++h)Db(this,n[h],i[h],o[h],r[h]);return this}function jb(r,e,n){if(isNaN(r=+r)||isNaN(e=+e)||isNaN(n=+n))return this;var i=this._x0,o=this._y0,s=this._z0,a=this._x1,u=this._y1,l=this._z1;if(isNaN(i))a=(i=Math.floor(r))+1,u=(o=Math.floor(e))+1,l=(s=Math.floor(n))+1;else{for(var c=a-i||1,f=this._root,h,d;i>r||r>=a||o>e||e>=u||s>n||n>=l;)switch(d=(n<s)<<2|(e<o)<<1|r<i,h=new Array(8),h[d]=f,f=h,c*=2,d){case 0:a=i+c,u=o+c,l=s+c;break;case 1:i=a-c,u=o+c,l=s+c;break;case 2:a=i+c,o=u-c,l=s+c;break;case 3:i=a-c,o=u-c,l=s+c;break;case 4:a=i+c,u=o+c,s=l-c;break;case 5:i=a-c,u=o+c,s=l-c;break;case 6:a=i+c,o=u-c,s=l-c;break;case 7:i=a-c,o=u-c,s=l-c;break}this._root&&this._root.length&&(this._root=f)}return this._x0=i,this._y0=o,this._z0=s,this._x1=a,this._y1=u,this._z1=l,this}function Fb(){var r=[];return this.visit(function(e){if(!e.length)do r.push(e.data);while(e=e.next)}),r}function zb(r){return arguments.length?this.cover(+r[0][0],+r[0][1],+r[0][2]).cover(+r[1][0],+r[1][1],+r[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]}function se(r,e,n,i,o,s,a){this.node=r,this.x0=e,this.y0=n,this.z0=i,this.x1=o,this.y1=s,this.z1=a}function $b(r,e,n,i){var o,s=this._x0,a=this._y0,u=this._z0,l,c,f,h,d,m,y=this._x1,b=this._y1,v=this._z1,g=[],A=this._root,E,w;for(A&&g.push(new se(A,s,a,u,y,b,v)),i==null?i=1/0:(s=r-i,a=e-i,u=n-i,y=r+i,b=e+i,v=n+i,i*=i);E=g.pop();)if(!(!(A=E.node)||(l=E.x0)>y||(c=E.y0)>b||(f=E.z0)>v||(h=E.x1)<s||(d=E.y1)<a||(m=E.z1)<u))if(A.length){var x=(l+h)/2,C=(c+d)/2,O=(f+m)/2;g.push(new se(A[7],x,C,O,h,d,m),new se(A[6],l,C,O,x,d,m),new se(A[5],x,c,O,h,C,m),new se(A[4],l,c,O,x,C,m),new se(A[3],x,C,f,h,d,O),new se(A[2],l,C,f,x,d,O),new se(A[1],x,c,f,h,C,O),new se(A[0],l,c,f,x,C,O)),(w=(n>=O)<<2|(e>=C)<<1|r>=x)&&(E=g[g.length-1],g[g.length-1]=g[g.length-1-w],g[g.length-1-w]=E)}else{var T=r-+this._x.call(null,A.data),M=e-+this._y.call(null,A.data),D=n-+this._z.call(null,A.data),z=T*T+M*M+D*D;if(z<i){var L=Math.sqrt(i=z);s=r-L,a=e-L,u=n-L,y=r+L,b=e+L,v=n+L,o=A.data}}return o}function Lb(r){if(isNaN(d=+this._x.call(null,r))||isNaN(m=+this._y.call(null,r))||isNaN(y=+this._z.call(null,r)))return this;var e,n=this._root,i,o,s,a=this._x0,u=this._y0,l=this._z0,c=this._x1,f=this._y1,h=this._z1,d,m,y,b,v,g,A,E,w,x,C;if(!n)return this;if(n.length)for(;;){if((A=d>=(b=(a+c)/2))?a=b:c=b,(E=m>=(v=(u+f)/2))?u=v:f=v,(w=y>=(g=(l+h)/2))?l=g:h=g,e=n,!(n=n[x=w<<2|E<<1|A]))return this;if(!n.length)break;(e[x+1&7]||e[x+2&7]||e[x+3&7]||e[x+4&7]||e[x+5&7]||e[x+6&7]||e[x+7&7])&&(i=e,C=x)}for(;n.data!==r;)if(o=n,!(n=n.next))return this;return(s=n.next)&&delete n.next,o?(s?o.next=s:delete o.next,this):e?(s?e[x]=s:delete e[x],(n=e[0]||e[1]||e[2]||e[3]||e[4]||e[5]||e[6]||e[7])&&n===(e[7]||e[6]||e[5]||e[4]||e[3]||e[2]||e[1]||e[0])&&!n.length&&(i?i[C]=n:this._root=n),this):(this._root=s,this)}function Ub(r){for(var e=0,n=r.length;e<n;++e)this.remove(r[e]);return this}function Vb(){return this._root}function Bb(){var r=0;return this.visit(function(e){if(!e.length)do++r;while(e=e.next)}),r}function qb(r){var e=[],n,i=this._root,o,s,a,u,l,c,f;for(i&&e.push(new se(i,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));n=e.pop();)if(!r(i=n.node,s=n.x0,a=n.y0,u=n.z0,l=n.x1,c=n.y1,f=n.z1)&&i.length){var h=(s+l)/2,d=(a+c)/2,m=(u+f)/2;(o=i[7])&&e.push(new se(o,h,d,m,l,c,f)),(o=i[6])&&e.push(new se(o,s,d,m,h,c,f)),(o=i[5])&&e.push(new se(o,h,a,m,l,d,f)),(o=i[4])&&e.push(new se(o,s,a,m,h,d,f)),(o=i[3])&&e.push(new se(o,h,d,u,l,c,m)),(o=i[2])&&e.push(new se(o,s,d,u,h,c,m)),(o=i[1])&&e.push(new se(o,h,a,u,l,d,m)),(o=i[0])&&e.push(new se(o,s,a,u,h,d,m))}return this}function Gb(r){var e=[],n=[],i;for(this._root&&e.push(new se(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));i=e.pop();){var o=i.node;if(o.length){var s,a=i.x0,u=i.y0,l=i.z0,c=i.x1,f=i.y1,h=i.z1,d=(a+c)/2,m=(u+f)/2,y=(l+h)/2;(s=o[0])&&e.push(new se(s,a,u,l,d,m,y)),(s=o[1])&&e.push(new se(s,d,u,l,c,m,y)),(s=o[2])&&e.push(new se(s,a,m,l,d,f,y)),(s=o[3])&&e.push(new se(s,d,m,l,c,f,y)),(s=o[4])&&e.push(new se(s,a,u,y,d,m,h)),(s=o[5])&&e.push(new se(s,d,u,y,c,m,h)),(s=o[6])&&e.push(new se(s,a,m,y,d,f,h)),(s=o[7])&&e.push(new se(s,d,m,y,c,f,h))}n.push(i)}for(;i=n.pop();)r(i.node,i.x0,i.y0,i.z0,i.x1,i.y1,i.z1);return this}function Hb(r){return r[0]}function Wb(r){return arguments.length?(this._x=r,this):this._x}function Kb(r){return r[1]}function Zb(r){return arguments.length?(this._y=r,this):this._y}function Xb(r){return r[2]}function Jb(r){return arguments.length?(this._z=r,this):this._z}function na(r,e,n,i){var o=new Zh(e??Hb,n??Kb,i??Xb,NaN,NaN,NaN,NaN,NaN,NaN);return r==null?o:o.addAll(r)}function Zh(r,e,n,i,o,s,a,u,l){this._x=r,this._y=e,this._z=n,this._x0=i,this._y0=o,this._z0=s,this._x1=a,this._y1=u,this._z1=l,this._root=void 0}function Yb(r){for(var e={data:r.data},n=e;r=r.next;)n=n.next={data:r.data};return e}var Be=na.prototype=Zh.prototype;Be.copy=function(){var r=new Zh(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),e=this._root,n,i;if(!e)return r;if(!e.length)return r._root=Yb(e),r;for(n=[{source:e,target:r._root=new Array(8)}];e=n.pop();)for(var o=0;o<8;++o)(i=e.source[o])&&(i.length?n.push({source:i,target:e.target[o]=new Array(8)}):e.target[o]=Yb(i));return r};Be.add=kb;Be.addAll=Nb;Be.cover=jb;Be.data=Fb;Be.extent=zb;Be.find=$b;Be.remove=Lb;Be.removeAll=Ub;Be.root=Vb;Be.size=Bb;Be.visit=qb;Be.visitAfter=Gb;Be.x=Wb;Be.y=Zb;Be.z=Jb;function _t(r){return function(){return r}}function Lt(r){return(r()-.5)*1e-6}function $T(r){return r.index}function Qb(r,e){var n=r.get(e);if(!n)throw new Error("node not found: "+e);return n}function Xh(r){var e=$T,n=d,i,o=_t(30),s,a,u,l,c,f,h=1;r==null&&(r=[]);function d(g){return 1/Math.min(l[g.source.index],l[g.target.index])}function m(g){for(var A=0,E=r.length;A<h;++A)for(var w=0,x,C,O,T=0,M=0,D=0,z,L;w<E;++w)x=r[w],C=x.source,O=x.target,T=O.x+O.vx-C.x-C.vx||Lt(f),u>1&&(M=O.y+O.vy-C.y-C.vy||Lt(f)),u>2&&(D=O.z+O.vz-C.z-C.vz||Lt(f)),z=Math.sqrt(T*T+M*M+D*D),z=(z-s[w])/z*g*i[w],T*=z,M*=z,D*=z,O.vx-=T*(L=c[w]),u>1&&(O.vy-=M*L),u>2&&(O.vz-=D*L),C.vx+=T*(L=1-L),u>1&&(C.vy+=M*L),u>2&&(C.vz+=D*L)}function y(){if(a){var g,A=a.length,E=r.length,w=new Map(a.map((C,O)=>[e(C,O,a),C])),x;for(g=0,l=new Array(A);g<E;++g)x=r[g],x.index=g,typeof x.source!="object"&&(x.source=Qb(w,x.source)),typeof x.target!="object"&&(x.target=Qb(w,x.target)),l[x.source.index]=(l[x.source.index]||0)+1,l[x.target.index]=(l[x.target.index]||0)+1;for(g=0,c=new Array(E);g<E;++g)x=r[g],c[g]=l[x.source.index]/(l[x.source.index]+l[x.target.index]);i=new Array(E),b(),s=new Array(E),v()}}function b(){if(a)for(var g=0,A=r.length;g<A;++g)i[g]=+n(r[g],g,r)}function v(){if(a)for(var g=0,A=r.length;g<A;++g)s[g]=+o(r[g],g,r)}return m.initialize=function(g,...A){a=g,f=A.find(E=>typeof E=="function")||Math.random,u=A.find(E=>[1,2,3].includes(E))||2,y()},m.links=function(g){return arguments.length?(r=g,y(),m):r},m.id=function(g){return arguments.length?(e=g,m):e},m.iterations=function(g){return arguments.length?(h=+g,m):h},m.strength=function(g){return arguments.length?(n=typeof g=="function"?g:_t(+g),b(),m):n},m.distance=function(g){return arguments.length?(o=typeof g=="function"?g:_t(+g),v(),m):o},m}function e_(){let r=1;return()=>(r=(1664525*r+1013904223)%4294967296)/4294967296}var t_=3;function xl(r){return r.x}function Jh(r){return r.y}function r_(r){return r.z}var LT=10,UT=Math.PI*(3-Math.sqrt(5)),VT=Math.PI*20/(9+Math.sqrt(221));function Yh(r,e){e=e||2;var n=Math.min(t_,Math.max(1,Math.round(e))),i,o=1,s=.001,a=1-Math.pow(s,1/300),u=0,l=.6,c=new Map,f=oo(m),h=vr("tick","end"),d=e_();r==null&&(r=[]);function m(){y(),h.call("tick",i),o<s&&(f.stop(),h.call("end",i))}function y(g){var A,E=r.length,w;g===void 0&&(g=1);for(var x=0;x<g;++x)for(o+=(u-o)*a,c.forEach(function(C){C(o)}),A=0;A<E;++A)w=r[A],w.fx==null?w.x+=w.vx*=l:(w.x=w.fx,w.vx=0),n>1&&(w.fy==null?w.y+=w.vy*=l:(w.y=w.fy,w.vy=0)),n>2&&(w.fz==null?w.z+=w.vz*=l:(w.z=w.fz,w.vz=0));return i}function b(){for(var g=0,A=r.length,E;g<A;++g){if(E=r[g],E.index=g,E.fx!=null&&(E.x=E.fx),E.fy!=null&&(E.y=E.fy),E.fz!=null&&(E.z=E.fz),isNaN(E.x)||n>1&&isNaN(E.y)||n>2&&isNaN(E.z)){var w=LT*(n>2?Math.cbrt(.5+g):n>1?Math.sqrt(.5+g):g),x=g*UT,C=g*VT;n===1?E.x=w:n===2?(E.x=w*Math.cos(x),E.y=w*Math.sin(x)):(E.x=w*Math.sin(x)*Math.cos(C),E.y=w*Math.cos(x),E.z=w*Math.sin(x)*Math.sin(C))}(isNaN(E.vx)||n>1&&isNaN(E.vy)||n>2&&isNaN(E.vz))&&(E.vx=0,n>1&&(E.vy=0),n>2&&(E.vz=0))}}function v(g){return g.initialize&&g.initialize(r,d,n),g}return b(),i={tick:y,restart:function(){return f.restart(m),i},stop:function(){return f.stop(),i},numDimensions:function(g){return arguments.length?(n=Math.min(t_,Math.max(1,Math.round(g))),c.forEach(v),i):n},nodes:function(g){return arguments.length?(r=g,b(),c.forEach(v),i):r},alpha:function(g){return arguments.length?(o=+g,i):o},alphaMin:function(g){return arguments.length?(s=+g,i):s},alphaDecay:function(g){return arguments.length?(a=+g,i):+a},alphaTarget:function(g){return arguments.length?(u=+g,i):u},velocityDecay:function(g){return arguments.length?(l=1-g,i):1-l},randomSource:function(g){return arguments.length?(d=g,c.forEach(v),i):d},force:function(g,A){return arguments.length>1?(A==null?c.delete(g):c.set(g,v(A)),i):c.get(g)},find:function(){var g=Array.prototype.slice.call(arguments),A=g.shift()||0,E=(n>1?g.shift():null)||0,w=(n>2?g.shift():null)||0,x=g.shift()||1/0,C=0,O=r.length,T,M,D,z,L,Q;for(x*=x,C=0;C<O;++C)L=r[C],T=A-L.x,M=E-(L.y||0),D=w-(L.z||0),z=T*T+M*M+D*D,z<x&&(Q=L,x=z);return Q},on:function(g,A){return arguments.length>1?(h.on(g,A),i):h.on(g)}}}function Qh(){var r,e,n,i,o,s=_t(-30),a,u=1,l=1/0,c=.81;function f(y){var b,v=r.length,g=(e===1?ta(r,xl):e===2?ra(r,xl,Jh):e===3?na(r,xl,Jh,r_):null).visitAfter(d);for(o=y,b=0;b<v;++b)n=r[b],g.visit(m)}function h(){if(r){var y,b=r.length,v;for(a=new Array(b),y=0;y<b;++y)v=r[y],a[v.index]=+s(v,y,r)}}function d(y){var b=0,v,g,A=0,E,w,x,C,O=y.length;if(O){for(E=w=x=C=0;C<O;++C)(v=y[C])&&(g=Math.abs(v.value))&&(b+=v.value,A+=g,E+=g*(v.x||0),w+=g*(v.y||0),x+=g*(v.z||0));b*=Math.sqrt(4/O),y.x=E/A,e>1&&(y.y=w/A),e>2&&(y.z=x/A)}else{v=y,v.x=v.data.x,e>1&&(v.y=v.data.y),e>2&&(v.z=v.data.z);do b+=a[v.data.index];while(v=v.next)}y.value=b}function m(y,b,v,g,A){if(!y.value)return!0;var E=[v,g,A][e-1],w=y.x-n.x,x=e>1?y.y-n.y:0,C=e>2?y.z-n.z:0,O=E-b,T=w*w+x*x+C*C;if(O*O/c<T)return T<l&&(w===0&&(w=Lt(i),T+=w*w),e>1&&x===0&&(x=Lt(i),T+=x*x),e>2&&C===0&&(C=Lt(i),T+=C*C),T<u&&(T=Math.sqrt(u*T)),n.vx+=w*y.value*o/T,e>1&&(n.vy+=x*y.value*o/T),e>2&&(n.vz+=C*y.value*o/T)),!0;if(y.length||T>=l)return;(y.data!==n||y.next)&&(w===0&&(w=Lt(i),T+=w*w),e>1&&x===0&&(x=Lt(i),T+=x*x),e>2&&C===0&&(C=Lt(i),T+=C*C),T<u&&(T=Math.sqrt(u*T)));do y.data!==n&&(O=a[y.data.index]*o/T,n.vx+=w*O,e>1&&(n.vy+=x*O),e>2&&(n.vz+=C*O));while(y=y.next)}return f.initialize=function(y,...b){r=y,i=b.find(v=>typeof v=="function")||Math.random,e=b.find(v=>[1,2,3].includes(v))||2,h()},f.strength=function(y){return arguments.length?(s=typeof y=="function"?y:_t(+y),h(),f):s},f.distanceMin=function(y){return arguments.length?(u=y*y,f):Math.sqrt(u)},f.distanceMax=function(y){return arguments.length?(l=y*y,f):Math.sqrt(l)},f.theta=function(y){return arguments.length?(c=y*y,f):Math.sqrt(c)},f}function ed(r,e,n,i){var o,s,a=_t(.1),u,l;typeof r!="function"&&(r=_t(+r)),e==null&&(e=0),n==null&&(n=0),i==null&&(i=0);function c(h){for(var d=0,m=o.length;d<m;++d){var y=o[d],b=y.x-e||1e-6,v=(y.y||0)-n||1e-6,g=(y.z||0)-i||1e-6,A=Math.sqrt(b*b+v*v+g*g),E=(l[d]-A)*u[d]*h/A;y.vx+=b*E,s>1&&(y.vy+=v*E),s>2&&(y.vz+=g*E)}}function f(){if(o){var h,d=o.length;for(u=new Array(d),l=new Array(d),h=0;h<d;++h)l[h]=+r(o[h],h,o),u[h]=isNaN(l[h])?0:+a(o[h],h,o)}}return c.initialize=function(h,...d){o=h,s=d.find(m=>[1,2,3].includes(m))||2,f()},c.strength=function(h){return arguments.length?(a=typeof h=="function"?h:_t(+h),f(),c):a},c.radius=function(h){return arguments.length?(r=typeof h=="function"?h:_t(+h),f(),c):r},c.x=function(h){return arguments.length?(e=+h,c):e},c.y=function(h){return arguments.length?(n=+h,c):n},c.z=function(h){return arguments.length?(i=+h,c):i},c}var{abs:ia,cos:wr,sin:fo,acos:BT,atan2:oa,sqrt:tn,pow:wt}=Math;function sa(r){return r<0?-wt(-r,1/3):wt(r,1/3)}var n_=Math.PI,Al=2*n_,rn=n_/2,qT=1e-6,td=Number.MAX_SAFE_INTEGER||9007199254740991,rd=Number.MIN_SAFE_INTEGER||-9007199254740991,GT={x:0,y:0,z:0},R={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(r,e){let n=e(r),i=n.x*n.x+n.y*n.y;return typeof n.z<"u"&&(i+=n.z*n.z),tn(i)},compute:function(r,e,n){if(r===0)return e[0].t=0,e[0];let i=e.length-1;if(r===1)return e[i].t=1,e[i];let o=1-r,s=e;if(i===0)return e[0].t=r,e[0];if(i===1){let u={x:o*s[0].x+r*s[1].x,y:o*s[0].y+r*s[1].y,t:r};return n&&(u.z=o*s[0].z+r*s[1].z),u}if(i<4){let u=o*o,l=r*r,c,f,h,d=0;i===2?(s=[s[0],s[1],s[2],GT],c=u,f=o*r*2,h=l):i===3&&(c=u*o,f=u*r*3,h=o*l*3,d=r*l);let m={x:c*s[0].x+f*s[1].x+h*s[2].x+d*s[3].x,y:c*s[0].y+f*s[1].y+h*s[2].y+d*s[3].y,t:r};return n&&(m.z=c*s[0].z+f*s[1].z+h*s[2].z+d*s[3].z),m}let a=JSON.parse(JSON.stringify(e));for(;a.length>1;){for(let u=0;u<a.length-1;u++)a[u]={x:a[u].x+(a[u+1].x-a[u].x)*r,y:a[u].y+(a[u+1].y-a[u].y)*r},typeof a[u].z<"u"&&(a[u].z=a[u].z+(a[u+1].z-a[u].z)*r);a.splice(a.length-1,1)}return a[0].t=r,a[0]},computeWithRatios:function(r,e,n,i){let o=1-r,s=n,a=e,u=s[0],l=s[1],c=s[2],f=s[3],h;if(u*=o,l*=r,a.length===2)return h=u+l,{x:(u*a[0].x+l*a[1].x)/h,y:(u*a[0].y+l*a[1].y)/h,z:i?(u*a[0].z+l*a[1].z)/h:!1,t:r};if(u*=o,l*=2*o,c*=r*r,a.length===3)return h=u+l+c,{x:(u*a[0].x+l*a[1].x+c*a[2].x)/h,y:(u*a[0].y+l*a[1].y+c*a[2].y)/h,z:i?(u*a[0].z+l*a[1].z+c*a[2].z)/h:!1,t:r};if(u*=o,l*=1.5*o,c*=3*o,f*=r*r*r,a.length===4)return h=u+l+c+f,{x:(u*a[0].x+l*a[1].x+c*a[2].x+f*a[3].x)/h,y:(u*a[0].y+l*a[1].y+c*a[2].y+f*a[3].y)/h,z:i?(u*a[0].z+l*a[1].z+c*a[2].z+f*a[3].z)/h:!1,t:r}},derive:function(r,e){let n=[];for(let i=r,o=i.length,s=o-1;o>1;o--,s--){let a=[];for(let u=0,l;u<s;u++)l={x:s*(i[u+1].x-i[u].x),y:s*(i[u+1].y-i[u].y)},e&&(l.z=s*(i[u+1].z-i[u].z)),a.push(l);n.push(a),i=a}return n},between:function(r,e,n){return e<=r&&r<=n||R.approximately(r,e)||R.approximately(r,n)},approximately:function(r,e,n){return ia(r-e)<=(n||qT)},length:function(r){let n=R.Tvalues.length,i=0;for(let o=0,s;o<n;o++)s=.5*R.Tvalues[o]+.5,i+=R.Cvalues[o]*R.arcfn(s,r);return .5*i},map:function(r,e,n,i,o){let s=n-e,a=o-i,u=r-e,l=u/s;return i+a*l},lerp:function(r,e,n){let i={x:e.x+r*(n.x-e.x),y:e.y+r*(n.y-e.y)};return e.z!==void 0&&n.z!==void 0&&(i.z=e.z+r*(n.z-e.z)),i},pointToString:function(r){let e=r.x+"/"+r.y;return typeof r.z<"u"&&(e+="/"+r.z),e},pointsToString:function(r){return"["+r.map(R.pointToString).join(", ")+"]"},copy:function(r){return JSON.parse(JSON.stringify(r))},angle:function(r,e,n){let i=e.x-r.x,o=e.y-r.y,s=n.x-r.x,a=n.y-r.y,u=i*a-o*s,l=i*s+o*a;return oa(u,l)},round:function(r,e){let n=""+r,i=n.indexOf(".");return parseFloat(n.substring(0,i+1+e))},dist:function(r,e){let n=r.x-e.x,i=r.y-e.y;return tn(n*n+i*i)},closest:function(r,e){let n=wt(2,63),i,o;return r.forEach(function(s,a){o=R.dist(e,s),o<n&&(n=o,i=a)}),{mdist:n,mpos:i}},abcratio:function(r,e){if(e!==2&&e!==3)return!1;if(typeof r>"u")r=.5;else if(r===0||r===1)return r;let n=wt(r,e)+wt(1-r,e),i=n-1;return ia(i/n)},projectionratio:function(r,e){if(e!==2&&e!==3)return!1;if(typeof r>"u")r=.5;else if(r===0||r===1)return r;let n=wt(1-r,e),i=wt(r,e)+n;return n/i},lli8:function(r,e,n,i,o,s,a,u){let l=(r*i-e*n)*(o-a)-(r-n)*(o*u-s*a),c=(r*i-e*n)*(s-u)-(e-i)*(o*u-s*a),f=(r-n)*(s-u)-(e-i)*(o-a);return f==0?!1:{x:l/f,y:c/f}},lli4:function(r,e,n,i){let o=r.x,s=r.y,a=e.x,u=e.y,l=n.x,c=n.y,f=i.x,h=i.y;return R.lli8(o,s,a,u,l,c,f,h)},lli:function(r,e){return R.lli4(r,r.c,e,e.c)},makeline:function(r,e){return new ci(r.x,r.y,(r.x+e.x)/2,(r.y+e.y)/2,e.x,e.y)},findbbox:function(r){let e=td,n=td,i=rd,o=rd;return r.forEach(function(s){let a=s.bbox();e>a.x.min&&(e=a.x.min),n>a.y.min&&(n=a.y.min),i<a.x.max&&(i=a.x.max),o<a.y.max&&(o=a.y.max)}),{x:{min:e,mid:(e+i)/2,max:i,size:i-e},y:{min:n,mid:(n+o)/2,max:o,size:o-n}}},shapeintersections:function(r,e,n,i,o){if(!R.bboxoverlap(e,i))return[];let s=[],a=[r.startcap,r.forward,r.back,r.endcap],u=[n.startcap,n.forward,n.back,n.endcap];return a.forEach(function(l){l.virtual||u.forEach(function(c){if(c.virtual)return;let f=l.intersects(c,o);f.length>0&&(f.c1=l,f.c2=c,f.s1=r,f.s2=n,s.push(f))})}),s},makeshape:function(r,e,n){let i=e.points.length,o=r.points.length,s=R.makeline(e.points[i-1],r.points[0]),a=R.makeline(r.points[o-1],e.points[0]),u={startcap:s,forward:r,back:e,endcap:a,bbox:R.findbbox([s,r,e,a])};return u.intersections=function(l){return R.shapeintersections(u,u.bbox,l,l.bbox,n)},u},getminmax:function(r,e,n){if(!n)return{min:0,max:0};let i=td,o=rd,s,a;n.indexOf(0)===-1&&(n=[0].concat(n)),n.indexOf(1)===-1&&n.push(1);for(let u=0,l=n.length;u<l;u++)s=n[u],a=r.get(s),a[e]<i&&(i=a[e]),a[e]>o&&(o=a[e]);return{min:i,mid:(i+o)/2,max:o,size:o-i}},align:function(r,e){let n=e.p1.x,i=e.p1.y,o=-oa(e.p2.y-i,e.p2.x-n),s=function(a){return{x:(a.x-n)*wr(o)-(a.y-i)*fo(o),y:(a.x-n)*fo(o)+(a.y-i)*wr(o)}};return r.map(s)},roots:function(r,e){e=e||{p1:{x:0,y:0},p2:{x:1,y:0}};let n=r.length-1,i=R.align(r,e),o=function(O){return 0<=O&&O<=1};if(n===2){let O=i[0].y,T=i[1].y,M=i[2].y,D=O-2*T+M;if(D!==0){let z=-tn(T*T-O*M),L=-O+T,Q=-(z+L)/D,P=-(-z+L)/D;return[Q,P].filter(o)}else if(T!==M&&D===0)return[(2*T-M)/(2*T-2*M)].filter(o);return[]}let s=i[0].y,a=i[1].y,u=i[2].y,l=i[3].y,c=-s+3*a-3*u+l,f=3*s-6*a+3*u,h=-3*s+3*a,d=s;if(R.approximately(c,0)){if(R.approximately(f,0))return R.approximately(h,0)?[]:[-d/h].filter(o);let O=tn(h*h-4*f*d),T=2*f;return[(O-h)/T,(-h-O)/T].filter(o)}f/=c,h/=c,d/=c;let m=(3*h-f*f)/3,y=m/3,b=(2*f*f*f-9*f*h+27*d)/27,v=b/2,g=v*v+y*y*y,A,E,w,x,C;if(g<0){let O=-m/3,T=O*O*O,M=tn(T),D=-b/(2*M),z=D<-1?-1:D>1?1:D,L=BT(z),Q=sa(M),P=2*Q;return w=P*wr(L/3)-f/3,x=P*wr((L+Al)/3)-f/3,C=P*wr((L+2*Al)/3)-f/3,[w,x,C].filter(o)}else{if(g===0)return A=v<0?sa(-v):-sa(v),w=2*A-f/3,x=-A-f/3,[w,x].filter(o);{let O=tn(g);return A=sa(-v+O),E=sa(v+O),[A-E-f/3].filter(o)}}},droots:function(r){if(r.length===3){let e=r[0],n=r[1],i=r[2],o=e-2*n+i;if(o!==0){let s=-tn(n*n-e*i),a=-e+n,u=-(s+a)/o,l=-(-s+a)/o;return[u,l]}else if(n!==i&&o===0)return[(2*n-i)/(2*(n-i))];return[]}if(r.length===2){let e=r[0],n=r[1];return e!==n?[e/(e-n)]:[]}return[]},curvature:function(r,e,n,i,o){let s,a,u,l,c=0,f=0,h=R.compute(r,e),d=R.compute(r,n),m=h.x*h.x+h.y*h.y;if(i?(s=tn(wt(h.y*d.z-d.y*h.z,2)+wt(h.z*d.x-d.z*h.x,2)+wt(h.x*d.y-d.x*h.y,2)),a=wt(m+h.z*h.z,3/2)):(s=h.x*d.y-h.y*d.x,a=wt(m,3/2)),s===0||a===0)return{k:0,r:0};if(c=s/a,f=a/s,!o){let y=R.curvature(r-.001,e,n,i,!0).k,b=R.curvature(r+.001,e,n,i,!0).k;l=(b-c+(c-y))/2,u=(ia(b-c)+ia(c-y))/2}return{k:c,r:f,dk:l,adk:u}},inflections:function(r){if(r.length<4)return[];let e=R.align(r,{p1:r[0],p2:r.slice(-1)[0]}),n=e[2].x*e[1].y,i=e[3].x*e[1].y,o=e[1].x*e[2].y,s=e[3].x*e[2].y,a=18*(-3*n+2*i+3*o-s),u=18*(3*n-i-3*o),l=18*(o-n);if(R.approximately(a,0)){if(!R.approximately(u,0)){let d=-l/u;if(0<=d&&d<=1)return[d]}return[]}let c=2*a;if(R.approximately(c,0))return[];let f=u*u-4*a*l;if(f<0)return[];let h=Math.sqrt(f);return[(h-u)/c,-(u+h)/c].filter(function(d){return 0<=d&&d<=1})},bboxoverlap:function(r,e){let n=["x","y"],i=n.length;for(let o=0,s,a,u,l;o<i;o++)if(s=n[o],a=r[s].mid,u=e[s].mid,l=(r[s].size+e[s].size)/2,ia(a-u)>=l)return!1;return!0},expandbox:function(r,e){e.x.min<r.x.min&&(r.x.min=e.x.min),e.y.min<r.y.min&&(r.y.min=e.y.min),e.z&&e.z.min<r.z.min&&(r.z.min=e.z.min),e.x.max>r.x.max&&(r.x.max=e.x.max),e.y.max>r.y.max&&(r.y.max=e.y.max),e.z&&e.z.max>r.z.max&&(r.z.max=e.z.max),r.x.mid=(r.x.min+r.x.max)/2,r.y.mid=(r.y.min+r.y.max)/2,r.z&&(r.z.mid=(r.z.min+r.z.max)/2),r.x.size=r.x.max-r.x.min,r.y.size=r.y.max-r.y.min,r.z&&(r.z.size=r.z.max-r.z.min)},pairiteration:function(r,e,n){let i=r.bbox(),o=e.bbox(),s=1e5,a=n||.5;if(i.x.size+i.y.size<a&&o.x.size+o.y.size<a)return[(s*(r._t1+r._t2)/2|0)/s+"/"+(s*(e._t1+e._t2)/2|0)/s];let u=r.split(.5),l=e.split(.5),c=[{left:u.left,right:l.left},{left:u.left,right:l.right},{left:u.right,right:l.right},{left:u.right,right:l.left}];c=c.filter(function(h){return R.bboxoverlap(h.left.bbox(),h.right.bbox())});let f=[];return c.length===0||(c.forEach(function(h){f=f.concat(R.pairiteration(h.left,h.right,a))}),f=f.filter(function(h,d){return f.indexOf(h)===d})),f},getccenter:function(r,e,n){let i=e.x-r.x,o=e.y-r.y,s=n.x-e.x,a=n.y-e.y,u=i*wr(rn)-o*fo(rn),l=i*fo(rn)+o*wr(rn),c=s*wr(rn)-a*fo(rn),f=s*fo(rn)+a*wr(rn),h=(r.x+e.x)/2,d=(r.y+e.y)/2,m=(e.x+n.x)/2,y=(e.y+n.y)/2,b=h+u,v=d+l,g=m+c,A=y+f,E=R.lli8(h,d,b,v,m,y,g,A),w=R.dist(E,r),x=oa(r.y-E.y,r.x-E.x),C=oa(e.y-E.y,e.x-E.x),O=oa(n.y-E.y,n.x-E.x),T;return x<O?((x>C||C>O)&&(x+=Al),x>O&&(T=O,O=x,x=T)):O<C&&C<x?(T=O,O=x,x=T):O+=Al,E.s=x,E.e=O,E.r=w,E},numberSort:function(r,e){return r-e}};var ho=class r{constructor(e){this.curves=[],this._3d=!1,e&&(this.curves=e,this._3d=this.curves[0]._3d)}valueOf(){return this.toString()}toString(){return"["+this.curves.map(function(e){return R.pointsToString(e.points)}).join(", ")+"]"}addCurve(e){this.curves.push(e),this._3d=this._3d||e._3d}length(){return this.curves.map(function(e){return e.length()}).reduce(function(e,n){return e+n})}curve(e){return this.curves[e]}bbox(){let e=this.curves;for(var n=e[0].bbox(),i=1;i<e.length;i++)R.expandbox(n,e[i].bbox());return n}offset(e){let n=[];return this.curves.forEach(function(i){n.push(...i.offset(e))}),new r(n)}};var{abs:aa,min:i_,max:o_,cos:HT,sin:WT,acos:KT,sqrt:ua}=Math,ZT=Math.PI;var ci=class r{constructor(e){let n=e&&e.forEach?e:Array.from(arguments).slice(),i=!1;if(typeof n[0]=="object"){i=n.length;let m=[];n.forEach(function(y){["x","y","z"].forEach(function(b){typeof y[b]<"u"&&m.push(y[b])})}),n=m}let o=!1,s=n.length;if(i){if(i>4){if(arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");o=!0}}else if(s!==6&&s!==8&&s!==9&&s!==12&&arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");let a=this._3d=!o&&(s===9||s===12)||e&&e[0]&&typeof e[0].z<"u",u=this.points=[];for(let m=0,y=a?3:2;m<s;m+=y){var l={x:n[m],y:n[m+1]};a&&(l.z=n[m+2]),u.push(l)}let c=this.order=u.length-1,f=this.dims=["x","y"];a&&f.push("z"),this.dimlen=f.length;let h=R.align(u,{p1:u[0],p2:u[c]}),d=R.dist(u[0],u[c]);this._linear=h.reduce((m,y)=>m+aa(y.y),0)<d/50,this._lut=[],this._t1=0,this._t2=1,this.update()}static quadraticFromPoints(e,n,i,o){if(typeof o>"u"&&(o=.5),o===0)return new r(n,n,i);if(o===1)return new r(e,n,n);let s=r.getABC(2,e,n,i,o);return new r(e,s.A,i)}static cubicFromPoints(e,n,i,o,s){typeof o>"u"&&(o=.5);let a=r.getABC(3,e,n,i,o);typeof s>"u"&&(s=R.dist(n,a.C));let u=s*(1-o)/o,l=R.dist(e,i),c=(i.x-e.x)/l,f=(i.y-e.y)/l,h=s*c,d=s*f,m=u*c,y=u*f,b={x:n.x-h,y:n.y-d},v={x:n.x+m,y:n.y+y},g=a.A,A={x:g.x+(b.x-g.x)/(1-o),y:g.y+(b.y-g.y)/(1-o)},E={x:g.x+(v.x-g.x)/o,y:g.y+(v.y-g.y)/o},w={x:e.x+(A.x-e.x)/o,y:e.y+(A.y-e.y)/o},x={x:i.x+(E.x-i.x)/(1-o),y:i.y+(E.y-i.y)/(1-o)};return new r(e,w,x,i)}static getUtils(){return R}getUtils(){return r.getUtils()}static get PolyBezier(){return ho}valueOf(){return this.toString()}toString(){return R.pointsToString(this.points)}toSVG(){if(this._3d)return!1;let e=this.points,n=e[0].x,i=e[0].y,o=["M",n,i,this.order===2?"Q":"C"];for(let s=1,a=e.length;s<a;s++)o.push(e[s].x),o.push(e[s].y);return o.join(" ")}setRatios(e){if(e.length!==this.points.length)throw new Error("incorrect number of ratio values");this.ratios=e,this._lut=[]}verify(){let e=this.coordDigest();e!==this._print&&(this._print=e,this.update())}coordDigest(){return this.points.map(function(e,n){return""+n+e.x+e.y+(e.z?e.z:0)}).join("")}update(){this._lut=[],this.dpoints=R.derive(this.points,this._3d),this.computedirection()}computedirection(){let e=this.points,n=R.angle(e[0],e[this.order],e[1]);this.clockwise=n>0}length(){return R.length(this.derivative.bind(this))}static getABC(e=2,n,i,o,s=.5){let a=R.projectionratio(s,e),u=1-a,l={x:a*n.x+u*o.x,y:a*n.y+u*o.y},c=R.abcratio(s,e);return{A:{x:i.x+(i.x-l.x)/c,y:i.y+(i.y-l.y)/c},B:i,C:l,S:n,E:o}}getABC(e,n){n=n||this.get(e);let i=this.points[0],o=this.points[this.order];return r.getABC(this.order,i,n,o,e)}getLUT(e){if(this.verify(),e=e||100,this._lut.length===e+1)return this._lut;this._lut=[],e++,this._lut=[];for(let n=0,i,o;n<e;n++)o=n/(e-1),i=this.compute(o),i.t=o,this._lut.push(i);return this._lut}on(e,n){n=n||5;let i=this.getLUT(),o=[];for(let s=0,a,u=0;s<i.length;s++)a=i[s],R.dist(a,e)<n&&(o.push(a),u+=s/i.length);return o.length?t/=o.length:!1}project(e){let n=this.getLUT(),i=n.length-1,o=R.closest(n,e),s=o.mpos,a=(s-1)/i,u=(s+1)/i,l=.1/i,c=o.mdist,f=a,h=f,d;c+=1;for(let m;f<u+l;f+=l)d=this.compute(f),m=R.dist(e,d),m<c&&(c=m,h=f);return h=h<0?0:h>1?1:h,d=this.compute(h),d.t=h,d.d=c,d}get(e){return this.compute(e)}point(e){return this.points[e]}compute(e){return this.ratios?R.computeWithRatios(e,this.points,this.ratios,this._3d):R.compute(e,this.points,this._3d,this.ratios)}raise(){let e=this.points,n=[e[0]],i=e.length;for(let o=1,s,a;o<i;o++)s=e[o],a=e[o-1],n[o]={x:(i-o)/i*s.x+o/i*a.x,y:(i-o)/i*s.y+o/i*a.y};return n[i]=e[i-1],new r(n)}derivative(e){return R.compute(e,this.dpoints[0],this._3d)}dderivative(e){return R.compute(e,this.dpoints[1],this._3d)}align(){let e=this.points;return new r(R.align(e,{p1:e[0],p2:e[e.length-1]}))}curvature(e){return R.curvature(e,this.dpoints[0],this.dpoints[1],this._3d)}inflections(){return R.inflections(this.points)}normal(e){return this._3d?this.__normal3(e):this.__normal2(e)}__normal2(e){let n=this.derivative(e),i=ua(n.x*n.x+n.y*n.y);return{t:e,x:-n.y/i,y:n.x/i}}__normal3(e){let n=this.derivative(e),i=this.derivative(e+.01),o=ua(n.x*n.x+n.y*n.y+n.z*n.z),s=ua(i.x*i.x+i.y*i.y+i.z*i.z);n.x/=o,n.y/=o,n.z/=o,i.x/=s,i.y/=s,i.z/=s;let a={x:i.y*n.z-i.z*n.y,y:i.z*n.x-i.x*n.z,z:i.x*n.y-i.y*n.x},u=ua(a.x*a.x+a.y*a.y+a.z*a.z);a.x/=u,a.y/=u,a.z/=u;let l=[a.x*a.x,a.x*a.y-a.z,a.x*a.z+a.y,a.x*a.y+a.z,a.y*a.y,a.y*a.z-a.x,a.x*a.z-a.y,a.y*a.z+a.x,a.z*a.z];return{t:e,x:l[0]*n.x+l[1]*n.y+l[2]*n.z,y:l[3]*n.x+l[4]*n.y+l[5]*n.z,z:l[6]*n.x+l[7]*n.y+l[8]*n.z}}hull(e){let n=this.points,i=[],o=[],s=0;for(o[s++]=n[0],o[s++]=n[1],o[s++]=n[2],this.order===3&&(o[s++]=n[3]);n.length>1;){i=[];for(let a=0,u,l=n.length-1;a<l;a++)u=R.lerp(e,n[a],n[a+1]),o[s++]=u,i.push(u);n=i}return o}split(e,n){if(e===0&&n)return this.split(n).left;if(n===1)return this.split(e).right;let i=this.hull(e),o={left:this.order===2?new r([i[0],i[3],i[5]]):new r([i[0],i[4],i[7],i[9]]),right:this.order===2?new r([i[5],i[4],i[2]]):new r([i[9],i[8],i[6],i[3]]),span:i};return o.left._t1=R.map(0,0,1,this._t1,this._t2),o.left._t2=R.map(e,0,1,this._t1,this._t2),o.right._t1=R.map(e,0,1,this._t1,this._t2),o.right._t2=R.map(1,0,1,this._t1,this._t2),n?(n=R.map(n,e,1,0,1),o.right.split(n).left):o}extrema(){let e={},n=[];return this.dims.forEach((function(i){let o=function(a){return a[i]},s=this.dpoints[0].map(o);e[i]=R.droots(s),this.order===3&&(s=this.dpoints[1].map(o),e[i]=e[i].concat(R.droots(s))),e[i]=e[i].filter(function(a){return a>=0&&a<=1}),n=n.concat(e[i].sort(R.numberSort))}).bind(this)),e.values=n.sort(R.numberSort).filter(function(i,o){return n.indexOf(i)===o}),e}bbox(){let e=this.extrema(),n={};return this.dims.forEach((function(i){n[i]=R.getminmax(this,i,e[i])}).bind(this)),n}overlaps(e){let n=this.bbox(),i=e.bbox();return R.bboxoverlap(n,i)}offset(e,n){if(typeof n<"u"){let i=this.get(e),o=this.normal(e),s={c:i,n:o,x:i.x+o.x*n,y:i.y+o.y*n};return this._3d&&(s.z=i.z+o.z*n),s}if(this._linear){let i=this.normal(0),o=this.points.map(function(s){let a={x:s.x+e*i.x,y:s.y+e*i.y};return s.z&&i.z&&(a.z=s.z+e*i.z),a});return[new r(o)]}return this.reduce().map(function(i){return i._linear?i.offset(e)[0]:i.scale(e)})}simple(){if(this.order===3){let o=R.angle(this.points[0],this.points[3],this.points[1]),s=R.angle(this.points[0],this.points[3],this.points[2]);if(o>0&&s<0||o<0&&s>0)return!1}let e=this.normal(0),n=this.normal(1),i=e.x*n.x+e.y*n.y;return this._3d&&(i+=e.z*n.z),aa(KT(i))<ZT/3}reduce(){let e,n=0,i=0,o=.01,s,a=[],u=[],l=this.extrema().values;for(l.indexOf(0)===-1&&(l=[0].concat(l)),l.indexOf(1)===-1&&l.push(1),n=l[0],e=1;e<l.length;e++)i=l[e],s=this.split(n,i),s._t1=n,s._t2=i,a.push(s),n=i;return a.forEach(function(c){for(n=0,i=0;i<=1;)for(i=n+o;i<=1+o;i+=o)if(s=c.split(n,i),!s.simple()){if(i-=o,aa(n-i)<o)return[];s=c.split(n,i),s._t1=R.map(n,0,1,c._t1,c._t2),s._t2=R.map(i,0,1,c._t1,c._t2),u.push(s),n=i;break}n<1&&(s=c.split(n,1),s._t1=R.map(n,0,1,c._t1,c._t2),s._t2=c._t2,u.push(s))}),u}translate(e,n,i){i=typeof i=="number"?i:n;let o=this.order,s=this.points.map((a,u)=>(1-u/o)*n+u/o*i);return new r(this.points.map((a,u)=>({x:a.x+e.x*s[u],y:a.y+e.y*s[u]})))}scale(e){let n=this.order,i=!1;if(typeof e=="function"&&(i=e),i&&n===2)return this.raise().scale(i);let o=this.clockwise,s=this.points;if(this._linear)return this.translate(this.normal(0),i?i(0):e,i?i(1):e);let a=i?i(0):e,u=i?i(1):e,l=[this.offset(0,10),this.offset(1,10)],c=[],f=R.lli4(l[0],l[0].c,l[1],l[1].c);if(!f)throw new Error("cannot scale this curve. Try reducing it first.");return[0,1].forEach(function(h){let d=c[h*n]=R.copy(s[h*n]);d.x+=(h?u:a)*l[h].n.x,d.y+=(h?u:a)*l[h].n.y}),i?([0,1].forEach(function(h){if(!(n===2&&h)){var d=s[h+1],m={x:d.x-f.x,y:d.y-f.y},y=i?i((h+1)/n):e;i&&!o&&(y=-y);var b=ua(m.x*m.x+m.y*m.y);m.x/=b,m.y/=b,c[h+1]={x:d.x+y*m.x,y:d.y+y*m.y}}}),new r(c)):([0,1].forEach(h=>{if(n===2&&h)return;let d=c[h*n],m=this.derivative(h),y={x:d.x+m.x,y:d.y+m.y};c[h+1]=R.lli4(d,y,f,s[h+1])}),new r(c))}outline(e,n,i,o){if(n=n===void 0?e:n,this._linear){let x=this.normal(0),C=this.points[0],O=this.points[this.points.length-1],T,M,D;i===void 0&&(i=e,o=n),T={x:C.x+x.x*e,y:C.y+x.y*e},D={x:O.x+x.x*i,y:O.y+x.y*i},M={x:(T.x+D.x)/2,y:(T.y+D.y)/2};let z=[T,M,D];T={x:C.x-x.x*n,y:C.y-x.y*n},D={x:O.x-x.x*o,y:O.y-x.y*o},M={x:(T.x+D.x)/2,y:(T.y+D.y)/2};let L=[D,M,T],Q=R.makeline(L[2],z[0]),P=R.makeline(z[2],L[0]),k=[Q,new r(z),P,new r(L)];return new ho(k)}let s=this.reduce(),a=s.length,u=[],l=[],c,f=0,h=this.length(),d=typeof i<"u"&&typeof o<"u";function m(x,C,O,T,M){return function(D){let z=T/O,L=(T+M)/O,Q=C-x;return R.map(D,0,1,x+z*Q,x+L*Q)}}s.forEach(function(x){let C=x.length();d?(u.push(x.scale(m(e,i,h,f,C))),l.push(x.scale(m(-n,-o,h,f,C)))):(u.push(x.scale(e)),l.push(x.scale(-n))),f+=C}),l=l.map(function(x){return c=x.points,c[3]?x.points=[c[3],c[2],c[1],c[0]]:x.points=[c[2],c[1],c[0]],x}).reverse();let y=u[0].points[0],b=u[a-1].points[u[a-1].points.length-1],v=l[a-1].points[l[a-1].points.length-1],g=l[0].points[0],A=R.makeline(v,y),E=R.makeline(b,g),w=[A].concat(u).concat([E]).concat(l);return new ho(w)}outlineshapes(e,n,i){n=n||e;let o=this.outline(e,n).curves,s=[];for(let a=1,u=o.length;a<u/2;a++){let l=R.makeshape(o[a],o[u-a],i);l.startcap.virtual=a>1,l.endcap.virtual=a<u/2-1,s.push(l)}return s}intersects(e,n){return e?e.p1&&e.p2?this.lineIntersects(e):(e instanceof r&&(e=e.reduce()),this.curveintersects(this.reduce(),e,n)):this.selfintersects(n)}lineIntersects(e){let n=i_(e.p1.x,e.p2.x),i=i_(e.p1.y,e.p2.y),o=o_(e.p1.x,e.p2.x),s=o_(e.p1.y,e.p2.y);return R.roots(this.points,e).filter(a=>{var u=this.get(a);return R.between(u.x,n,o)&&R.between(u.y,i,s)})}selfintersects(e){let n=this.reduce(),i=n.length-2,o=[];for(let s=0,a,u,l;s<i;s++)u=n.slice(s,s+1),l=n.slice(s+2),a=this.curveintersects(u,l,e),o.push(...a);return o}curveintersects(e,n,i){let o=[];e.forEach(function(a){n.forEach(function(u){a.overlaps(u)&&o.push({left:a,right:u})})});let s=[];return o.forEach(function(a){let u=R.pairiteration(a.left,a.right,i);u.length>0&&(s=s.concat(u))}),s}arcs(e){return e=e||.5,this._iterate(e,[])}_error(e,n,i,o){let s=(o-i)/4,a=this.get(i+s),u=this.get(o-s),l=R.dist(e,n),c=R.dist(e,a),f=R.dist(e,u);return aa(c-l)+aa(f-l)}_iterate(e,n){let i=0,o=1,s;do{s=0,o=1;let a=this.get(i),u,l,c,f,h=!1,d=!1,m,y=o,b=1,v=0;do if(d=h,f=c,y=(i+o)/2,v++,u=this.get(y),l=this.get(o),c=R.getccenter(a,u,l),c.interval={start:i,end:o},h=this._error(c,a,i,o)<=e,m=d&&!h,m||(b=o),h){if(o>=1){if(c.interval.end=b=1,f=c,o>1){let A={x:c.x+c.r*HT(c.e),y:c.y+c.r*WT(c.e)};c.e+=R.angle({x:c.x,y:c.y},A,this.get(1))}break}o=o+(o-i)/2}else o=y;while(!m&&s++<100);if(s>=100)break;f=f||c,n.push(f),i=b}while(o<1);return n}};function nd(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=Array(e);n<e;n++)i[n]=r[n];return i}function XT(r){if(Array.isArray(r))return r}function JT(r){if(Array.isArray(r))return nd(r)}function YT(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function QT(r,e){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var i,o,s,a,u=[],l=!0,c=!1;try{if(s=(n=n.call(r)).next,e!==0)for(;!(l=(i=s.call(n)).done)&&(u.push(i.value),u.length!==e);l=!0);}catch(f){c=!0,o=f}finally{try{if(!l&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}function eS(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tS(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rS(r,e){if(r==null)return{};var n,i,o=nS(r,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(r);for(i=0;i<s.length;i++)n=s[i],e.includes(n)||{}.propertyIsEnumerable.call(r,n)&&(o[n]=r[n])}return o}function nS(r,e){if(r==null)return{};var n={};for(var i in r)if({}.hasOwnProperty.call(r,i)){if(e.includes(i))continue;n[i]=r[i]}return n}function iS(r,e){return XT(r)||QT(r,e)||s_(r,e)||eS()}function oS(r){return JT(r)||YT(r)||s_(r)||tS()}function sS(r,e){if(typeof r!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}function aS(r){var e=sS(r,"string");return typeof e=="symbol"?e:e+""}function s_(r,e){if(r){if(typeof r=="string")return nd(r,e);var n={}.toString.call(r).slice(8,-1);return n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set"?Array.from(r):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?nd(r,e):void 0}}var a_=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=(e instanceof Array?e.length?e:[void 0]:[e]).map(function(u){return{keyAccessor:u,isProp:!(u instanceof Function)}}),s=r.reduce(function(u,l){var c=u,f=l;return o.forEach(function(h,d){var m=h.keyAccessor,y=h.isProp,b;if(y){var v=f,g=v[m],A=rS(v,[m].map(aS));b=g,f=A}else b=m(f,d);d+1<o.length?(c.hasOwnProperty(b)||(c[b]={}),c=c[b]):n?(c.hasOwnProperty(b)||(c[b]=[]),c[b].push(f)):c[b]=f}),u},{});n instanceof Function&&function u(l){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;c===o.length?Object.keys(l).forEach(function(f){return l[f]=n(l[f])}):Object.values(l).forEach(function(f){return u(f,c+1)})}(s);var a=s;return i&&(a=[],function u(l){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];c.length===o.length?a.push({keys:c,vals:l}):Object.entries(l).forEach(function(f){var h=iS(f,2),d=h[0],m=h[1];return u(m,[].concat(oS(c),[d]))})}(s),e instanceof Array&&e.length===0&&a.length===1&&(a[0].keys=[])),a};function u_(r,e){switch(arguments.length){case 0:break;case 1:this.range(r);break;default:this.range(e).domain(r);break}return this}var id=Symbol("implicit");function la(){var r=new uo,e=[],n=[],i=id;function o(s){let a=r.get(s);if(a===void 0){if(i!==id)return i;r.set(s,a=e.push(s)-1)}return n[a%n.length]}return o.domain=function(s){if(!arguments.length)return e.slice();e=[],r=new uo;for(let a of s)r.has(a)||r.set(a,e.push(a)-1);return o},o.range=function(s){return arguments.length?(n=Array.from(s),o):n.slice()},o.unknown=function(s){return arguments.length?(i=s,o):i},o.copy=function(){return la(e,n).unknown(i)},u_.apply(o,arguments),o}function l_(r){for(var e=r.length/6|0,n=new Array(e),i=0;i<e;)n[i]="#"+r.slice(i*6,++i*6);return n}var od=l_("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928");function uS(r,e){e===void 0&&(e={});var n=e.insertAt;if(!(!r||typeof document>"u")){var i=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css",n==="top"&&i.firstChild?i.insertBefore(o,i.firstChild):i.appendChild(o),o.styleSheet?o.styleSheet.cssText=r:o.appendChild(document.createTextNode(r))}}var lS=`.force-graph-container canvas {
  display: block;
  user-select: none;
  outline: none;
  -webkit-tap-highlight-color: transparent;
}

.force-graph-container .graph-tooltip {
  position: absolute;
  top: 0;
  font-family: sans-serif;
  font-size: 16px;
  padding: 4px;
  border-radius: 3px;
  color: #eee;
  background: rgba(0,0,0,0.65);
  visibility: hidden; /* by default */
}

.force-graph-container .clickable {
  cursor: pointer;
}

.force-graph-container .grabbable {
  cursor: move;
  cursor: grab;
  cursor: -moz-grab;
  cursor: -webkit-grab;
}

.force-graph-container .grabbable:active {
  cursor: grabbing;
  cursor: -moz-grabbing;
  cursor: -webkit-grabbing;
}
`;uS(lS);function c_(r,e,n){if(m_())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,e);var o=new(r.bind.apply(r,i));return n&&ud(o,n.prototype),o}function m_(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(m_=function(){return!!r})()}function cS(r,e){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var i,o,s,a,u=[],l=!0,c=!1;try{if(s=(n=n.call(r)).next,e===0){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=s.call(n)).done)&&(u.push(i.value),u.length!==e);l=!0);}catch(f){c=!0,o=f}finally{try{if(!l&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}function f_(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(r,o).enumerable})),n.push.apply(n,i)}return n}function po(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?f_(Object(n),!0).forEach(function(i){fa(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):f_(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function fS(r,e){if(typeof r!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function hS(r){var e=fS(r,"string");return typeof e=="symbol"?e:String(e)}function ad(r){"@babel/helpers - typeof";return ad=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ad(r)}function fa(r,e,n){return e=hS(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function ud(r,e){return ud=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,o){return i.__proto__=o,i},ud(r,e)}function ca(r,e){return pS(r)||cS(r,e)||g_(r,e)||yS()}function xt(r){return dS(r)||mS(r)||g_(r)||gS()}function dS(r){if(Array.isArray(r))return ld(r)}function pS(r){if(Array.isArray(r))return r}function mS(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function g_(r,e){if(r){if(typeof r=="string")return ld(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);if(n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set")return Array.from(r);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ld(r,e)}}function ld(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=r[n];return i}function gS(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yS(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var vS=la(od);function h_(r,e,n){!e||typeof n!="string"||r.filter(function(i){return!i[n]}).forEach(function(i){i[n]=vS(e(i))})}function bS(r,e){var n=r.nodes,i=r.links,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=o.nodeFilter,a=s===void 0?function(){return!0}:s,u=o.onLoopError,l=u===void 0?function(m){throw"Invalid DAG structure! Found cycle in node path: ".concat(m.join(" -> "),".")}:u,c={};n.forEach(function(m){return c[e(m)]={data:m,out:[],depth:-1,skip:!a(m)}}),i.forEach(function(m){var y=m.source,b=m.target,v=w(y),g=w(b);if(!c.hasOwnProperty(v))throw"Missing source node with id: ".concat(v);if(!c.hasOwnProperty(g))throw"Missing target node with id: ".concat(g);var A=c[v],E=c[g];A.out.push(E);function w(x){return ad(x)==="object"?e(x):x}});var f=[];d(Object.values(c));var h=Object.assign.apply(Object,[{}].concat(xt(Object.entries(c).filter(function(m){var y=ca(m,2),b=y[1];return!b.skip}).map(function(m){var y=ca(m,2),b=y[0],v=y[1];return fa({},b,v.depth)}))));return h;function d(m){for(var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,v=function(){var w=m[g];if(y.indexOf(w)!==-1){var x=[].concat(xt(y.slice(y.indexOf(w))),[w]).map(function(C){return e(C.data)});return f.some(function(C){return C.length===x.length&&C.every(function(O,T){return O===x[T]})})||(f.push(x),l(x)),1}b>w.depth&&(w.depth=b,d(w.out,[].concat(xt(y),[w]),b+(w.skip?0:1)))},g=0,A=m.length;g<A;g++)v()}}var _S=2,qe=function(e,n){return n.onNeedsRedraw&&n.onNeedsRedraw()},d_=function(e,n){if(!n.isShadow){var i=le(n.linkDirectionalParticles);n.graphData.links.forEach(function(o){var s=Math.round(Math.abs(i(o)));s?o.__photons=xt(Array(s)).map(function(){return{}}):delete o.__photons})}},Cl=Bh({props:{graphData:{default:{nodes:[],links:[]},onChange:function(e,n){n.engineRunning=!1,d_(e,n)}},dagMode:{onChange:function(e,n){!e&&(n.graphData.nodes||[]).forEach(function(i){return i.fx=i.fy=void 0})}},dagLevelDistance:{},dagNodeFilter:{default:function(e){return!0}},onDagError:{triggerUpdate:!1},nodeRelSize:{default:4,triggerUpdate:!1,onChange:qe},nodeId:{default:"id"},nodeVal:{default:"val",triggerUpdate:!1,onChange:qe},nodeColor:{default:"color",triggerUpdate:!1,onChange:qe},nodeAutoColorBy:{},nodeCanvasObject:{triggerUpdate:!1,onChange:qe},nodeCanvasObjectMode:{default:function(){return"replace"},triggerUpdate:!1,onChange:qe},nodeVisibility:{default:!0,triggerUpdate:!1,onChange:qe},linkSource:{default:"source"},linkTarget:{default:"target"},linkVisibility:{default:!0,triggerUpdate:!1,onChange:qe},linkColor:{default:"color",triggerUpdate:!1,onChange:qe},linkAutoColorBy:{},linkLineDash:{triggerUpdate:!1,onChange:qe},linkWidth:{default:1,triggerUpdate:!1,onChange:qe},linkCurvature:{default:0,triggerUpdate:!1,onChange:qe},linkCanvasObject:{triggerUpdate:!1,onChange:qe},linkCanvasObjectMode:{default:function(){return"replace"},triggerUpdate:!1,onChange:qe},linkDirectionalArrowLength:{default:0,triggerUpdate:!1,onChange:qe},linkDirectionalArrowColor:{triggerUpdate:!1,onChange:qe},linkDirectionalArrowRelPos:{default:.5,triggerUpdate:!1,onChange:qe},linkDirectionalParticles:{default:0,triggerUpdate:!1,onChange:d_},linkDirectionalParticleSpeed:{default:.01,triggerUpdate:!1},linkDirectionalParticleWidth:{default:4,triggerUpdate:!1},linkDirectionalParticleColor:{triggerUpdate:!1},globalScale:{default:1,triggerUpdate:!1},d3AlphaMin:{default:0,triggerUpdate:!1},d3AlphaDecay:{default:.0228,triggerUpdate:!1,onChange:function(e,n){n.forceLayout.alphaDecay(e)}},d3AlphaTarget:{default:0,triggerUpdate:!1,onChange:function(e,n){n.forceLayout.alphaTarget(e)}},d3VelocityDecay:{default:.4,triggerUpdate:!1,onChange:function(e,n){n.forceLayout.velocityDecay(e)}},warmupTicks:{default:0,triggerUpdate:!1},cooldownTicks:{default:1/0,triggerUpdate:!1},cooldownTime:{default:15e3,triggerUpdate:!1},onUpdate:{default:function(){},triggerUpdate:!1},onFinishUpdate:{default:function(){},triggerUpdate:!1},onEngineTick:{default:function(){},triggerUpdate:!1},onEngineStop:{default:function(){},triggerUpdate:!1},onNeedsRedraw:{triggerUpdate:!1},isShadow:{default:!1,triggerUpdate:!1}},methods:{d3Force:function(e,n,i){return i===void 0?e.forceLayout.force(n):(e.forceLayout.force(n,i),this)},d3ReheatSimulation:function(e){return e.forceLayout.alpha(1),this.resetCountdown(),this},resetCountdown:function(e){return e.cntTicks=0,e.startTickTime=new Date,e.engineRunning=!0,this},isEngineRunning:function(e){return!!e.engineRunning},tickFrame:function(e){return!e.isShadow&&n(),o(),!e.isShadow&&s(),!e.isShadow&&a(),i(),this;function n(){e.engineRunning&&(++e.cntTicks>e.cooldownTicks||new Date-e.startTickTime>e.cooldownTime||e.d3AlphaMin>0&&e.forceLayout.alpha()<e.d3AlphaMin?(e.engineRunning=!1,e.onEngineStop()):(e.forceLayout.tick(),e.onEngineTick()))}function i(){var u=le(e.nodeVisibility),l=le(e.nodeVal),c=le(e.nodeColor),f=le(e.nodeCanvasObjectMode),h=e.ctx,d=e.isShadow/e.globalScale,m=e.graphData.nodes.filter(u);h.save(),m.forEach(function(y){var b=f(y);if(e.nodeCanvasObject&&(b==="before"||b==="replace")&&(e.nodeCanvasObject(y,h,e.globalScale),b==="replace")){h.restore();return}var v=Math.sqrt(Math.max(0,l(y)||1))*e.nodeRelSize+d;h.beginPath(),h.arc(y.x,y.y,v,0,2*Math.PI,!1),h.fillStyle=c(y)||"rgba(31, 120, 180, 0.92)",h.fill(),e.nodeCanvasObject&&b==="after"&&e.nodeCanvasObject(y,e.ctx,e.globalScale)}),h.restore()}function o(){var u=le(e.linkVisibility),l=le(e.linkColor),c=le(e.linkWidth),f=le(e.linkLineDash),h=le(e.linkCurvature),d=le(e.linkCanvasObjectMode),m=e.ctx,y=e.isShadow*2,b=e.graphData.links.filter(u);b.forEach(C);var v=[],g=[],A=b;if(e.linkCanvasObject){var E=[],w=[];b.forEach(function(O){return({before:v,after:g,replace:E}[d(O)]||w).push(O)}),A=[].concat(xt(v),g,w),v=v.concat(E)}m.save(),v.forEach(function(O){return e.linkCanvasObject(O,m,e.globalScale)}),m.restore();var x=a_(A,[l,c,f]);m.save(),Object.entries(x).forEach(function(O){var T=ca(O,2),M=T[0],D=T[1],z=!M||M==="undefined"?"rgba(0,0,0,0.15)":M;Object.entries(D).forEach(function(L){var Q=ca(L,2),P=Q[0],k=Q[1],S=(P||1)/e.globalScale+y;Object.entries(k).forEach(function(N){var U=ca(N,2);U[0];var Z=U[1],X=f(Z[0]);m.beginPath(),Z.forEach(function(ie){var ce=ie.source,De=ie.target;if(!(!ce||!De||!ce.hasOwnProperty("x")||!De.hasOwnProperty("x"))){m.moveTo(ce.x,ce.y);var xe=ie.__controlPoints;xe?m[xe.length===2?"quadraticCurveTo":"bezierCurveTo"].apply(m,xt(xe).concat([De.x,De.y])):m.lineTo(De.x,De.y)}}),m.strokeStyle=z,m.lineWidth=S,m.setLineDash(X||[]),m.stroke()})})}),m.restore(),m.save(),g.forEach(function(O){return e.linkCanvasObject(O,m,e.globalScale)}),m.restore();function C(O){var T=h(O);if(!T){O.__controlPoints=null;return}var M=O.source,D=O.target;if(!(!M||!D||!M.hasOwnProperty("x")||!D.hasOwnProperty("x"))){var z=Math.sqrt(Math.pow(D.x-M.x,2)+Math.pow(D.y-M.y,2));if(z>0){var L=Math.atan2(D.y-M.y,D.x-M.x),Q=z*T,P={x:(M.x+D.x)/2+Q*Math.cos(L-Math.PI/2),y:(M.y+D.y)/2+Q*Math.sin(L-Math.PI/2)};O.__controlPoints=[P.x,P.y]}else{var k=T*70;O.__controlPoints=[D.x,D.y-k,D.x+k,D.y]}}}}function s(){var u=1.6,l=.2,c=le(e.linkDirectionalArrowLength),f=le(e.linkDirectionalArrowRelPos),h=le(e.linkVisibility),d=le(e.linkDirectionalArrowColor||e.linkColor),m=le(e.nodeVal),y=e.ctx;y.save(),e.graphData.links.filter(h).forEach(function(b){var v=c(b);if(!(!v||v<0)){var g=b.source,A=b.target;if(!(!g||!A||!g.hasOwnProperty("x")||!A.hasOwnProperty("x"))){var E=Math.sqrt(Math.max(0,m(g)||1))*e.nodeRelSize,w=Math.sqrt(Math.max(0,m(A)||1))*e.nodeRelSize,x=Math.min(1,Math.max(0,f(b))),C=d(b)||"rgba(0,0,0,0.28)",O=v/u/2,T=b.__controlPoints&&c_(ci,[g.x,g.y].concat(xt(b.__controlPoints),[A.x,A.y])),M=T?function(S){return T.get(S)}:function(S){return{x:g.x+(A.x-g.x)*S||0,y:g.y+(A.y-g.y)*S||0}},D=T?T.length():Math.sqrt(Math.pow(A.x-g.x,2)+Math.pow(A.y-g.y,2)),z=E+v+(D-E-w-v)*x,L=M(z/D),Q=M((z-v)/D),P=M((z-v*(1-l))/D),k=Math.atan2(L.y-Q.y,L.x-Q.x)-Math.PI/2;y.beginPath(),y.moveTo(L.x,L.y),y.lineTo(Q.x+O*Math.cos(k),Q.y+O*Math.sin(k)),y.lineTo(P.x,P.y),y.lineTo(Q.x-O*Math.cos(k),Q.y-O*Math.sin(k)),y.fillStyle=C,y.fill()}}}),y.restore()}function a(){var u=le(e.linkDirectionalParticles),l=le(e.linkDirectionalParticleSpeed),c=le(e.linkDirectionalParticleWidth),f=le(e.linkVisibility),h=le(e.linkDirectionalParticleColor||e.linkColor),d=e.ctx;d.save(),e.graphData.links.filter(f).forEach(function(m){var y=u(m);if(!(!m.hasOwnProperty("__photons")||!m.__photons.length)){var b=m.source,v=m.target;if(!(!b||!v||!b.hasOwnProperty("x")||!v.hasOwnProperty("x"))){var g=l(m),A=m.__photons||[],E=Math.max(0,c(m)/2)/Math.sqrt(e.globalScale),w=h(m)||"rgba(0,0,0,0.28)";d.fillStyle=w;var x=m.__controlPoints?c_(ci,[b.x,b.y].concat(xt(m.__controlPoints),[v.x,v.y])):null,C=0,O=!1;A.forEach(function(T){var M=!!T.__singleHop;if(T.hasOwnProperty("__progressRatio")||(T.__progressRatio=M?0:C/y),!M&&C++,T.__progressRatio+=g,T.__progressRatio>=1)if(!M)T.__progressRatio=T.__progressRatio%1;else{O=!0;return}var D=T.__progressRatio,z=x?x.get(D):{x:b.x+(v.x-b.x)*D||0,y:b.y+(v.y-b.y)*D||0};d.beginPath(),d.arc(z.x,z.y,E,0,2*Math.PI,!1),d.fill()}),O&&(m.__photons=m.__photons.filter(function(T){return!T.__singleHop||T.__progressRatio<=1}))}}}),d.restore()}},emitParticle:function(e,n){return n&&(!n.__photons&&(n.__photons=[]),n.__photons.push({__singleHop:!0})),this}},stateInit:function(){return{forceLayout:Yh().force("link",Xh()).force("charge",Qh()).force("center",Hh()).force("dagRadial",null).stop(),engineRunning:!1}},init:function(e,n){n.ctx=e},update:function(e){e.engineRunning=!1,e.onUpdate(),e.nodeAutoColorBy!==null&&h_(e.graphData.nodes,le(e.nodeAutoColorBy),e.nodeColor),e.linkAutoColorBy!==null&&h_(e.graphData.links,le(e.linkAutoColorBy),e.linkColor),e.graphData.links.forEach(function(f){f.source=f[e.linkSource],f.target=f[e.linkTarget]}),e.forceLayout.stop().alpha(1).nodes(e.graphData.nodes);var n=e.forceLayout.force("link");n&&n.id(function(f){return f[e.nodeId]}).links(e.graphData.links);var i=e.dagMode&&bS(e.graphData,function(f){return f[e.nodeId]},{nodeFilter:e.dagNodeFilter,onLoopError:e.onDagError||void 0}),o=Math.max.apply(Math,xt(Object.values(i||[]))),s=e.dagLevelDistance||e.graphData.nodes.length/(o||1)*_S*(["radialin","radialout"].indexOf(e.dagMode)!==-1?.7:1);if(e.dagMode){var a=function(h,d){return function(m){return h?(i[m[e.nodeId]]-o/2)*s*(d?-1:1):void 0}},u=a(["lr","rl"].indexOf(e.dagMode)!==-1,e.dagMode==="rl"),l=a(["td","bu"].indexOf(e.dagMode)!==-1,e.dagMode==="bu");e.graphData.nodes.filter(e.dagNodeFilter).forEach(function(f){f.fx=u(f),f.fy=l(f)})}e.forceLayout.force("dagRadial",["radialin","radialout"].indexOf(e.dagMode)!==-1?ed(function(f){var h=i[f[e.nodeId]]||-1;return(e.dagMode==="radialin"?o-h:h)*s}).strength(function(f){return e.dagNodeFilter(f)?1:0}):null);for(var c=0;c<e.warmupTicks&&!(e.d3AlphaMin>0&&e.forceLayout.alpha()<e.d3AlphaMin);c++)e.forceLayout.tick();this.resetCountdown(),e.onFinishUpdate()}});function y_(r,e){var n=r instanceof Array?r:[r],i=new e;return i._destructor&&i._destructor(),{linkProp:function(s){return{default:i[s](),onChange:function(u,l){n.forEach(function(c){return l[c][s](u)})},triggerUpdate:!1}},linkMethod:function(s){return function(a){for(var u=arguments.length,l=new Array(u>1?u-1:0),c=1;c<u;c++)l[c-1]=arguments[c];var f=[];return n.forEach(function(h){var d=a[h],m=d[s].apply(d,l);m!==d&&f.push(m)}),f.length?f[0]:this}}}}var wS=800,xS=4,v_=y_("forceGraph",Cl),AS=y_(["forceGraph","shadowGraph"],Cl),CS=Object.assign.apply(Object,xt(["nodeColor","nodeAutoColorBy","nodeCanvasObject","nodeCanvasObjectMode","linkColor","linkAutoColorBy","linkLineDash","linkWidth","linkCanvasObject","linkCanvasObjectMode","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowRelPos","linkDirectionalParticles","linkDirectionalParticleSpeed","linkDirectionalParticleWidth","linkDirectionalParticleColor","dagMode","dagLevelDistance","dagNodeFilter","onDagError","d3AlphaMin","d3AlphaDecay","d3VelocityDecay","warmupTicks","cooldownTicks","cooldownTime","onEngineTick","onEngineStop"].map(function(r){return fa({},r,v_.linkProp(r))})).concat(xt(["nodeRelSize","nodeId","nodeVal","nodeVisibility","linkSource","linkTarget","linkVisibility","linkCurvature"].map(function(r){return fa({},r,AS.linkProp(r))})))),IS=Object.assign.apply(Object,xt(["d3Force","d3ReheatSimulation","emitParticle"].map(function(r){return fa({},r,v_.linkMethod(r))})));function sd(r){if(r.canvas){var e=r.canvas.width,n=r.canvas.height;e===300&&n===150&&(e=n=0);var i=window.devicePixelRatio;e/=i,n/=i,[r.canvas,r.shadowCanvas].forEach(function(s){s.style.width="".concat(r.width,"px"),s.style.height="".concat(r.height,"px"),s.width=r.width*i,s.height=r.height*i,!e&&!n&&s.getContext("2d").scale(i,i)});var o=lt(r.canvas).k;r.zoom.translateBy(r.zoom.__baseElem,(r.width-e)/2/o,(r.height-n)/2/o),r.needsRedraw=!0}}function b_(r){var e=window.devicePixelRatio;r.setTransform(e,0,0,e,0,0)}function p_(r,e,n){r.save(),b_(r),r.clearRect(0,0,e,n),r.restore()}var __=Bh({props:po({width:{default:window.innerWidth,onChange:function(e,n){return sd(n)},triggerUpdate:!1},height:{default:window.innerHeight,onChange:function(e,n){return sd(n)},triggerUpdate:!1},graphData:{default:{nodes:[],links:[]},onChange:function(e,n){[{type:"Node",objs:e.nodes},{type:"Link",objs:e.links}].forEach(i),n.forceGraph.graphData(e),n.shadowGraph.graphData(e);function i(o){var s=o.type,a=o.objs;a.filter(function(u){if(!u.hasOwnProperty("__indexColor"))return!0;var l=n.colorTracker.lookup(u.__indexColor);return!l||!l.hasOwnProperty("d")||l.d!==u}).forEach(function(u){u.__indexColor=n.colorTracker.register({type:s,d:u})})}},triggerUpdate:!1},backgroundColor:{onChange:function(e,n){n.canvas&&e&&(n.canvas.style.background=e)},triggerUpdate:!1},nodeLabel:{default:"name",triggerUpdate:!1},nodePointerAreaPaint:{onChange:function(e,n){n.shadowGraph.nodeCanvasObject(e?function(i,o,s){return e(i,i.__indexColor,o,s)}:null),n.flushShadowCanvas&&n.flushShadowCanvas()},triggerUpdate:!1},linkPointerAreaPaint:{onChange:function(e,n){n.shadowGraph.linkCanvasObject(e?function(i,o,s){return e(i,i.__indexColor,o,s)}:null),n.flushShadowCanvas&&n.flushShadowCanvas()},triggerUpdate:!1},linkLabel:{default:"name",triggerUpdate:!1},linkHoverPrecision:{default:4,triggerUpdate:!1},minZoom:{default:.01,onChange:function(e,n){n.zoom.scaleExtent([e,n.zoom.scaleExtent()[1]])},triggerUpdate:!1},maxZoom:{default:1e3,onChange:function(e,n){n.zoom.scaleExtent([n.zoom.scaleExtent()[0],e])},triggerUpdate:!1},enableNodeDrag:{default:!0,triggerUpdate:!1},enableZoomInteraction:{default:!0,triggerUpdate:!1},enablePanInteraction:{default:!0,triggerUpdate:!1},enableZoomPanInteraction:{default:!0,triggerUpdate:!1},enablePointerInteraction:{default:!0,onChange:function(e,n){n.hoverObj=null},triggerUpdate:!1},autoPauseRedraw:{default:!0,triggerUpdate:!1},onNodeDrag:{default:function(){},triggerUpdate:!1},onNodeDragEnd:{default:function(){},triggerUpdate:!1},onNodeClick:{triggerUpdate:!1},onNodeRightClick:{triggerUpdate:!1},onNodeHover:{triggerUpdate:!1},onLinkClick:{triggerUpdate:!1},onLinkRightClick:{triggerUpdate:!1},onLinkHover:{triggerUpdate:!1},onBackgroundClick:{triggerUpdate:!1},onBackgroundRightClick:{triggerUpdate:!1},onZoom:{triggerUpdate:!1},onZoomEnd:{triggerUpdate:!1},onRenderFramePre:{triggerUpdate:!1},onRenderFramePost:{triggerUpdate:!1}},CS),aliases:{stopAnimation:"pauseAnimation"},methods:po({graph2ScreenCoords:function(e,n,i){var o=lt(e.canvas);return{x:n*o.k+o.x,y:i*o.k+o.y}},screen2GraphCoords:function(e,n,i){var o=lt(e.canvas);return{x:(n-o.x)/o.k,y:(i-o.y)/o.k}},centerAt:function(e,n,i,o){if(!e.canvas)return null;if(n!==void 0||i!==void 0){var s=Object.assign({},n!==void 0?{x:n}:{},i!==void 0?{y:i}:{});return o?new Vh(a()).to(s,o).easing(en.Quadratic.Out).onUpdate(u).start():u(s),this}return a();function a(){var l=lt(e.canvas);return{x:(e.width/2-l.x)/l.k,y:(e.height/2-l.y)/l.k}}function u(l){var c=l.x,f=l.y;e.zoom.translateTo(e.zoom.__baseElem,c===void 0?a().x:c,f===void 0?a().y:f),e.needsRedraw=!0}},zoom:function(e,n,i){if(!e.canvas)return null;if(n!==void 0)return i?new Vh({k:o()}).to({k:n},i).easing(en.Quadratic.Out).onUpdate(function(a){var u=a.k;return s(u)}).start():s(n),this;return o();function o(){return lt(e.canvas).k}function s(a){e.zoom.scaleTo(e.zoom.__baseElem,a),e.needsRedraw=!0}},zoomToFit:function(e){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,o=arguments.length,s=new Array(o>3?o-3:0),a=3;a<o;a++)s[a-3]=arguments[a];var u=this.getGraphBbox.apply(this,s);if(u){var l={x:(u.x[0]+u.x[1])/2,y:(u.y[0]+u.y[1])/2},c=Math.max(1e-12,Math.min(1e12,(e.width-i*2)/(u.x[1]-u.x[0]),(e.height-i*2)/(u.y[1]-u.y[0])));this.centerAt(l.x,l.y,n),this.zoom(c,n)}return this},getGraphBbox:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return!0},i=le(e.nodeVal),o=function(u){return Math.sqrt(Math.max(0,i(u)||1))*e.nodeRelSize},s=e.graphData.nodes.filter(n).map(function(a){return{x:a.x,y:a.y,r:o(a)}});return s.length?{x:[Js(s,function(a){return a.x-a.r}),Xs(s,function(a){return a.x+a.r})],y:[Js(s,function(a){return a.y-a.r}),Xs(s,function(a){return a.y+a.r})]}:null},pauseAnimation:function(e){return e.animationFrameRequestId&&(cancelAnimationFrame(e.animationFrameRequestId),e.animationFrameRequestId=null),this},resumeAnimation:function(e){return e.animationFrameRequestId||this._animationCycle(),this},_destructor:function(){this.pauseAnimation(),this.graphData({nodes:[],links:[]})}},IS),stateInit:function(){return{lastSetZoom:1,zoom:zh(),forceGraph:new Cl,shadowGraph:new Cl().cooldownTicks(0).nodeColor("__indexColor").linkColor("__indexColor").isShadow(!0),colorTracker:new Y0}},init:function(e,n){var i=this;e.innerHTML="";var o=document.createElement("div");o.classList.add("force-graph-container"),o.style.position="relative",e.appendChild(o),n.canvas=document.createElement("canvas"),n.backgroundColor&&(n.canvas.style.background=n.backgroundColor),o.appendChild(n.canvas),n.shadowCanvas=document.createElement("canvas");var s=n.canvas.getContext("2d"),a=n.shadowCanvas.getContext("2d",{willReadFrequently:!0}),u={x:-1e12,y:-1e12},l=function(){var d=null,m=window.devicePixelRatio,y=u.x>0&&u.y>0?a.getImageData(u.x*m,u.y*m,1,1):null;return y&&(d=n.colorTracker.lookup(y.data)),d};Ve(n.canvas).call(Ch().subject(function(){if(!n.enableNodeDrag)return null;var h=l();return h&&h.type==="Node"?h.d:null}).on("start",function(h){var d=h.subject;d.__initialDragPos={x:d.x,y:d.y,fx:d.fx,fy:d.fy},h.active||(d.fx=d.x,d.fy=d.y),n.canvas.classList.add("grabbable")}).on("drag",function(h){var d=h.subject,m=d.__initialDragPos,y=h,b=lt(n.canvas).k,v={x:m.x+(y.x-m.x)/b-d.x,y:m.y+(y.y-m.y)/b-d.y};["x","y"].forEach(function(g){return d["f".concat(g)]=d[g]=m[g]+(y[g]-m[g])/b}),n.forceGraph.d3AlphaTarget(.3).resetCountdown(),n.isPointerDragging=!0,d.__dragged=!0,n.onNodeDrag(d,v)}).on("end",function(h){var d=h.subject,m=d.__initialDragPos,y={x:d.x-m.x,y:d.y-m.y};m.fx===void 0&&(d.fx=void 0),m.fy===void 0&&(d.fy=void 0),delete d.__initialDragPos,n.forceGraph.d3AlphaTarget()&&n.forceGraph.d3AlphaTarget(0).resetCountdown(),n.canvas.classList.remove("grabbable"),n.isPointerDragging=!1,d.__dragged&&(delete d.__dragged,n.onNodeDragEnd(d,y))})),n.zoom(n.zoom.__baseElem=Ve(n.canvas)),n.zoom.__baseElem.on("dblclick.zoom",null),n.zoom.filter(function(h){return!h.button&&n.enableZoomPanInteraction&&(n.enableZoomInteraction||h.type!=="wheel")&&(n.enablePanInteraction||h.type==="wheel")}).on("zoom",function(h){var d=h.transform;[s,a].forEach(function(m){b_(m),m.translate(d.x,d.y),m.scale(d.k,d.k)}),n.onZoom&&n.onZoom(po(po({},d),i.centerAt())),n.needsRedraw=!0}).on("end",function(h){return n.onZoomEnd&&n.onZoomEnd(po(po({},h.transform),i.centerAt()))}),sd(n),n.forceGraph.onNeedsRedraw(function(){return n.needsRedraw=!0}).onFinishUpdate(function(){lt(n.canvas).k===n.lastSetZoom&&n.graphData.nodes.length&&(n.zoom.scaleTo(n.zoom.__baseElem,n.lastSetZoom=xS/Math.cbrt(n.graphData.nodes.length)),n.needsRedraw=!0)});var c=document.createElement("div");c.classList.add("graph-tooltip"),o.appendChild(c),["pointermove","pointerdown"].forEach(function(h){return o.addEventListener(h,function(d){h==="pointerdown"&&(n.isPointerPressed=!0,n.pointerDownEvent=d),!n.isPointerDragging&&d.type==="pointermove"&&n.onBackgroundClick&&(d.pressure>0||n.isPointerPressed)&&(d.pointerType!=="touch"||d.movementX===void 0||[d.movementX,d.movementY].some(function(b){return Math.abs(b)>1}))&&(n.isPointerDragging=!0);var m=y(o);u.x=d.pageX-m.left,u.y=d.pageY-m.top,c.style.top="".concat(u.y,"px"),c.style.left="".concat(u.x,"px"),c.style.transform="translate(-".concat(u.x/n.width*100,"%, ").concat(n.height-u.y<100?"calc(-100% - 8px)":"21px",")");function y(b){var v=b.getBoundingClientRect(),g=window.pageXOffset||document.documentElement.scrollLeft,A=window.pageYOffset||document.documentElement.scrollTop;return{top:v.top+A,left:v.left+g}}},{passive:!0})}),o.addEventListener("pointerup",function(h){if(n.isPointerPressed=!1,n.isPointerDragging){n.isPointerDragging=!1;return}var d=[h,n.pointerDownEvent];requestAnimationFrame(function(){if(h.button===0)if(n.hoverObj){var m=n["on".concat(n.hoverObj.type,"Click")];m&&m.apply(void 0,[n.hoverObj.d].concat(d))}else n.onBackgroundClick&&n.onBackgroundClick.apply(n,d);if(h.button===2)if(n.hoverObj){var y=n["on".concat(n.hoverObj.type,"RightClick")];y&&y.apply(void 0,[n.hoverObj.d].concat(d))}else n.onBackgroundRightClick&&n.onBackgroundRightClick.apply(n,d)})},{passive:!0}),o.addEventListener("contextmenu",function(h){return!n.onBackgroundRightClick&&!n.onNodeRightClick&&!n.onLinkRightClick?!0:(h.preventDefault(),!1)}),n.forceGraph(s),n.shadowGraph(a);var f=Lh(function(){p_(a,n.width,n.height),n.shadowGraph.linkWidth(function(d){return le(n.linkWidth)(d)+n.linkHoverPrecision});var h=lt(n.canvas);n.shadowGraph.globalScale(h.k).tickFrame()},wS);n.flushShadowCanvas=f.flush,(this._animationCycle=function h(){var d=!n.autoPauseRedraw||!!n.needsRedraw||n.forceGraph.isEngineRunning()||n.graphData.links.some(function(x){return x.__photons&&x.__photons.length});if(n.needsRedraw=!1,n.enablePointerInteraction){var m=n.isPointerDragging?null:l();if(m!==n.hoverObj){var y=n.hoverObj,b=y?y.type:null,v=m?m.type:null;if(b&&b!==v){var g=n["on".concat(b,"Hover")];g&&g(null,y.d)}if(v){var A=n["on".concat(v,"Hover")];A&&A(m.d,b===v?y.d:null)}var E=m&&le(n["".concat(m.type.toLowerCase(),"Label")])(m.d)||"";c.style.visibility=E?"visible":"hidden",c.innerHTML=E,n.canvas.classList[m&&n["on".concat(v,"Click")]||!m&&n.onBackgroundClick?"add":"remove"]("clickable"),n.hoverObj=m}d&&f()}if(d){p_(s,n.width,n.height);var w=lt(n.canvas).k;n.onRenderFramePre&&n.onRenderFramePre(s,w),n.forceGraph.globalScale(w).tickFrame(),n.onRenderFramePost&&n.onRenderFramePost(s,w)}$0(),n.animationFrameRequestId=requestAnimationFrame(h)})()},update:function(e){}});var P_=(()=>{let e=class e{constructor(i,o){this._renderer=i,this._elementRef=o,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(i,o){this._renderer.setProperty(this._elementRef.nativeElement,i,o)}registerOnTouched(i){this.onTouched=i}registerOnChange(i){this.onChange=i}setDisabledState(i){this.setProperty("disabled",i)}};e.\u0275fac=function(o){return new(o||e)(Ae(_a),Ae(xo))},e.\u0275dir=Qt({type:e});let r=e;return r})(),ES=(()=>{let e=class e extends P_{};e.\u0275fac=(()=>{let i;return function(s){return(i||(i=wo(e)))(s||e)}})(),e.\u0275dir=Qt({type:e,features:[Co]});let r=e;return r})(),T_=new ae("");var OS={provide:T_,useExisting:Ul(()=>Tl),multi:!0};function PS(){let r=yi()?yi().getUserAgent():"";return/android (\d+)/.test(r.toLowerCase())}var TS=new ae(""),Tl=(()=>{let e=class e extends P_{constructor(i,o,s){super(i,o),this._compositionMode=s,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!PS())}writeValue(i){let o=i??"";this.setProperty("value",o)}_handleInput(i){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(i)}_compositionStart(){this._composing=!0}_compositionEnd(i){this._composing=!1,this._compositionMode&&this.onChange(i)}};e.\u0275fac=function(o){return new(o||e)(Ae(_a),Ae(xo),Ae(TS,8))},e.\u0275dir=Qt({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(o,s){o&1&&He("input",function(u){return s._handleInput(u.target.value)})("blur",function(){return s.onTouched()})("compositionstart",function(){return s._compositionStart()})("compositionend",function(u){return s._compositionEnd(u.target.value)})},features:[Yl([OS]),Co]});let r=e;return r})();var SS=new ae(""),RS=new ae("");function S_(r){return r!=null}function R_(r){return Ca(r)?Ge(r):r}function M_(r){let e={};return r.forEach(n=>{e=n!=null?p(p({},e),n):e}),Object.keys(e).length===0?null:e}function k_(r,e){return e.map(n=>n(r))}function MS(r){return!r.validate}function D_(r){return r.map(e=>MS(e)?e:n=>e.validate(n))}function kS(r){if(!r)return null;let e=r.filter(S_);return e.length==0?null:function(n){return M_(k_(n,e))}}function N_(r){return r!=null?kS(D_(r)):null}function DS(r){if(!r)return null;let e=r.filter(S_);return e.length==0?null:function(n){let i=k_(n,e).map(R_);return xd(i).pipe(ne(M_))}}function j_(r){return r!=null?DS(D_(r)):null}function w_(r,e){return r===null?[e]:Array.isArray(r)?[...r,e]:[r,e]}function NS(r){return r._rawValidators}function jS(r){return r._rawAsyncValidators}function cd(r){return r?Array.isArray(r)?r:[r]:[]}function El(r,e){return Array.isArray(r)?r.includes(e):r===e}function x_(r,e){let n=cd(e);return cd(r).forEach(o=>{El(n,o)||n.push(o)}),n}function A_(r,e){return cd(e).filter(n=>!El(r,n))}var Ol=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=N_(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=j_(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,n){return this.control?this.control.hasError(e,n):!1}getError(e,n){return this.control?this.control.getError(e,n):null}},fd=class extends Ol{get formDirective(){return null}get path(){return null}},ga=class extends Ol{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},hd=class{constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},FS={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},ZH=_(p({},FS),{"[class.ng-submitted]":"isSubmitted"}),F_=(()=>{let e=class e extends hd{constructor(i){super(i)}};e.\u0275fac=function(o){return new(o||e)(Ae(ga,2))},e.\u0275dir=Qt({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(o,s){o&2&&Gd("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)},features:[Co]});let r=e;return r})();var ha="VALID",Il="INVALID",mo="PENDING",da="DISABLED",yo=class{},Pl=class extends yo{constructor(e,n){super(),this.value=e,this.source=n}},pa=class extends yo{constructor(e,n){super(),this.pristine=e,this.source=n}},ma=class extends yo{constructor(e,n){super(),this.touched=e,this.source=n}},go=class extends yo{constructor(e,n){super(),this.status=e,this.source=n}};function zS(r){return(Sl(r)?r.validators:r)||null}function $S(r){return Array.isArray(r)?N_(r):r||null}function LS(r,e){return(Sl(e)?e.asyncValidators:r)||null}function US(r){return Array.isArray(r)?j_(r):r||null}function Sl(r){return r!=null&&!Array.isArray(r)&&typeof r=="object"}var dd=class{constructor(e,n){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=null,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this._status=Ia(()=>this.statusReactive()),this.statusReactive=nr(void 0),this._pristine=Ia(()=>this.pristineReactive()),this.pristineReactive=nr(!0),this._touched=Ia(()=>this.touchedReactive()),this.touchedReactive=nr(!1),this._events=new Ne,this.events=this._events.asObservable(),this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(n)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return hn(this.statusReactive)}set status(e){hn(()=>this.statusReactive.set(e))}get valid(){return this.status===ha}get invalid(){return this.status===Il}get pending(){return this.status==mo}get disabled(){return this.status===da}get enabled(){return this.status!==da}get pristine(){return hn(this.pristineReactive)}set pristine(e){hn(()=>this.pristineReactive.set(e))}get dirty(){return!this.pristine}get touched(){return hn(this.touchedReactive)}set touched(e){hn(()=>this.touchedReactive.set(e))}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(x_(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(x_(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(A_(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(A_(e,this._rawAsyncValidators))}hasValidator(e){return El(this._rawValidators,e)}hasAsyncValidator(e){return El(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let n=this.touched===!1;this.touched=!0;let i=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(_(p({},e),{sourceControl:i})),n&&e.emitEvent!==!1&&this._events.next(new ma(!0,i))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(n=>n.markAllAsTouched(e))}markAsUntouched(e={}){let n=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let i=e.sourceControl??this;this._forEachChild(o=>{o.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:i})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,i),n&&e.emitEvent!==!1&&this._events.next(new ma(!1,i))}markAsDirty(e={}){let n=this.pristine===!0;this.pristine=!1;let i=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(_(p({},e),{sourceControl:i})),n&&e.emitEvent!==!1&&this._events.next(new pa(!1,i))}markAsPristine(e={}){let n=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let i=e.sourceControl??this;this._forEachChild(o=>{o.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,i),n&&e.emitEvent!==!1&&this._events.next(new pa(!0,i))}markAsPending(e={}){this.status=mo;let n=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new go(this.status,n)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(_(p({},e),{sourceControl:n}))}disable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=da,this.errors=null,this._forEachChild(o=>{o.disable(_(p({},e),{onlySelf:!0}))}),this._updateValue();let i=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Pl(this.value,i)),this._events.next(new go(this.status,i)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(_(p({},e),{skipPristineCheck:n}),this),this._onDisabledChange.forEach(o=>o(!0))}enable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=ha,this._forEachChild(i=>{i.enable(_(p({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(_(p({},e),{skipPristineCheck:n}),this),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(e,n){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},n),this._parent._updateTouched({},n))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let i=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===ha||this.status===mo)&&this._runAsyncValidator(i,e.emitEvent)}let n=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Pl(this.value,n)),this._events.next(new go(this.status,n)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(_(p({},e),{sourceControl:n}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(n=>n._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?da:ha}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,n){if(this.asyncValidator){this.status=mo,this._hasOwnPendingAsyncValidator={emitEvent:n!==!1};let i=R_(this.asyncValidator(this));this._asyncValidationSubscription=i.subscribe(o=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(o,{emitEvent:n,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,n={}){this.errors=e,this._updateControlsErrors(n.emitEvent!==!1,this,n.shouldHaveEmitted)}get(e){let n=e;return n==null||(Array.isArray(n)||(n=n.split(".")),n.length===0)?null:n.reduce((i,o)=>i&&i._find(o),this)}getError(e,n){let i=n?this.get(n):this;return i&&i.errors?i.errors[e]:null}hasError(e,n){return!!this.getError(e,n)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,n,i){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||i)&&this._events.next(new go(this.status,n)),this._parent&&this._parent._updateControlsErrors(e,n,i)}_initObservables(){this.valueChanges=new tr,this.statusChanges=new tr}_calculateStatus(){return this._allControlsDisabled()?da:this.errors?Il:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(mo)?mo:this._anyControlsHaveStatus(Il)?Il:ha}_anyControlsHaveStatus(e){return this._anyControls(n=>n.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,n){let i=!this._anyControlsDirty(),o=this.pristine!==i;this.pristine=i,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,n),o&&this._events.next(new pa(this.pristine,n))}_updateTouched(e={},n){this.touched=this._anyControlsTouched(),this._events.next(new ma(this.touched,n)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,n)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Sl(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let n=this._parent&&this._parent.dirty;return!e&&!!n&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=$S(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=US(this._rawAsyncValidators)}};var z_=new ae("CallSetDisabledState",{providedIn:"root",factory:()=>pd}),pd="always";function VS(r,e){return[...e.path,r]}function BS(r,e,n=pd){GS(r,e),e.valueAccessor.writeValue(r.value),(r.disabled||n==="always")&&e.valueAccessor.setDisabledState?.(r.disabled),HS(r,e),KS(r,e),WS(r,e),qS(r,e)}function C_(r,e){r.forEach(n=>{n.registerOnValidatorChange&&n.registerOnValidatorChange(e)})}function qS(r,e){if(e.valueAccessor.setDisabledState){let n=i=>{e.valueAccessor.setDisabledState(i)};r.registerOnDisabledChange(n),e._registerOnDestroy(()=>{r._unregisterOnDisabledChange(n)})}}function GS(r,e){let n=NS(r);e.validator!==null?r.setValidators(w_(n,e.validator)):typeof n=="function"&&r.setValidators([n]);let i=jS(r);e.asyncValidator!==null?r.setAsyncValidators(w_(i,e.asyncValidator)):typeof i=="function"&&r.setAsyncValidators([i]);let o=()=>r.updateValueAndValidity();C_(e._rawValidators,o),C_(e._rawAsyncValidators,o)}function HS(r,e){e.valueAccessor.registerOnChange(n=>{r._pendingValue=n,r._pendingChange=!0,r._pendingDirty=!0,r.updateOn==="change"&&$_(r,e)})}function WS(r,e){e.valueAccessor.registerOnTouched(()=>{r._pendingTouched=!0,r.updateOn==="blur"&&r._pendingChange&&$_(r,e),r.updateOn!=="submit"&&r.markAsTouched()})}function $_(r,e){r._pendingDirty&&r.markAsDirty(),r.setValue(r._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(r._pendingValue),r._pendingChange=!1}function KS(r,e){let n=(i,o)=>{e.valueAccessor.writeValue(i),o&&e.viewToModelUpdate(i)};r.registerOnChange(n),e._registerOnDestroy(()=>{r._unregisterOnChange(n)})}function ZS(r,e){if(!r.hasOwnProperty("model"))return!1;let n=r.model;return n.isFirstChange()?!0:!Object.is(e,n.currentValue)}function XS(r){return Object.getPrototypeOf(r.constructor)===ES}function JS(r,e){if(!e)return null;Array.isArray(e);let n,i,o;return e.forEach(s=>{s.constructor===Tl?n=s:XS(s)?i=s:o=s}),o||i||n||null}function I_(r,e){let n=r.indexOf(e);n>-1&&r.splice(n,1)}function E_(r){return typeof r=="object"&&r!==null&&Object.keys(r).length===2&&"value"in r&&"disabled"in r}var YS=class extends dd{constructor(e=null,n,i){super(zS(n),LS(i,n)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(n),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Sl(n)&&(n.nonNullable||n.initialValueIsDefault)&&(E_(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,n={}){this.value=this._pendingValue=e,this._onChange.length&&n.emitModelToViewChange!==!1&&this._onChange.forEach(i=>i(this.value,n.emitViewToModelChange!==!1)),this.updateValueAndValidity(n)}patchValue(e,n={}){this.setValue(e,n)}reset(e=this.defaultValue,n={}){this._applyFormState(e),this.markAsPristine(n),this.markAsUntouched(n),this.setValue(this.value,n),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){I_(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){I_(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){E_(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var QS={provide:ga,useExisting:Ul(()=>md)},O_=Promise.resolve(),md=(()=>{let e=class e extends ga{constructor(i,o,s,a,u,l){super(),this._changeDetectorRef=u,this.callSetDisabledState=l,this.control=new YS,this._registered=!1,this.name="",this.update=new tr,this._parent=i,this._setValidators(o),this._setAsyncValidators(s),this.valueAccessor=JS(this,a)}ngOnChanges(i){if(this._checkForErrors(),!this._registered||"name"in i){if(this._registered&&(this._checkName(),this.formDirective)){let o=i.name.previousValue;this.formDirective.removeControl({name:o,path:this._getPath(o)})}this._setUpControl()}"isDisabled"in i&&this._updateDisabled(i),ZS(i,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(i){this.viewModel=i,this.update.emit(i)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){BS(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(i){O_.then(()=>{this.control.setValue(i,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(i){let o=i.isDisabled.currentValue,s=o!==0&&tc(o);O_.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(i){return this._parent?VS(i,this._parent):[i]}};e.\u0275fac=function(o){return new(o||e)(Ae(fd,9),Ae(SS,10),Ae(RS,10),Ae(T_,10),Ae(Oo,8),Ae(z_,8))},e.\u0275dir=Qt({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Yl([QS]),Co,ya]});let r=e;return r})();var eR=(()=>{let e=class e{};e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=sn({type:e}),e.\u0275inj=on({});let r=e;return r})();var L_=(()=>{let e=class e{static withConfig(i){return{ngModule:e,providers:[{provide:z_,useValue:i.callSetDisabledState??pd}]}}};e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=sn({type:e}),e.\u0275inj=on({imports:[eR]});let r=e;return r})();var nR=["graphContiner"],iR=["inputText"],oR=(r,e)=>({"bi-eye-slash":r,"bi-eye":e});function sR(r,e){r&1&&(me(0,"div",17)(1,"span",29),We(2,"Loading..."),Ie()())}var Rl=class r{graphContiner;inputText;loading=!1;graphConfig={width:450,height:450};Graph;graphData;openai_api_key="";api_input_field_type="password";NODE_R=8;highlightNodes=new Set;highlightLinks=new Set;knowledgeGraphService=j(zu);commonService=j(Vu);localStorageManagerService=j(Bu);toastr=j(to);ngOnInit(){this.getOpenAiKey()}ngAfterViewInit(){this.initGraphLLM(),this.setGraphDimension()}saveOpenAiKey(){this.openai_api_key?(this.localStorageManagerService.setItem("openai_api_key",this.openai_api_key),this.toastr.success("OpenAI key saved!","Success")):(this.localStorageManagerService.removeItem("openai_api_key"),this.toastr.success("OpenAI key removed!","Success")),setTimeout(()=>{window.location.reload()},2e3)}getOpenAiKey(){this.openai_api_key=this.localStorageManagerService.getItem("openai_api_key")||""}togglekeyVisibility(){this.api_input_field_type=="text"?this.api_input_field_type="password":this.api_input_field_type="text"}initGraphLLM(){this.openai_api_key&&this.knowledgeGraphService.initGraphLLM(this.openai_api_key)}setGraphDimension(){let e=this.graphContiner.nativeElement;this.graphConfig={width:e.offsetWidth-0,height:e.offsetHeight-0},this.initGrpah()}initGrpah(){return I(this,null,function*(){let e=document.getElementById("graph");this.Graph=__()(e),this.Graph.width(this.graphConfig.width).height(this.graphConfig.height).nodeId("id").nodeLabel("label").nodeColor("color").nodeRelSize(0).nodeAutoColorBy("type").nodeCanvasObjectMode(()=>"after").nodeCanvasObject((n,i,o)=>{this.knowledgeGraphService.nodeCanvasObject(n,i,o)}).nodePointerAreaPaint((n,i,o)=>{this.knowledgeGraphService.nodePointerAreaPaint(n,i,o)}).linkDirectionalArrowRelPos(.75).linkDirectionalArrowLength(n=>this.highlightLinks.has(n)?3:2).linkCurvature("curvature").linkColor(n=>this.highlightLinks.has(n)?"orange":"#A4A4A4").linkWidth(n=>this.highlightLinks.has(n)?3:2).linkCanvasObjectMode(()=>"after").linkCanvasObject((n,i,o)=>{this.knowledgeGraphService.linkCanvasObject(n,i,o,this.Graph)}).linkDirectionalParticles(()=>4).linkDirectionalParticleWidth(n=>this.highlightLinks.has(n)?2:0).linkDirectionalParticleColor(()=>"blue").linkDirectionalParticleSpeed(()=>.01).onNodeClick(n=>this.knowledgeGraphService.zoomNodeAtCenter(n,this.Graph)).onNodeHover(n=>this.nodeHighlight(n)).onNodeDragEnd(n=>{n.fx=n.x,n.fy=n.y}).onLinkHover(n=>{this.linkHighlight(n)}).d3Force("center",null).onEngineStop(()=>this.Graph.zoomToFit(1e3))})}nodeHighlight(e){return I(this,null,function*(){this.highlightNodes.clear(),this.highlightLinks.clear(),e&&(this.highlightNodes.add(e),e.neighbors.forEach(n=>this.highlightNodes.add(n)),e.links.forEach(n=>this.highlightLinks.add(n)))})}linkHighlight(e){return I(this,null,function*(){this.highlightNodes.clear(),this.highlightLinks.clear(),e&&(this.highlightLinks.add(e),this.highlightNodes.add(e.source),this.highlightNodes.add(e.target))})}generateGraph(){return I(this,null,function*(){yield this.initGrpah(),yield this.getGraphdata(),yield this.setGraphdata()})}getGraphdata(){return I(this,null,function*(){let e=this.inputText.nativeElement.value.trim();e&&(this.loading=!0,yield this.knowledgeGraphService.generateGraph(e).then(n=>{this.graphData=n,this.loading=!1}))})}setGraphdata(){return I(this,null,function*(){this.Graph.graphData(this.graphData).linkAutoColorBy(e=>{this.knowledgeGraphService.linkAutoColorBy(e,this.graphData)})})}clearText(){this.inputText.nativeElement.value="",this.initGrpah()}fitGraphToCanvas(){this.Graph.zoomToFit(500)}screenshotGraph(){var e=document.getElementById("graph");this.commonService.htmlToImageCopy(e)}static \u0275fac=function(n){return new(n||r)};static \u0275cmp=Yt({type:r,selectors:[["app-relation-graph"]],viewQuery:function(n,i){if(n&1&&(Jl(nR,5),Jl(iR,5)),n&2){let o;wa(o=xa())&&(i.graphContiner=o.first),wa(o=xa())&&(i.inputText=o.first)}},standalone:!0,features:[or],decls:37,vars:11,consts:[["graphContiner",""],["inputText",""],[1,"main","container"],["id","graphContiner",1,"rounded-2","border","border-secondary-subtle","mb-1"],[1,"graph-action-item"],["title","Zoom","pTooltip","Zoom to fit","tooltipPosition","right",1,"btn","btn-sm","btn-primary",3,"click","disabled"],[1,"bi","bi-arrows-fullscreen"],["title","Screenshot","pTooltip","Screenshot","tooltipPosition","right",1,"btn","btn-sm","btn-primary",3,"click","disabled"],[1,"bi","bi-camera"],["id","graph"],[1,"card"],[1,"card-header","p-1","d-flex","align-items-center","gap-1"],[1,"btn","btn-sm","btn-primary","d-flex","text-nowrap",3,"click"],[1,"bi","bi-send"],[1,"ms-2","d-none","d-sm-block"],[1,"btn","btn-sm","btn-warning","d-flex","text-nowrap",3,"click"],[1,"bi","bi-x-lg"],["role","status",1,"spinner-border","spinner-border-sm"],[1,"flex-grow-1"],[1,"input-group","input-group-sm"],["placeholder","OpenAI Key","aria-label","OpenAi APi key","aria-describedby","openai_key",1,"form-control","shadow-none",3,"ngModelChange","type","ngModel"],["type","button","id","openai_key",1,"input-group-text",3,"click"],[1,"bi",3,"ngClass"],[1,"btn","btn-sm","btn-success","d-flex","text-nowrap",3,"click"],[1,"bi","bi-floppy-fill"],["onclick","window.open('https://github.com/saficool/MindLexa', '_blank')",1,"btn","btn-sm","btn-info","d-flex","text-nowrap"],[1,"bi","bi-github"],[1,"card-body","p-1"],["rows","3","title","prompt",1,"form-control","shadow-none",3,"placeholder","disabled"],[1,"visually-hidden"]],template:function(n,i){if(n&1){let o=Eo();me(0,"div",2)(1,"div",3,0)(3,"div",4)(4,"button",5),He("click",function(){return Et(o),Ot(i.fitGraphToCanvas())}),Ee(5,"i",6),Ie(),me(6,"button",7),He("click",function(){return Et(o),Ot(i.screenshotGraph())}),Ee(7,"i",8),Ie()(),Ee(8,"div",9),Ie(),me(9,"div",10)(10,"div",11)(11,"button",12),He("click",function(){return Et(o),Ot(i.generateGraph())}),Ee(12,"i",13),me(13,"span",14),We(14,"Generate"),Ie()(),me(15,"button",15),He("click",function(){return Et(o),Ot(i.clearText())}),Ee(16,"i",16),me(17,"span",14),We(18,"Clear"),Ie()(),ln(19,sR,3,0,"div",17),Ee(20,"div",18),me(21,"div")(22,"div",19)(23,"input",20),Xd("ngModelChange",function(a){return Et(o),Zd(i.openai_api_key,a)||(i.openai_api_key=a),Ot(a)}),Ie(),me(24,"span",21),He("click",function(){return Et(o),Ot(i.togglekeyVisibility())}),Ee(25,"i",22),Ie()()(),me(26,"button",23),He("click",function(){return Et(o),Ot(i.saveOpenAiKey())}),Ee(27,"i",24),me(28,"span",14),We(29,"Save"),Ie()(),me(30,"button",25),Ee(31,"i",26),me(32,"span",14),We(33,"Source"),Ie()()(),me(34,"div",27),Ee(35,"textarea",28,1),Ie()()()}n&2&&(pe(4),Ce("disabled",!i.graphData),pe(2),Ce("disabled",!i.graphData),pe(13),Hd(i.loading?19:-1),pe(4),Ce("type",i.api_input_field_type),Kd("ngModel",i.openai_api_key),pe(2),Ce("ngClass",Jd(8,oR,i.api_input_field_type==="text",i.api_input_field_type==="password")),pe(10),Ce("placeholder","Your texts here!")("disabled",!i.openai_api_key))},dependencies:[nc,np,L_,Tl,F_,md],styles:[".main[_ngcontent-%COMP%]{height:100vh;padding:5px;overflow:auto}textarea[_ngcontent-%COMP%]{resize:none}#graphContiner[_ngcontent-%COMP%]{height:calc(100vh - 150px);position:relative}.card#history-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{overflow:auto}.graph-action-item[_ngcontent-%COMP%]{position:absolute;top:5px;left:50%;transform:translate(-50%);z-index:99;display:flex;gap:5px}"]})};var U_=[{path:"",component:Rl}];var V_={providers:[Yd({eventCoalescing:!0}),_m(U_),Pp(),wm(),Fy()]};var Ml=class r{title="MindLexa";static \u0275fac=function(n){return new(n||r)};static \u0275cmp=Yt({type:r,selectors:[["app-root"]],standalone:!0,features:[or],decls:1,vars:0,template:function(n,i){n&1&&Ee(0,"router-outlet")},dependencies:[cf]})};jp(Ml,V_).catch(r=>console.error(r));
